'use strict';mix_d("CustomerReviewsMediaCards__cr-media-carousel:cr-media-carousel__EqwDS8FI","exports tslib @c/remote-operations @c/browser-operations @c/aui-feature-detect @c/scoped-dom @c/metrics @c/navigation @c/dom @c/logger @p/A".split(" "),function(tb,g,va,Tb,Ub,Vb,ub,Wb,fa,vb,Xb){function wa(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}function wb(a,b,c){return"https://"+Ca()+"/portal/customer-reviews/media-gallery/ref="+a+"?ie=UTF8&asin="+c+"&mediaType="+b}function Ca(){var a=
Z["default"].getLocation&&Z["default"].getLocation().hostname||location.href,b=Z["default"].getLocation&&Z["default"].getLocation().host||location.host;return"localhost"===a?"pre-prod.amazon.com":b}function Wa(a){return a?a===G.IMAGE?ja.IMAGE:ja.VIDEO:ja.ALL}function Yb(a){return Object.keys(a).map(function(b){return b+"="+a[b]}).join("&")}function Zb(a,b){return g.__awaiter(this,void 0,void 0,function(){var c,d,e;return g.__generator(this,function(f){c=b.mediaType;d=b.metricsPrefix;O.logCounter(d+
"IvxClicked",1);e=Date.now();a.navigate({url:$b(b),successCallback:function(){var h=Date.now()-e;O.logCounter(d+"IvxNavigatedDuration",h);O.logCounter(d+"IvxNavigated",1);O.logNoError("loadIVXError",c)},failCallback:function(h){O.logCounter(d+"IvxNavigated",0);xb("Failed to load SSNAP immersive modal for media: "+JSON.stringify(b)+".",h);O.logError("loadIVXError",c)}});return[2]})})}function $b(a){var b=g.__assign,c=g.__assign,d=a.hidePivot,e=a.ingressType,f=a.isSingleReview,h=a.asin,m=a.refMarker,
l=a.metricsPrefix,q=a.reviewId,n=JSON,w=n.stringify;var k=a.mediaType===G.VIDEO;k=g.__assign({imageUrl:k?a.thumbnailUrl:a.url,physicalId:a.physicalId},k&&{videoUrl:a.url});a=b.call(g,c.call(g,{hidePivot:d,ingressType:e,isSingleReview:f,productAsin:h,refMarker:m,metricsPrefix:l,reviewId:q,viewData:w.call(n,[k])},a.filter&&{filter:a.filter}),a.mediaType===G.VIDEO?{videoUrl:a.url}:{imageUrl:a.url});return"ssnap://www.amazon.com/ive?"+Yb(a)}var ba=wa(va),I=wa(Tb),yb=wa(Ub),ka=wa(Vb),Z=wa(Wb),Q=wa(fa),
Ja=wa(Xb),xa;(function(a){a.IMAGE="IMAGE";a.VIDEO="VIDEO"})(xa||(xa={}));var Ka;(function(a){a.helpfulVoteClickHandler="HelpfulVoteClickHandler";a.reportAbuseClickHandler="ReportAbuseClickHandler"})(Ka||(Ka={}));var La;(function(a){a.requestTranslationClickHandler="requestTranslationClickHandler";a.seeOriginalReviewClickHandler="seeOriginalReviewClickHandler"})(La||(La={}));var zb;(function(a){a.translateAllReviewsClickHandler="TranslateAllReviewsClickHandler";a.showOriginalReviewsClickHandler="ShowOriginalReviewsClickHandler"})(zb||
(zb={}));var Ma;(function(a){a.imageClickHandler="SingleReviewMediaImageThumbnailClickHandler";a.videoClickHandler="SingleReviewMediaVideoThumbnailClickHandler"})(Ma||(Ma={}));var Na;(function(a){a.popoverCloseButtonClickHandler="MediaPopoverCloseButtonClickHandler";a.popoverNextMediaClickHandler="MediaPopoverNextMediaClickHandler"})(Na||(Na={}));var Oa;(function(a){a.VOTE="vote";a.INLINE="inline_review";a.REPORT="report";a.SHOW_ALL="show_all_top"})(Oa||(Oa={}));var Pa;(function(a){a.SINGLE_REVIEW_PAGE=
"srp";a.DETAIL_PAGE="dp";a.ALL_REVIEWS_PAGE="arp"})(Pa||(Pa={}));var Qa;(function(a){a.EDIT="edit";a.DELETE="del";a.IMAGE="img";a.VIDEO="vid"})(Qa||(Qa={}));var Ra;(function(a){a.DESKTOP="d";a.MOBILE_APP="ma";a.MOBILE_BROWSER="mb";a.TABLET_APP="ta";a.TABLET_BROWSER="tb";a.UNKNOWN="unkn"})(Ra||(Ra={}));var Ab=function(a){return"cm_cr_"+a.page+"_"+a.device+(a.widget?"_"+a.widget:"")+(a.location?"_"+a.location:"")},Sa=function(a,b,c){ub.count(c?c+"."+a:a,b)},bc=function(a,b){return g.__awaiter(void 0,
void 0,void 0,function(){var c;return g.__generator(this,function(d){c=Date.now();a.navigate({failCallback:function(e){var f="Failed to load IVX for reviewId: "+b.reviewId+".";e=e?f+". Error object: "+JSON.stringify({message:e.message,name:e.name,stack:e.stack}):f;vb.log(e,"FATAL");Sa("IvxMashNavigateError",1,b.mediaType)},successCallback:function(){var e=Date.now()-c;Sa("IvxMashNavigateLatency",e,b.mediaType);Sa("IvxMashNavigateError",0,b.mediaType);Sa("IvxMashNavigate",1,b.mediaType)},url:ac(b)});
return[2]})})},ac=function(a){var b=g.__assign,c=g.__assign,d=a.hidePivot,e=a.ingressType,f=a.isSingleReview,h=a.metricsPrefix,m=a.asin,l=a.refMarker,q=a.reviewId,n=JSON,w=n.stringify;var k=a.mediaType===xa.VIDEO;k=g.__assign({imageUrl:k?a.thumbnailUrl:a.url,physicalId:a.physicalId},k&&{videoUrl:a.url});a=b.call(g,c.call(g,{hidePivot:d,ingressType:e,isSingleReview:f,metricsPrefix:h,productAsin:m,refMarker:l,reviewId:q,viewData:w.call(n,[k])},a.filter&&{filter:a.filter}),a.mediaType===xa.VIDEO?{videoUrl:a.url}:
{imageUrl:a.url});return"ssnap://www.amazon.com/ive?"+cc(a)},cc=function(a){return Object.keys(a).map(function(b){return b+"="+a[b]}).join("&")},Xa,dc=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){return[2,new Promise(function(b){P.now("mash").execute(function(c){b(c)})})]})})},Bb=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){switch(a.label){case 0:return Xa?[3,2]:[4,dc()];case 1:Xa=a.sent(),
a.label=2;case 2:return[2,Xa]}})})},ec=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){switch(a.label){case 0:return[4,Bb()];case 1:return[2,!!a.sent()]}})})},fc=function(){function a(){}a.prototype.onVideoClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.onMediaClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onImageClickHandler=function(b){return g.__awaiter(this,
void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.onMediaClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onMediaClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,m;return g.__generator(this,function(l){switch(l.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=xa[d.mediatype?d.mediatype:"IMAGE"],f=d.rank,h={reviewId:d.reviewid,mediaType:e,url:d.url,thumbnailUrl:d.thumbnailurl,
physicalId:d.physicalid,asin:d.asin,isSingleReview:!0,hidePivot:!1,refMarker:a.getIVXRefMarker(e,f),ingressType:"dpreviews",metricsPrefix:e===xa.IMAGE?"InlineReviewImageToAppX":"InlineReviewVideoToAppX"},[4,Bb()];case 1:return m=l.sent(),[4,bc(m,h)];case 2:return l.sent(),[2]}})})};a.getIVXRefMarker=function(b,c){var d={page:Pa.SINGLE_REVIEW_PAGE,device:Ra.MOBILE_APP,widget:Oa.INLINE,location:Qa.IMAGE},e={page:Pa.SINGLE_REVIEW_PAGE,device:Ra.MOBILE_APP,widget:Oa.INLINE,location:Qa.VIDEO};b=b===xa.IMAGE?
d:e;c=c?Ab(b)+"_"+c:Ab(b);return c};return a}(),gc={activate:"onclick",dataStrategy:"preload",hideHeader:!0,padding:"none"},Cb=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},gc),{name:c});return a.createOrGet.call(this,c,d,e,f)};return b}(function(){function a(b){this.popover=b}a.prototype.showSync=function(){var b=this;return new Promise(function(c){P.when("A").execute(function(d){var e=
"a:popover:afterSlide:"+b.popover.name,f=function(){d.off(e,f);c()};d.on(e,f);b.show()})})};a.prototype.show=function(){this.popover.show()};a.prototype.hide=function(){this.popover.hide()};a.createOrGet=function(b,c,d,e){var f=this;return new Promise(function(h){f.popovers[b]?h(f.popovers[b]):P.when("a-secondary-view").execute(function(m){ka["default"].scopeElement(c);m=m.create(d,e);f.popovers[b]=new a(m);h(f.popovers[b])})})};a.popovers={};return a}()),Db=function(){function a(){}a.prototype.onVideoClickHandler=
function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,m,l;return g.__generator(this,function(q){d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;e=d.asin;f=d.physicalid;h=d.reviewid;m=d.extension;l=d.thumbnailurl;Ja["default"].trigger("a:declarative:reviews:open-mweb-immersive-video-modal:click",{$event:b.event,$target:b.currentTarget,data:{asin:e,isSingleReview:!0,refMarker:"inline_review",metricsPrefix:"InlineRevToAppX",physicalId:f,slateImageUrl:l,hidePivot:!1,
mediaType:"video",reviewId:h,url:"https://m.media-amazon.com/images/I/"+f+"."+m}});return[2]})})};a.prototype.onImageClickHandler=function(b){var c,d,e;return g.__awaiter(this,void 0,void 0,function(){var f,h,m,l,q;return g.__generator(this,function(n){switch(n.label){case 0:return f=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,h=va.setup(["renderPopover"]),[4,h.renderPopover({reviewId:f.reviewid})];case 1:return m=n.sent(),l=null===(e=null===(d=ka["default"].cardRoot.querySelector("#a-popover-cr-media-popover"))||
void 0===d?void 0:d.childNodes[0])||void 0===e?void 0:e.childNodes[0],null===l||void 0===l?void 0:l.appendChild(m),[4,Cb.get("cr-media-popover",l,b.currentTarget)];case 2:return q=n.sent(),q.showSync(),[2]}})})};return a}(),na;(function(a){a.MWEB="mWeb";a.MSHOP="mShop";a.DESKTOP="desktop"})(na||(na={}));var Eb=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){switch(a.label){case 0:return[4,ec()];case 1:return[2,a.sent()]}})})},hc=function(){return g.__awaiter(void 0,
void 0,void 0,function(){var a;return g.__generator(this,function(b){switch(b.label){case 0:return(a="true"===ka["default"].cardRoot.getAttribute("data-mobile")||yb["default"].isSupported("mobile"))?[4,Eb()]:[3,2];case 1:a=!b.sent(),b.label=2;case 2:return[2,a]}})})},ic=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a;return g.__generator(this,function(b){switch(b.label){case 0:return[4,Eb()];case 1:if(!b.sent())return[3,2];a=na.MSHOP;return[3,4];case 2:return[4,hc()];case 3:a=
b.sent()?na.MWEB:na.DESKTOP,b.label=4;case 4:return[2,a]}})})},jc=function(){function a(){}a.getThumbnailClickHandler=function(){return g.__awaiter(this,void 0,void 0,function(){var b;return g.__generator(this,function(c){switch(c.label){case 0:return[4,ic()];case 1:b=c.sent();switch(b){case na.MSHOP:return[2,new fc];case na.MWEB:return[2,new Db];case na.DESKTOP:return[2,new Db]}return[2]}})})};return a}(),kc=function(){function a(b){this.clickHandler=this.clickHandler=b}a.prototype.registerThumbnailClickHandlers=
function(){this.registerCRVideoThumbnailClickHandler();this.registerCRImageThumbnailClickHandler()};a.prototype.registerCRVideoThumbnailClickHandler=function(){var b=this,c=I["default"].setup().define;c(Ma.videoClickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onVideoClickHandler(d)];case 1:return e.sent(),[2]}})})})};a.prototype.registerCRImageThumbnailClickHandler=function(){var b=
this,c=I["default"].setup().define;c(Ma.imageClickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onImageClickHandler(d)];case 1:return e.sent(),[2]}})})})};return a}(),Ya=function(){return Z["default"].getLocation&&Z["default"].getLocation().host||location.host},ha;(function(a){a[a.LEFT=0]="LEFT";a[a.CENTER=1]="CENTER";a[a.RIGHT=2]="RIGHT";a[a.NONE=3]="NONE"})(ha||(ha={}));var Da;(function(a){a[a.POTRAIT=
0]="POTRAIT";a[a.LANDSCAPE=1]="LANDSCAPE"})(Da||(Da={}));var L=function(a,b){var c,d;return b?b.querySelector("*[data-hook="+a+"]"):(null===(d=null===(c=Q["default"].cardRoot)||void 0===c?void 0:c.ownerDocument)||void 0===d?void 0:d.querySelector("*[data-hook="+a+"]"))||null},lc=function(a,b){var c;return(b=b||(null===(c=Q["default"].cardRoot)||void 0===c?void 0:c.ownerDocument))?Array.from(new Set(Array.from(b.querySelectorAll("["+a+"]")).map(function(d){return d.getAttribute(a)}).filter(function(d){return null!==
d}))):[]},Ta=function(a){var b,c;return(null===(c=null===(b=Q["default"].cardRoot)||void 0===b?void 0:b.ownerDocument)||void 0===c?void 0:c.getElementById(a))||null},W=function(a){a.style.display="flex"},H=function(a){a.style.display="none"},Za=function(){function a(b,c,d){this.reviewId=b;this.locale=c;this.sourceLanguage=d;this.reviewContainer=Ta("cr-single-review-"+b);this.reviewTextContainer=L("reviewTextContainer",this.reviewContainer);this.reviewText=L("reviewText",this.reviewContainer);this.reviewTitle=
L("reviewTitle",this.reviewContainer);this.translateButton=L("translateButton",this.reviewContainer);this.seeOriginalButton=L("seeOriginalButton",this.reviewContainer);this.translationInfo=L("translationInfo",this.reviewContainer);this.translationSpinner=L("translationSpinner",this.reviewTextContainer);this.translationErrorMessage=L("translationErrorMessage",this.reviewContainer);this.helpfulVoteButton=L("helpfulVoteButton",this.reviewContainer);this.helpfulVoteErrorMessage=L("helpfulVoteErrorMessage",
this.reviewContainer);this.helpfulVoteSuccessMessage=L("helpfulVoteSuccessMessage",this.reviewContainer);this.helpfulVoteLoadingMessage=L("helpfulVoteLoadingMessage",this.reviewContainer);this.reportAbuseButton=L("reportAbuseButton",this.reviewContainer);this.reportAbuseSendingMessage=L("reportAbuseSendingMessage",this.reviewContainer);this.reportAbuseSuccessMessage=L("reportAbuseSuccessMessage",this.reviewContainer);this.reportAbuseErrorMessage=L("reportAbuseErrorMessage",this.reviewContainer);this.shareButton=
Ta("shareButton-"+b);this.init()}a.prototype.init=function(){this.hideTranslationSpinner()};a.prototype.updateText=function(b){this.reviewTextContainer=L("reviewTextContainer",this.reviewContainer);this.reviewText=L("reviewText",this.reviewContainer);this.reviewTextContainer&&this.reviewText&&this.reviewTextContainer.replaceChild(b,this.reviewText)};a.prototype.updateTitle=function(b){this.reviewTitle=L("reviewTitle",this.reviewContainer);this.reviewContainer&&this.reviewTitle&&this.reviewContainer.replaceChild(b,
this.reviewTitle)};a.prototype.showTranslateButton=function(){this.translateButton&&this.translationInfo&&this.seeOriginalButton&&(H(this.translationInfo),H(this.seeOriginalButton),W(this.translateButton))};a.prototype.showSeeOriginalButton=function(){this.translateButton&&this.translationInfo&&this.seeOriginalButton&&(W(this.translationInfo),W(this.seeOriginalButton),H(this.translateButton))};a.prototype.showTranslationSpinner=function(){this.translationSpinner&&(this.translationSpinner.style.display=
"contents")};a.prototype.hideTranslationSpinner=function(){this.translationSpinner&&H(this.translationSpinner)};a.prototype.showTranslationErrorMessage=function(){this.translationErrorMessage&&W(this.translationErrorMessage)};a.prototype.hideTranslationErrorMessage=function(){this.translationErrorMessage&&H(this.translationErrorMessage)};a.prototype.showHelpfulVoteSuccessMessage=function(){this.helpfulVoteErrorMessage&&this.helpfulVoteSuccessMessage&&this.helpfulVoteButton&&this.helpfulVoteLoadingMessage&&
(H(this.helpfulVoteButton),H(this.helpfulVoteLoadingMessage),W(this.helpfulVoteSuccessMessage),H(this.helpfulVoteErrorMessage))};a.prototype.showHelpfulVoteErrorMessage=function(){this.helpfulVoteErrorMessage&&this.helpfulVoteSuccessMessage&&this.helpfulVoteButton&&this.helpfulVoteLoadingMessage&&(H(this.helpfulVoteButton),H(this.helpfulVoteLoadingMessage),H(this.helpfulVoteSuccessMessage),W(this.helpfulVoteErrorMessage))};a.prototype.showHelpfulVoteLoadingMessage=function(){this.helpfulVoteErrorMessage&&
this.helpfulVoteSuccessMessage&&this.helpfulVoteButton&&this.helpfulVoteLoadingMessage&&(H(this.helpfulVoteButton),W(this.helpfulVoteLoadingMessage),H(this.helpfulVoteSuccessMessage),H(this.helpfulVoteErrorMessage))};a.prototype.showReportAbuseSendingMessage=function(){this.reportAbuseButton&&this.reportAbuseSendingMessage&&this.reportAbuseSuccessMessage&&this.reportAbuseErrorMessage&&(H(this.reportAbuseButton),W(this.reportAbuseSendingMessage),H(this.reportAbuseSuccessMessage),H(this.reportAbuseErrorMessage))};
a.prototype.showReportAbuseErrorMessage=function(){this.reportAbuseButton&&this.reportAbuseSendingMessage&&this.reportAbuseSuccessMessage&&this.reportAbuseErrorMessage&&(H(this.reportAbuseButton),H(this.reportAbuseSendingMessage),H(this.reportAbuseSuccessMessage),W(this.reportAbuseErrorMessage))};a.prototype.showReportAbuseSuccessMessage=function(){this.reportAbuseButton&&this.reportAbuseSendingMessage&&this.reportAbuseSuccessMessage&&this.reportAbuseErrorMessage&&(H(this.reportAbuseButton),H(this.reportAbuseSendingMessage),
W(this.reportAbuseSuccessMessage),H(this.reportAbuseErrorMessage))};a.prototype.updateShareReviewURL=function(b){if(this.shareButton){var c=this.shareButton.getAttribute("data-ssf-share-icon");c=JSON.parse(c);c.url="https://"+Ya()+"/gp/aw/review/"+b+"/"+this.reviewId;this.shareButton.setAttribute("data-ssf-share-icon",JSON.stringify(c))}};a.getInstance=function(b){this.instance||(this.instance=new a(b));return this.instance};return a}(),Fb=function(){function a(){this.singleReviewManagers=new Map;
this.locale=this.internationalTranslatedBy=this.internationalSeeOriginalButton=this.internationalTranslateAllReviewsButton=this.internationalTopReviews=this.localTranslatedBy=this.localSeeOriginalButton=this.localTranslateAllReviewsButton=this.localTopReviews=null}a.prototype.initializeDomElements=function(){if(this.localTopReviews=Ta("localTopReviews"))this.localTranslateAllReviewsButton=L("translateAllButtonContainer",this.localTopReviews),this.localSeeOriginalButton=L("showOriginalButtonContainer",
this.localTopReviews),this.localTranslatedBy=L("translatedByContainer",this.localTopReviews);if(this.internationalTopReviews=Ta("internationalTopReviews"))this.internationalTranslateAllReviewsButton=L("translateAllButtonContainer",this.internationalTopReviews),this.internationalSeeOriginalButton=L("showOriginalButtonContainer",this.internationalTopReviews),this.internationalTranslatedBy=L("translatedByContainer",this.internationalTopReviews)};a.prototype.getReviewManager=function(b){var c=this.singleReviewManagers.get(b);
c||(c=new Za(b),this.singleReviewManagers.set(b,c));return c};a.prototype.addReviewManager=function(b,c){this.singleReviewManagers.set(b,c)};a.prototype.removeReviewManager=function(b){return this.singleReviewManagers.delete(b)};a.prototype.hasReviewManager=function(b){return this.singleReviewManagers.has(b)};a.prototype.getAllReviewIds=function(){return Array.from(this.singleReviewManagers.keys())};a.prototype.getReviewCount=function(){return this.singleReviewManagers.size};a.prototype.clear=function(){this.singleReviewManagers.clear()};
a.prototype.getReviewIdsFromList=function(b){return(b=b?this.internationalTopReviews:this.localTopReviews)?lc("data-reviewid",b):[]};a.prototype.showTranslateAllButton=function(b){b?(b=this.internationalTranslateAllReviewsButton)&&b.classList.remove("aok-hidden"):(b=this.localTranslateAllReviewsButton)&&b.classList.remove("aok-hidden")};a.prototype.hideTranslateAllButton=function(b){b?(b=this.internationalTranslateAllReviewsButton)&&b.classList.add("aok-hidden"):(b=this.localTranslateAllReviewsButton)&&
b.classList.add("aok-hidden")};a.prototype.showSeeOriginalButton=function(b){b?W(this.internationalSeeOriginalButton):W(this.localSeeOriginalButton)};a.prototype.hideSeeOriginalButton=function(b){b?H(this.internationalSeeOriginalButton):H(this.localSeeOriginalButton)};a.prototype.showTranslatedContainer=function(b){b?W(this.internationalTranslatedBy):W(this.localTranslatedBy)};a.prototype.hideTranslatedContainer=function(b){b?H(this.internationalTranslatedBy):H(this.localTranslatedBy)};a.prototype.showTranslatedState=
function(b){this.hideTranslateAllButton(b);this.showSeeOriginalButton(b);this.showTranslatedContainer(b)};a.prototype.showOriginalState=function(b){this.showTranslateAllButton(b);this.hideSeeOriginalButton(b);this.hideTranslatedContainer(b)};a.getInstance=function(){a.instance||(a.instance=new a);return a.instance};return a}().getInstance(),oa=function(a){return Fb.hasReviewManager(a)?Fb.getReviewManager(a):Za.getInstance(a)},mc=function(){function a(){}a.registerVotingClickHandlers=function(){this.registerHelpfulVoteClickHandler()};
a.registerHelpfulVoteClickHandler=function(){var b=this,c=I["default"].setup().define,d=ba["default"].setup(["helpful"]);c(Ka.helpfulVoteClickHandler,"click",function(e){return g.__awaiter(b,void 0,void 0,function(){var f,h,m,l,q,n,w,k;return g.__generator(this,function(r){switch(r.label){case 0:f=e.currentTarget.dataset.id,h=e.currentTarget.dataset.asin,m=null===(w=e.currentTarget.dataset)||void 0===w?void 0:w.returnTo,l=oa(f),q=Q["default"].cardRoot.ownerDocument.activeElement,r.label=1;case 1:return r.trys.push([1,
3,4,5]),l.showHelpfulVoteLoadingMessage(),[4,d.helpful({reviewId:f,domain:Ya(),asin:h,returnTo:m})];case 2:return n=r.sent(),!n.success&&n.redirectUrl?Z["default"].setLocation(n.redirectUrl):n.success?l.showHelpfulVoteSuccessMessage():l.showHelpfulVoteErrorMessage(),[3,5];case 3:return r.sent(),l.showHelpfulVoteErrorMessage(),[3,5];case 4:return q===(null===(k=e.currentTarget)||void 0===k?void 0:k.getElementsByTagName("input")[0])&&a.moveFocusToVotingMessage(f),[7];case 5:return[2]}})})})};a.moveFocusToVotingMessage=
function(b){b=oa(b);var c=b.helpfulVoteSuccessMessage||b.helpfulVoteErrorMessage;c&&(c.setAttribute("tabindex","-1"),setTimeout(function(){return c.focus({preventScroll:!1})},100))};return a}(),nc=function(){function a(){}a.registerReportClickHandlers=function(){this.registerReportVoteClickHandler()};a.registerReportVoteClickHandler=function(){var b=this,c=I["default"].setup().define,d=ba["default"].setup(["reportAbuse"]);c(Ka.reportAbuseClickHandler,"click",function(e){return g.__awaiter(b,void 0,
void 0,function(){var f,h,m,l,q,n,w,k;return g.__generator(this,function(r){switch(r.label){case 0:f=e.currentTarget.dataset.id,h=e.currentTarget.dataset.asin,m=null===(w=e.currentTarget.dataset)||void 0===w?void 0:w.returnTo,l=oa(f),q=Q["default"].cardRoot.ownerDocument.activeElement,r.label=1;case 1:return r.trys.push([1,3,4,5]),l.showReportAbuseSendingMessage(),[4,d.reportAbuse({reviewId:f,domain:Ya(),asin:h,returnTo:m})];case 2:return n=r.sent(),!n.success&&n.redirectUrl?Z["default"].setLocation(n.redirectUrl):
n.success?l.showReportAbuseSuccessMessage():l.showReportAbuseErrorMessage(),[3,5];case 3:return r.sent(),l.showReportAbuseErrorMessage(),[3,5];case 4:return q===(null===(k=e.currentTarget)||void 0===k?void 0:k.getElementsByTagName("input")[0])&&a.moveFocusToVotingMessage(f),[7];case 5:return[2]}})})})};a.moveFocusToVotingMessage=function(b){b=oa(b);var c=b.reportAbuseSuccessMessage||b.reportAbuseErrorMessage;c&&(c.setAttribute("tabindex","-1"),setTimeout(function(){return c.focus({preventScroll:!1})},
100))};return a}(),$a=function(){function a(){this.cache=new Map;this.translateReviewDataOperation;this.translateableReviewIds=new Set;this.ignoreReviewIds=new Set;this.remoteDataOperationProxy=ba["default"].setup(["translateReview"])}a.prototype.addReviewIdsToTranslatableReviewIds=function(b){this.translateableReviewIds.add(b)};a.prototype.getTranslatableReviewIds=function(){return Array.from(this.translateableReviewIds)};a.prototype.addReviewdIdsToIgnoreList=function(b){this.ignoreReviewIds.add(b)};
a.prototype.getRetryTime=function(b){return Math.min((null===b||void 0===b?void 0:b.retryDelayinSeconds)||a.DEFAULT_RETRY_TIME,3)};a.prototype.renderAllTranslatedReviews=function(b,c){return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,m,l,q,n,w,k,r,p,C,u,v,z,D=this;return g.__generator(this,function(J){switch(J.label){case 0:d=ba["default"].setup(["translateAllReviews"]);e=ba["default"].setup(["renderReviewTitle","renderReviewText"]);f=b.map(function(y){return oa(y)});h=[];try{for(m=g.__values(b),
l=m.next();!l.done;l=m.next())q=l.value,n=this.cache.get(q),w=f[b.indexOf(q)],n&&n.translatedText&&n.translatedTitle?(w.hideTranslationErrorMessage(),w.updateText(n.translatedText.cloneNode(!0)),w.updateTitle(n.translatedTitle.cloneNode(!0)),w.showSeeOriginalButton()):this.ignoreReviewIds.has(q)||(h.push(q),w.hideTranslationErrorMessage(),w.showTranslationSpinner())}catch(y){v={error:y}}finally{try{l&&!l.done&&(z=m.return)&&z.call(m)}finally{if(v)throw v.error;}}if(!(0<h.length))return[3,4];J.label=
1;case 1:return J.trys.push([1,3,,4]),[4,d.translateAllReviews({reviewIds:h,isMobile:c})];case 2:return k=J.sent(),r=new Map,p=new Map,C=[],u=[],k.forEach(function(y){y&&y.reviewId&&(r.set(y.reviewId,y),y.translatedText&&y.translatedTitle?p.set(y.reviewId,y):422===y.statusCode?C.push(y):u.push(y.reviewId))}),h.forEach(function(y){r.has(y)||u.push(y)}),0<p.size&&Promise.allSettled(Array.from(p.entries()).map(function(y){y=g.__read(y,2);var B=y[0],t=y[1];return g.__awaiter(D,void 0,void 0,function(){var x,
E,R,T,la,za,pa,ma;return g.__generator(this,function(ca){switch(ca.label){case 0:x=f[b.indexOf(B)],E=x.reviewText?x.reviewText.cloneNode(!0):null,R=x.reviewTitle?x.reviewTitle.cloneNode(!0):null,ca.label=1;case 1:return ca.trys.push([1,3,,4]),[4,Promise.all([e.renderReviewText({isCardExpanded:!0,language:t.targetLanguage,text:t.translatedText}),e.renderReviewTitle({language:t.targetLanguage,isMobile:c,title:t.translatedTitle})])];case 2:return T=g.__read.apply(void 0,[ca.sent(),2]),la=T[0],za=T[1],
pa=fa.unscope(la),ma=fa.unscope(za),this.cache.set(B,{originalText:E,originalTitle:R,targetLanguage:t.targetLanguage,translatedText:pa,translatedTitle:ma}),pa&&ma?(x.hideTranslationErrorMessage(),x.hideTranslationSpinner(),x.updateText(pa),x.updateTitle(ma),x.showSeeOriginalButton()):(x.hideTranslationSpinner(),x.showTranslationErrorMessage()),[3,4];case 3:return ca.sent(),x.hideTranslationSpinner(),x.showTranslationErrorMessage(),[3,4];case 4:return[2]}})})})),u.forEach(function(y){y=f[b.indexOf(y)];
y.hideTranslationSpinner();y.showTranslationErrorMessage()}),C.forEach(function(y){var B=D.getRetryTime(y);setTimeout(function(){D.renderTranslatedReview(y.reviewId,c,a.DEFAULT_RETRIES-1)},1E3*B)}),[3,4];case 3:return J.sent(),f.forEach(function(y){y.hideTranslationSpinner();y.showTranslationErrorMessage()}),[3,4];case 4:return[2]}})})};a.prototype.renderTranslatedReview=function(b,c,d){void 0===d&&(d=a.DEFAULT_RETRIES);return g.__awaiter(this,void 0,void 0,function(){var e,f,h,m,l,q,n,w,k,r,p;return g.__generator(this,
function(C){switch(C.label){case 0:e=oa(b);f=ba["default"].setup(["renderReviewTitle","renderReviewText"]);h=this.cache.get(b);if(!(h&&h.translatedText&&h.translatedTitle))return[3,1];e.hideTranslationErrorMessage();e.updateText(h.translatedText.cloneNode(!0));e.updateTitle(h.translatedTitle.cloneNode(!0));e.showSeeOriginalButton();return[3,7];case 1:l=m=null,h?(m=h.originalText,l=h.originalTitle):(m=e.reviewText?e.reviewText.cloneNode(!0):null,l=e.reviewTitle?e.reviewTitle.cloneNode(!0):null),e.hideTranslationErrorMessage(),
e.showTranslationSpinner(),C.label=2;case 2:return C.trys.push([2,6,,7]),[4,this.translateReviewDataOperation(b,d)];case 3:return(q=C.sent())&&q.translatedText&&q.translatedTitle?[4,Promise.all([f.renderReviewText({isCardExpanded:!0,language:q.targetLanguage,text:q.translatedText}),f.renderReviewTitle({language:q.targetLanguage,isMobile:c,title:q.translatedTitle})])]:[3,5];case 4:n=g.__read.apply(void 0,[C.sent(),2]),w=n[0],k=n[1],r=fa.unscope(w),p=fa.unscope(k),e.hideTranslationSpinner(),this.cache.set(b,
{originalText:m,originalTitle:l,targetLanguage:q.targetLanguage,translatedText:r,translatedTitle:p}),r&&p&&(e.hideTranslationErrorMessage(),e.updateText(r),e.updateTitle(p),e.showSeeOriginalButton()),C.label=5;case 5:return[3,7];case 6:return C.sent(),e.hideTranslationSpinner(),e.showTranslationErrorMessage(),[3,7];case 7:return[2]}})})};a.prototype.translateReviewDataOperation=function(b,c){void 0===c&&(c=a.DEFAULT_RETRIES);return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h;return g.__generator(this,
function(m){switch(m.label){case 0:d=function(l){var q,n;return g.__generator(this,function(w){switch(w.label){case 0:return[4,e.remoteDataOperationProxy.translateReview({reviewId:b})];case 1:return q=w.sent(),q.translatedText&&q.translatedTitle?[2,{value:q}]:[3,2];case 2:if(!q.statusCode||422!=q.statusCode)return[3,4];n=e.getRetryTime(q);return[4,new Promise(function(k){return setTimeout(k,1E3*n)})];case 3:return w.sent(),[2,"continue"];case 4:return[2]}})},e=this,f=0,m.label=1;case 1:return f<c?
[5,d(f)]:[3,4];case 2:h=m.sent();if("object"===typeof h)return[2,h.value];m.label=3;case 3:return f++,[3,1];case 4:throw Error;}})})};a.prototype.renderOriginalReviews=function(b){return g.__awaiter(this,void 0,void 0,function(){var c,d,e,f,h,m;return g.__generator(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,7]),c=g.__values(b),d=c.next(),l.label=1;case 1:if(d.done)return[3,4];e=d.value;return[4,this.renderOriginalReview(e)];case 2:l.sent(),l.label=3;case 3:return d=c.next(),[3,1];
case 4:return[3,7];case 5:return f=l.sent(),h={error:f},[3,7];case 6:try{d&&!d.done&&(m=c.return)&&m.call(c)}finally{if(h)throw h.error;}return[7];case 7:return[2]}})})};a.prototype.renderOriginalReview=function(b){return g.__awaiter(this,void 0,void 0,function(){var c,d;return g.__generator(this,function(e){c=oa(b);(d=this.cache.get(b))&&d.originalText&&d.originalTitle&&(c.hideTranslationErrorMessage(),c.updateText(d.originalText.cloneNode(!0)),c.updateTitle(d.originalTitle.cloneNode(!0)),c.showTranslateButton());
return[2]})})};a.getInstance=function(){a.instance||(a.instance=new a);return a.instance};a.DEFAULT_RETRIES=3;a.DEFAULT_RETRY_TIME=2;return a}().getInstance(),oc=function(){function a(){}a.registerTranslationClickHandlers=function(){a.registerTranslateButtonClickHandler();a.registerSeeOriginalReviewButtonClickHandler()};a.registerTranslateButtonClickHandler=function(){var b=I["default"].setup().define;b(La.requestTranslationClickHandler,"click",function(c){return g.__awaiter(void 0,void 0,void 0,
function(){var d,e,f,h,m;return g.__generator(this,function(l){switch(l.label){case 0:return d=null===(f=c.currentTarget)||void 0===f?void 0:f.dataset.reviewid,e="true"===(null===(h=c.currentTarget)||void 0===h?void 0:h.dataset.mobile),[4,$a.renderTranslatedReview(d,e)];case 1:return l.sent(),Q["default"].cardRoot.ownerDocument.activeElement===(null===(m=c.currentTarget)||void 0===m?void 0:m.firstChild)&&a.moveFocusToReviewText(d),[2]}})})})};a.registerSeeOriginalReviewButtonClickHandler=function(){var b=
I["default"].setup().define;b(La.seeOriginalReviewClickHandler,"click",function(c){return g.__awaiter(void 0,void 0,void 0,function(){var d,e,f;return g.__generator(this,function(h){switch(h.label){case 0:return d=null===(e=c.currentTarget)||void 0===e?void 0:e.dataset.reviewid,[4,$a.renderOriginalReview(d)];case 1:return h.sent(),Q["default"].cardRoot.ownerDocument.activeElement===(null===(f=c.currentTarget)||void 0===f?void 0:f.firstChild)&&a.moveFocusToReviewText(d),[2]}})})})};a.moveFocusToReviewText=
function(b){var c=oa(b);b=c.reviewText;null===b||void 0===b?void 0:b.setAttribute("tabindex","-1");b&&setTimeout(function(){var d;return null===(d=c.reviewText)||void 0===d?void 0:d.focus({preventScroll:!1})},100)};return a}(),pc=function(){function a(){this.scrollIntoMediaByIndex=function(b,c){var d,e,f,h,m=!1,l=c.children;c=null===(h=null===(f=null===(e=null===(d=null===c||void 0===c?void 0:c.parentElement)||void 0===d?void 0:d.parentElement)||void 0===e?void 0:e.firstChild)||void 0===f?void 0:
f.firstChild)||void 0===h?void 0:h.childNodes;for(d=0;d<l.length;d++)d==b?(c[d].style.backgroundColor="#008296",W(l[d]),m=!0):(c[d].style.backgroundColor=m?"#C8CCCC":"#008296",H(l[d]))};this.indexOfVisibleElement=function(b){for(var c=0;c<b.length;c++)if("none"!==b[c].style.display)return c;return 0}}a.prototype.closeButtonClickHandler=function(b){var c,d;return g.__awaiter(this,void 0,void 0,function(){var e,f;return g.__generator(this,function(h){switch(h.label){case 0:return e=null===(d=null===
(c=ka["default"].cardRoot.querySelector("#a-popover-cr-media-popover"))||void 0===c?void 0:c.childNodes[0])||void 0===d?void 0:d.childNodes[0],[4,Cb.get("cr-media-popover",e,b.currentTarget)];case 1:return f=h.sent(),f.hide(),[2]}})})};a.prototype.nextMediaClickHandler=function(b){var c,d;return g.__awaiter(this,void 0,void 0,function(){var e,f,h;return g.__generator(this,function(m){var l=b.event,q=b.currentTarget;m=l.clientX/q.clientWidth*100;l=l.clientY/q.clientHeight*100;q=(q.clientWidth>q.clientHeight?
Da.LANDSCAPE:Da.POTRAIT)===Da.POTRAIT?{lowerBound:33,upperBound:67}:{lowerBound:40,upperBound:80};e=l<=q.lowerBound||l>=q.upperBound?ha.NONE:25>=m?ha.LEFT:75<=m?ha.RIGHT:ha.CENTER;f=this.indexOfVisibleElement(null===(c=b.currentTarget)||void 0===c?void 0:c.children);h=null===(d=b.currentTarget)||void 0===d?void 0:d.childElementCount;switch(e){case ha.LEFT:0<f?this.scrollIntoMediaByIndex(f-1,b.currentTarget):0==f&&this.scrollIntoMediaByIndex(h-1,b.currentTarget);break;case ha.CENTER:case ha.RIGHT:case ha.NONE:f<
h-1?this.scrollIntoMediaByIndex(f+1,b.currentTarget):f==h-1&&this.scrollIntoMediaByIndex(0,b.currentTarget)}return[2]})})};return a}(),qc=function(){function a(){}a.getMediaPopoverClickHandler=function(){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(b){return[2,new pc]})})};return a}(),rc=function(){function a(b){this.clickHandler=b}a.prototype.registerMediaPopoverClickHandlers=function(){this.registerCloseButtonClickHandler();this.registerNextMediaClickHandler()};
a.prototype.registerNextMediaClickHandler=function(){var b=this,c=I["default"].setup().define;c(Na.popoverNextMediaClickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.nextMediaClickHandler(d)];case 1:return e.sent(),[2]}})})})};a.prototype.registerCloseButtonClickHandler=function(){var b=this,c=I["default"].setup().define;c(Na.popoverCloseButtonClickHandler,"click",function(d){return g.__awaiter(b,
void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.closeButtonClickHandler(d)];case 1:return e.sent(),[2]}})})})};return a}(),sc=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a,b,c,d;return g.__generator(this,function(e){switch(e.label){case 0:return[4,jc.getThumbnailClickHandler()];case 1:return a=e.sent(),b=new kc(a),b.registerThumbnailClickHandlers(),[4,qc.getMediaPopoverClickHandler()];case 2:return c=e.sent(),d=
new rc(c),d.registerMediaPopoverClickHandlers(),oc.registerTranslationClickHandlers(),mc.registerVotingClickHandlers(),nc.registerReportClickHandlers(),[2]}})})},tc=function(a){return g.__awaiter(void 0,void 0,void 0,function(){var b,c,d,e,f,h,m;return g.__generator(this,function(l){switch(l.label){case 0:return b=a||ka["default"].cardRoot,c=b.getAttribute("data-reviewid")||(b.id?b.id.replace("cr-single-review-",""):""),d="true"===b.getAttribute("data-mobile"),e=b.getAttribute("data-asin")||"",f=
b.getAttribute("data-locale")||"",h=b.getAttribute("data-sourcelanguage")||"",c?a||"fr-CA"!==f||"fr-CA"===h?[3,2]:[4,$a.renderTranslatedReview(c,d)]:[2,null];case 1:l.sent(),l.label=2;case 2:return m=new Za(c,f,h),m.updateShareReviewURL(e),[2,m]}})})},G;(function(a){a.IMAGE="IMAGE";a.VIDEO="VIDEO"})(G||(G={}));var ab=G,bb,uc=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){return[2,new Promise(function(b){P.now("mash").execute(function(c){b(c)})})]})})},
cb=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){switch(a.label){case 0:return bb?[3,2]:[4,uc()];case 1:bb=a.sent(),a.label=2;case 2:return[2,bb]}})})},vc=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){switch(a.label){case 0:return[4,cb()];case 1:return[2,!!a.sent()]}})})},ia;(function(a){a.MWEB="mWeb";a.MSHOP="mShop";a.DESKTOP="desktop"})(ia||(ia={}));var db=function(){return g.__awaiter(void 0,
void 0,void 0,function(){return g.__generator(this,function(a){switch(a.label){case 0:return[4,vc()];case 1:return[2,a.sent()]}})})},Gb=function(){return"true"===ka["default"].cardRoot.getAttribute("data-mobile")||yb["default"].isSupported("mobile")},wc=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a;return g.__generator(this,function(b){switch(b.label){case 0:return(a=Gb())?[4,db()]:[3,2];case 1:a=!b.sent(),b.label=2;case 2:return[2,a]}})})},Hb=function(){return g.__awaiter(void 0,
void 0,void 0,function(){var a;return g.__generator(this,function(b){switch(b.label){case 0:return[4,db()];case 1:if(!b.sent())return[3,2];a=ia.MSHOP;return[3,4];case 2:return[4,wc()];case 3:a=b.sent()?ia.MWEB:ia.DESKTOP,b.label=4;case 4:return[2,a]}})})},O=function(){function a(){}a.setPrefix=function(b){this.prefix=b+"."};a.logCounter=function(b,c,d){ub.count(""+this.prefix+(d?d+"."+b:b),c)};a.logError=function(b,c){this.logCounter(b,1,c)};a.logNoError=function(b,c){this.logCounter(b,0,c)};a.prefix=
"";return a}(),eb;(eb||(eb={})).clickHandler="CRImageThumbnailOpsClickHandler";var xc=eb,fb;(fb||(fb={})).clickHandler="CRSeeMoreThumbnailOpsClickHandler";var yc=fb,gb;(gb||(gb={})).clickHandler="CRVideoThumbnailClickHandler";var zc=gb,ja;(function(a){a.IMAGE="image";a.VIDEO="video";a.ALL="all"})(ja||(ja={}));var Ea=function(){function a(b,c){this.popover=c;this.popoverOpenEventType="a-modal"===b?"afterShow":"afterSlide"}a.prototype.showSync=function(){var b=this;return new Promise(function(c){P.when("A").execute(function(d){var e=
"a:popover:"+b.popoverOpenEventType+":"+b.popover.name,f=function(){d.off(e,f);c()};d.on(e,f);b.show()})})};a.prototype.show=function(){this.popover.show()};a.prototype.hide=function(){this.popover.hide()};a.prototype.updatePosition=function(){this.popover.updatePosition()};a.getPopoverByName=function(b){return this.popovers[b]};a.prototype.isOpen=function(){return this.popover.isActive()};a.createOrGet=function(b,c,d,e,f){var h=this;return new Promise(function(m){h.popovers[c]?m(h.popovers[c]):P.when(b).execute(function(l){ka["default"].scopeElement(d);
l=l.create(e,f);h.popovers[c]=new a(b,l);m(h.popovers[c])})})};a.popovers={};return a}(),Ac={activate:"onclick",dataStrategy:"preload",hideHeader:!0,padding:"none"},Ib={dataStrategy:"preload"},Bc=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},Ac),{name:c});return a.createOrGet.call(this,"a-secondary-view",c,d,e,f)};return b}(Ea),Cc=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},Ib),{name:c});return a.createOrGet.call(this,"a-modal",c,d,e,f)};return b}(Ea),Dc=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},Ib),{name:c});return a.createOrGet.call(this,"a-popover",c,d,e,f)};return b}(Ea),N=function(a){a.style.display=
"flex"},K=function(a){a.style.display="none"},X;(function(a){a[a.LEFT=0]="LEFT";a[a.CENTER=1]="CENTER";a[a.RIGHT=2]="RIGHT";a[a.NONE=3]="NONE"})(X||(X={}));var Aa;(function(a){a[a.EXPAND=0]="EXPAND";a[a.HIDE=1]="HIDE"})(Aa||(Aa={}));var Fa;(function(a){a[a.POTRAIT=0]="POTRAIT";a[a.LANDSCAPE=1]="LANDSCAPE"})(Fa||(Fa={}));var S=function(a,b){return(a=null===a||void 0===a?void 0:a.getElementsByClassName(b))?a[0]:null},Ua=function(a,b){var c;return null!==(c=null===a||void 0===a?void 0:a.querySelector(b))&&
void 0!==c?c:null},A=function(a,b){a&&b(a)},Jb=function(a){a=a.dataset;return{asin:a.asin,mediaType:G[a.mediatype],reviewId:a.reviewid,mediaId:a.physicalid||a.mediaid}},Kb=function(a,b){null===b||void 0===b?void 0:b.classList.remove(a)},Lb=function(a,b){null===b||void 0===b?void 0:b.classList.add(a)},Ec=function(a){var b=S(a,"_Y3Itb_desktop-skeleton-container_738lf"),c=S(a,"_Y3Itb_desktop-spinner-container_1qNHr");return{show:function(){return A(b,function(d){return N(d)})},hide:function(){return A(b,
function(d){return K(d)})},setLoadingAnimation:function(d){A(c,function(e){d?b&&N(e):K(e)})}}},hb;(function(a){a.SingleReviewComponent="SingleReviewComponent";a.ProfileBlock="ProfileBlock";a.ProfileBadge="ProfileBadge";a.Rating="Rating";a.RatingAlt="RatingAlt";a.ReviewText="ReviewText";a.ReviewTitle="ReviewTitle";a.MainMedia="MainMedia";a.ImageThumbnailsBlock="ImageThumbnailsBlock";a.GalleryBlock="GalleryBlock";a.SingleReviewMediaBlock="SingleReviewMediaBlock"})(hb||(hb={}));var F=hb,ib;(function(a){a.MainMedia=
"MainMedia";a.ImageThumbnailsBlock="ImageThumbnailsBlock";a.GalleryBlock="GalleryBlock";a.SingleReviewMediaBlock="SingleReviewMediaBlock"})(ib||(ib={}));var Mb=ib,jb;(function(a){a.THANKYOU_MESSAGE_TOAST_BAR_NAME="thankYouMessageToastBarName";a.ERROR_MESSAGE_TOAST_BAR_NAME="errorMessageToastBarName";a.LOADPOPOVER_ERROR_TOAST_BAR_NAME="loadPopoverErrorToastBarName";a.DATA_POPOVER_NAME="data-popovername";a.DATA_ASIN="data-asin";a.DATA_MEDIATYPE="data-mediatype";a.DATA_SHOW_GALLERY_IN_MODAL="data-showgalleryinmodal";
a.DATA_REVIEW_ID="data-reviewid";a.DATA_MEDIA_ID="data-mediaid";a.DATA_CSA_C_TYPE="data-csa-c-type";a.DATA_CSA_SLOT_ID="data-csa-c-slot-id";a.DATA_MULTIPLE_STARS_SUFFIX="data-multiple-starts-suffix";a.DATA_ONE_STAR_SUFFIX="data-one-star-suffix";a.DATA_IMAGE_ALT_TEXT="data-imagealttext"})(jb||(jb={}));var M=jb,kb;(function(a){a.showMediaGalleryClickHandler="showMediaGalleryClickHandler";a.galleryItemClickHandler="galleryItemClickHandler";a.thumbnailClickHandler="thumbnailClickHandler";a.expandTextClickHandler=
"expandTextClickHandler";a.hideTextClickHandler="hideTextClickHandler";a.reloadMediaPopover="reloadMediaPopover";a.closeMediaPopover="closeMediaPopover";a.leftClickHandler="leftClickHandler";a.rightClickHandler="rightClickHandler";a.openReportConfirmationDialogClickHandler="OpenReportConfirmationDialogClickHandler";a.confirmReportAbuseClickHandler="ConfirmReportAbuseClickHandler";a.noopHandler="noopHandler";a.helpfulVoteClickHandler="HelpfulVoteClickHandler"})(kb||(kb={}));var Y=kb,U;(function(a){a.UPDATE_TEXT=
"updateText";a.UPDATE_LANG="updateLang";a.REPLACE_CLASS="replaceClass";a.DELETE_CHILDREN="deleteChildren";a.APPEND_ELEMENT="appendElement";a.UPDATE_ELEMENT="UpdateElement"})(U||(U={}));var lb=function(a,b,c){a=Ua(a,"[data-reviewbind="+F[b]+"]");c&&a&&(a=Ua(a,c));return a},Nb=function(a){var b=Q["default"].cardRoot.ownerDocument.createElement(a.tag);A(a.elementAttributes,function(c){Object.keys(c).forEach(function(d){return b.setAttribute(d,c[d])})});A(a.children,function(c){c.forEach(function(d){d=
Nb(d);b.append(d)})});A(a.observer,function(c){c.observe(b)});A(a.clickHandler,function(c){c(b)});A(a.textContent,function(c){return b.textContent=c});return b},Ob=function(a,b){switch(b.type){case U.UPDATE_TEXT:A(a,function(c){var d,e=null!==(d=b.textContent)&&void 0!==d?d:"";c.textContent=e});break;case U.UPDATE_LANG:A(a,function(c){var d,e,f=c.textContent||"",h=c.dataset.reviewlanguage||"",m=c.dataset.originalText,l=null!==(d=b.textContent)&&void 0!==d?d:"";d=null===(e=c.dataset.locale)||void 0===
e?void 0:e.slice(0,2);e=new Intl.DisplayNames([d],{type:"language"});m||(c.dataset.originalText=f);if("updateLang"==l){if(h=h.slice(0,2),h=e.of(h))c.textContent=f.replace("*",h)}else m&&(c.textContent=c.dataset.originalText||"")});break;case U.REPLACE_CLASS:A(a,function(c){A(b.classPatternToBeReplaced,function(d){var e=Array.from(c.classList).find(function(f){return f.match(d)});A(e,function(f){return c.classList.remove(f)})});A(b.newClass,function(d){return c.classList.add(d)})});break;case U.APPEND_ELEMENT:A(a,
function(c){var d;null===(d=b.elements)||void 0===d?void 0:d.forEach(function(e){c.append(Nb(e))})});break;case U.DELETE_CHILDREN:A(a,function(c){for(;c.lastElementChild;)c.removeChild(c.lastElementChild)});break;case U.UPDATE_ELEMENT:A(a,function(c){A(b.elementAttributes,function(d){Object.keys(d).forEach(function(e){return c.setAttribute(e,d[e])})})})}},mb=function(a,b){a&&b.forEach(function(c){var d=lb(a,c.key,c.querySelector);Ob(d,c)})},Fc=function(a,b){var c=b==G.IMAGE?"cm_cr_image_carousel_popover":
"cm_cr_video_carousel_popover",d=I["default"].setup(),e=function(u,v){var z,D=null!==(z=v.mediaList.findIndex(b==G.IMAGE?function(J){var y;return(null===(y=J.image)||void 0===y?void 0:y.physicalId)==u}:function(J){var y;return(null===(y=J.video)||void 0===y?void 0:y.physicalId)==u}))&&void 0!==z?z:0;return v.mediaList[D]},f=function(u,v,z){return[{type:U.UPDATE_TEXT,key:u,textContent:v,querySelector:z}]},h=function(u,v,z,D){return[{type:U.REPLACE_CLASS,key:u,classPatternToBeReplaced:v,newClass:z,
querySelector:D}]},m=function(u,v,z){return[{key:u,type:U.UPDATE_ELEMENT,elementAttributes:v,querySelector:z}]},l=["_Y3Itb_media-popover-image-view-container_vTrQA","_Y3Itb_media-popover-image-view-active_2lj7U"],q=function(u){var v=u.mediaGroup.mediaList.map(function(z){return b==G.IMAGE?z.image:z.video}).filter(function(z){return!!z}).map(function(z,D){var J,y=g.__assign,B=(J={class:u.mediaId==z.physicalId?l.join(" "):"_Y3Itb_media-popover-image-view-container_vTrQA"},J[M.DATA_MEDIA_ID]=z.physicalId,
J);J=c+"_"+u.reviewId+"_"+u.reviewRank+"_"+z.physicalId+"_"+D;var t;D=(t={},t[M.DATA_CSA_C_TYPE]="element",t[M.DATA_CSA_SLOT_ID]=J,t);return{tag:"div",elementAttributes:y.call(g,B,D),children:[{tag:b==G.IMAGE?"img":"video",elementAttributes:g.__assign({src:z.url,alt:z.altText,class:"_Y3Itb_media-popover-image-view_1FAQo"},b==G.VIDEO?{controls:"true"}:{})}]}});return[{type:U.DELETE_CHILDREN,key:F.MainMedia},{type:U.APPEND_ELEMENT,elements:v,key:F.MainMedia}]},n=function(u){if(b==G.VIDEO)return[];var v=
k(F.ImageThumbnailsBlock,M.DATA_IMAGE_ALT_TEXT),z=u.mediaGroup.mediaList.map(function(D){return D.image}).filter(function(D){return!!D}).map(function(D){var J;return{tag:"li",elementAttributes:{class:"_Y3Itb_media-popover-list-item-style_1njtu"},children:[{tag:"button",elementAttributes:(J={"aria-pressed":u.mediaId===D.physicalId?"true":"false",class:u.mediaId===D.physicalId?"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O _Y3Itb_media-popover-thumbnail-image-button_1vtKQ":"_Y3Itb_media-popover-thumbnail-image-button_1vtKQ"},
J[M.DATA_MEDIA_ID]=D.physicalId,J[M.DATA_MEDIATYPE]=b,J),children:[{tag:"img",elementAttributes:{src:D.thumbnailUrl,alt:v,class:"_Y3Itb_media-popover-thumbnail-image-view_3-Y40"}}],clickHandler:function(y){return d.attach(Y.thumbnailClickHandler,y)}}]}});return[{type:U.DELETE_CHILDREN,key:F.ImageThumbnailsBlock},{type:U.APPEND_ELEMENT,elements:z,key:F.ImageThumbnailsBlock}]},w=function(u,v,z){return g.__spread(f(u,z),m(u,{lang:v}))},k=function(u,v,z){var D;return(u=lb(a,u,z))?null!==(D=u.getAttribute(v))&&
void 0!==D?D:"":""},r=k(F.RatingAlt,M.DATA_MULTIPLE_STARS_SUFFIX),p=k(F.RatingAlt,M.DATA_ONE_STAR_SUFFIX),C=function(u,v,z){var D,J,y,B,t,x;switch(u){case F.ReviewText:return w(u,(null===(J=z.metadata)||void 0===J?void 0:J.sourceLanguage)||"",null===(y=z.metadata)||void 0===y?void 0:y.text);case F.ReviewTitle:return w(u,(null===(B=z.metadata)||void 0===B?void 0:B.sourceLanguage)||"",null===(t=z.metadata)||void 0===t?void 0:t.title);case F.ProfileBadge:return f(u,v.mediaGroup.contributorRelationships);
case F.Rating:var E=null===(x=z.metadata)||void 0===x?void 0:x.rating;void 0===E&&(E=0);return g.__spread(h(F.Rating,"^a-star-.*","a-star-"+E),f(F.Rating,E+" "+(1<E?r:p),"span"));case F.MainMedia:return q(v);case F.ProfileBlock:return x=(x=v.mediaGroup.contributor.profile)?g.__spread(f(F.ProfileBlock,x.name,".a-profile-name"),m(F.ProfileBlock,{src:x.avatarUrl.desktop},".a-profile-avatar > img"),m(F.ProfileBlock,{href:null!==(E=x.link)&&void 0!==E?E:"javascript:void(0)"},"a.a-profile")):[],x;case F.ImageThumbnailsBlock:return n(v);
case F.SingleReviewMediaBlock:return m(u,(D={},D[M.DATA_CSA_SLOT_ID]=c+"_"+v.reviewId+"_"+v.reviewRank,D));default:return[]}};return{updateReview:function(u){var v=e(u.mediaId,u.mediaGroup),z=Object.keys(F).flatMap(function(D){return C(F[D],u,v)});mb(a,z)},updateReviewMedia:function(u){var v=e(u.mediaId,u.mediaGroup),z=Object.keys(Mb).flatMap(function(D){return C(Mb[D],u,v)});mb(a,z)},updateMedia:function(u){u=g.__spread(m(F.ImageThumbnailsBlock,{"aria-pressed":"false"},"._Y3Itb_media-popover-thumbnail-image-view-active_2W42O"),
m(F.ImageThumbnailsBlock,{"aria-pressed":"true"},'button[data-mediaid="'+u+'"]'),h(F.ImageThumbnailsBlock,"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O",void 0,"._Y3Itb_media-popover-thumbnail-image-view-active_2W42O"),h(F.ImageThumbnailsBlock,void 0,"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O",'button[data-mediaid="'+u+'"]'),h(F.MainMedia,"_Y3Itb_media-popover-image-view-active_2lj7U",void 0,"._Y3Itb_media-popover-image-view-active_2lj7U"),h(F.MainMedia,void 0,"_Y3Itb_media-popover-image-view-active_2lj7U",
'div[data-mediaid="'+u+'"]'));mb(a,u)},updateSingleReviewContent:function(u){var v=lb(a,F.SingleReviewComponent);v&&v.firstChild&&v.replaceChild(u,v.firstChild)}}},nb=function(a,b){if(!a)return!1;b=b.some(function(c){return a.classList.contains(c)});return a.offsetHeight<a.scrollHeight&&b},Gc=function(a){var b=["_Y3Itb_cr-sidepanel-truncated-text_3nfmo","_Y3Itb_cr-sidepanel-truncated-title_2w0Qj"],c=S(a,"_Y3Itb_cr-media-popover-sidepanel-header-section_3TxI7"),d=S(c,"_Y3Itb_cr-sidepanel-text_3MYCz"),
e=S(c,"_Y3Itb_cr-sidepanel-title_EX93d"),f=S(c,"_Y3Itb_cr-sidepanel-expander-see-more_1sipE"),h=S(c,"_Y3Itb_cr-sidepanel-expander-see-less_1Hpji"),m=S(c,"_Y3Itb_cr-sidepanel-container-gradient_1zm2j"),l=function(p){nb(p,b)&&(A(f,function(C){return N(C)}),A(m,function(C){return Lb("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",C)}))},q=new ResizeObserver(function(p){var C;try{for(var u=g.__values(p),v=u.next();!v.done;v=u.next())l(v.value.target)}catch(D){var z={error:D}}finally{try{v&&!v.done&&
(C=u.return)&&C.call(u)}finally{if(z)throw z.error;}}});A(d,function(p){q.observe(fa.unscope(p))});A(e,function(p){q.observe(fa.unscope(p))});var n=function(){k(!0);A(f,function(p){return K(p)});A(h,function(p){return N(p)})},w=function(){k(!1);A(h,function(p){return K(p)})},k=function(p){r("_Y3Itb_cr-media-popover-sidepanel-header-section-truncated_DITiq",p,c);r("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",p,m);r("_Y3Itb_cr-sidepanel-truncated-text_3nfmo",p,d);r("_Y3Itb_cr-sidepanel-truncated-title_2w0Qj",
p,e)},r=function(p,C,u){C?A(u,function(v){return Kb(p,v)}):A(u,function(v){return Lb(p,v)})};return{toggleText:function(){d&&nb(d,b)||e&&nb(e,b)?n():w()},hideText:w,expandText:n,initialize:function(){A(f,function(p){return K(p)});A(m,function(p){return Kb("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",p)});l(d);l(e)}}},ob=function(){function a(b){this.actionButtons=b}a.getActionButtonsContainer=function(b){var c=Q["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_cr-vote-report-buttons-container_1YjZZ");
return Array.from(c).filter(function(d){return d.dataset.id===b})[0]};a.prototype.likeButtonClicked=function(){var b=this.actionButtons.querySelectorAll("div[data-variant='like']")[0],c=this.actionButtons.querySelectorAll("div[data-variant='like-done']")[0];K(b);N(c)};a.prototype.resetLike=function(){var b=this.actionButtons.querySelectorAll("div[data-variant='like']")[0],c=this.actionButtons.querySelectorAll("div[data-variant='like-done']")[0];K(c);N(b)};return a}(),Hc={dataStrategy:"inline",activate:"onclick",
position:"triggerVertical"},Ic=function(a){var b;return{openTooltipPopover:function(c){return g.__awaiter(void 0,void 0,void 0,function(){var d,e,f;return g.__generator(this,function(h){switch(h.label){case 0:if(b)return[3,2];d="reportAbusePreload_"+a;e=S(c,"_Y3Itb_cr-report-abuse-preload-content_ve26F");null===e||void 0===e?void 0:e.classList.remove("aok-hidden");f=g.__assign(g.__assign({},Hc),{name:d,content:e});return e?[4,Dc.get(d,e,c,f)]:[3,2];case 1:b=h.sent(),h.label=2;case 2:return b&&b.show(),
[2]}})})},closeTooltipPopover:function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(c){b&&b.hide();return[2]})})},isOpen:function(){return b?b.isOpen():!1}}},Jc=function(a){var b=(a=S(a,"_Y3Itb_cr-vote-report-buttons-container_1YjZZ"))?new ob(a):void 0,c=new Set;return{initialize:function(d){c.has(d)?null===b||void 0===b?void 0:b.likeButtonClicked():null===b||void 0===b?void 0:b.resetLike()},addReviewId:function(d){null===b||void 0===b?void 0:b.likeButtonClicked();
c.add(d)}}},Kc=function(a,b){var c=S(a,"_Y3Itb_left-icon-container_31i2O"),d=S(a,"_Y3Itb_right-icon-container_3Qopb");return{initialize:function(e,f){A(c,N);A(d,N);b.isFirstMediaItem(e,f)&&A(c,K);b.isLastMediaItem(e,f)&&A(d,K)},hideButtons:function(){A(c,K);A(d,K)}}},Lc=function(a,b,c){a=S(a,"_Y3Itb_modal-content-container_XXRsT");var d=S(a,"_Y3Itb_cr-action-buttons-container_3vmwq"),e=Kc(a,b),f=Ic(c);if(!a)throw Error("modalContent element was not found");return{reportAbuse:g.__assign({},f),helpfulVote:g.__assign({},
Jc(a)),navigation:g.__assign({},e),toggleMediaButtonsVisibility:function(h,m,l){if(h){if(!m||!l)throw Error("reviewId or mediaId not found: "+m+", "+l);A(d,N);e.initialize(m,l)}else f.isOpen()||(A(d,K),e.hideButtons())}}},ya=function(){function a(b,c){var d;this.toastBar=c?a.getToastBarByNameIn(b,c):a.getToastBarByName(b);this.button=null===(d=this.toastBar)||void 0===d?void 0:d.getElementsByClassName("_Y3Itb_toast-bar-button_1yIpW")[0]}a.getToastBarByName=function(b){return Q["default"].cardRoot.ownerDocument.querySelector("div[data-toast-bar-name='"+
b+"']")};a.getToastBarByNameIn=function(b,c){return Ua(c,"div[data-toast-bar-name='"+b+"']")};a.prototype.setClickParams=function(b){var c=this;b.forEach(function(d,e){var f;null===(f=c.button)||void 0===f?void 0:f.setAttribute(e,d)})};a.prototype.show=function(){A(this.toastBar,N)};a.prototype.hide=function(){A(this.toastBar,K)};return a}(),Oc=function(a,b,c,d){setTimeout(function(){var e=d.parentElement,f=null===e||void 0===e?void 0:e.parentElement;if(e=null===f||void 0===f?void 0:f.offsetHeight){var h=
d.offsetHeight;h=(f=null===f||void 0===f?void 0:f.querySelector('[data-reviewbind="ImageThumbnailsBlock"]'))?Math.max(e-h+100-f.offsetHeight-8-22,100):Math.max(e-h+100-88-22,100)}else h=100;e=Mc(a,b,h);if((f=a.querySelector(".a-cardui-body .a-reactive-container"))&&f.scrollHeight>=h){f.style.height=h+"px";h=b.querySelector(".a-expander-icon");if(f=b.querySelector(".a-see-more-text")){f.style.display="none";a.setAttribute("data-a-expanded","false");if(c){var m=c.querySelector(".a-reactive-container");
m&&(m.className="a-reactive-container a-reactive-container-transition")}b.style.opacity="1";b.style.display="block";f.style.display="inline";h&&(h=h.querySelector(".a-css-icon"))&&(h.className="a-css-icon a-css-icon-draw a-css-icon-expand")}Nc(a,b,e)}else a.setAttribute("data-a-expanded","true"),b&&b.remove(),f&&(e=f.querySelector(".a-reactive-container-gradient"))&&e.remove()},0)},Mc=function(a,b,c){return function(d){var e=a.querySelector(".a-cardui-body .a-reactive-container");e&&(e.style.transition=
"height 200ms linear",e.style.height=d?e.scrollHeight+"px":c+"px");a.setAttribute("data-a-expanded",d?"true":"false");if(e=b.querySelector(".a-css-icon"))e.className=d?"a-css-icon a-css-icon-draw a-css-icon-collapse":"a-css-icon a-css-icon-draw a-css-icon-expand";e=b.querySelector(".a-see-more-text");var f=b.querySelector(".a-see-less-text");e&&f&&(e.style.display=d?"none":"inline",f.style.display=d?"inline":"none")}},Nc=function(a,b,c){(b=b.querySelector(".a-cardui-expand-control-footer-button"))&&
b.addEventListener("click",function(){var d="true"===a.getAttribute("data-a-expanded");c(!d)})},Qc=function(a,b,c,d){var e=Fc(b,a),f=Gc(b),h=Lc(b,c,a),m=new ya(M.THANKYOU_MESSAGE_TOAST_BAR_NAME,b),l=new ya(M.ERROR_MESSAGE_TOAST_BAR_NAME,b),q=ba["default"].setup(["reportAbuse"]),n=ba["default"].setup(["helpful"]),w=ba["default"].setup(["renderSingleReview"]),k={},r=new Map,p=function(B,t){A(B,function(x){k.reviewId=x});A(t,function(x){k.mediaId=x})},C=function(B,t){B=t[B];return a===G.IMAGE?B.image.physicalId:
B.video.physicalId},u=function(B){return B.map(function(t){return t.mediaType===G.IMAGE?t.image:t.video}).findIndex(function(t){return(null===t||void 0===t?void 0:t.physicalId)===k.mediaId})},v=function(){return g.__awaiter(void 0,void 0,void 0,function(){var B;return g.__generator(this,function(t){switch(t.label){case 0:if(!k.reviewId||!k.mediaId)throw Error("No reviewId present: "+k);return[4,c.fetchNextReview(k.reviewId)];case 1:return(B=t.sent())?[4,z(C(0,B.mediaGroup.mediaList),B.mediaGroup.id)]:
[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},z=function(B,t){return g.__awaiter(void 0,void 0,void 0,function(){var x,E;return g.__generator(this,function(R){switch(R.label){case 0:return[4,c.fetchReview(t)];case 1:x=R.sent();if(!x)throw Error("review was not fetched: "+t);E={reviewId:t,mediaId:B,reviewRank:x.reviewRank,mediaGroup:x.mediaGroup};return d?[4,D(x)]:[3,3];case 2:return R.sent(),e.updateReviewMedia(E),[3,4];case 3:e.updateReview(E),R.label=4;case 4:return p(t,B),f.hideText(),
f.initialize(),h.helpfulVote.initialize(t),h.navigation.initialize(t,B),[2]}})})},D=function(B){return g.__awaiter(void 0,void 0,void 0,function(){var t,x,E,R,T,la,za;return g.__generator(this,function(pa){switch(pa.label){case 0:return t=b.querySelector("div[data-reviewid]"),x=null===(za=null===(la=B.mediaGroup.mediaList.at(0))||void 0===la?void 0:la.metadata)||void 0===za?void 0:za.review,E={isMshop:"true"===t.dataset.ismshop,locale:t.dataset.locale||"",marketplaceId:t.dataset.marketplaceid||"",
isKindleApp:"true"===t.dataset.iskindleapp,localeLanguageName:t.dataset.localelanguagename||void 0,csrfT:t.dataset.csrft||"",isCustomerRecognized:"true"===t.dataset.iscustomerrecognized,isAndroidApp:"true"===t.dataset.isandroidapp,isIosApp:"true"===t.dataset.isiosapp,isMobile:!1,lazyLoading:!1,isSingleReviewFromSharedLibraryEnabled:!0,imageProfileLazyLoading:!1,isModalView:!0},x&&E?[4,J(x,E)]:[3,2];case 1:R=pa.sent();var ma=R;if(ma){var ca=ma.querySelector('[data-a-card-type="peekExpand"]');if(ca){var Pc=
ca.querySelector(".a-cardui-body"),Pb=ca.querySelector(".a-cardui-expand-control-footer"),pb=ca.querySelector(".a-cardui-footer");ca.style.marginTop="0px";pb&&(pb.style.padding="0px",pb.style.paddingTop="0px");Pb&&Oc(ca,Pb,Pc,ma)}}T=ma;T&&r.set(x.id,T.cloneNode(!0));e.updateSingleReviewContent(R);pa.label=2;case 2:return[2]}})})},J=function(B,t){return g.__awaiter(void 0,void 0,void 0,function(){var x,E,R,T;return g.__generator(this,function(la){switch(la.label){case 0:x=B.id;if(r.has(x))return[2,
r.get(x).cloneNode(!0)];E={review:B,requestContext:t};T=fa.unscope;return[4,w.renderSingleReview(E)];case 1:return R=T.apply(void 0,[la.sent()]),[2,R]}})})},y=function(B){if(!k.reviewId)throw Error("no reviewId found while updating media: "+k.mediaId);e.updateMedia(B);p(k.reviewId,B);h.navigation.initialize(k.reviewId,B)};return{show:function(){return A(b,N)},hide:function(){return A(b,K)},update:function(B){var t=B.mediaId,x=B.reviewId;return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,
function(E){switch(E.label){case 0:if(!t||!x)throw Error("reviewId or mediaId not found: "+x+", "+t);return[4,z(t,x)];case 1:return E.sent(),[2]}})})},updateMedia:y,handleModalMediaProgressionClick:function(B){return g.__awaiter(void 0,void 0,void 0,function(){var t,x,E,R;return g.__generator(this,function(T){switch(T.label){case 0:if(!k.reviewId||!k.mediaId)throw Error("No reviewId or mediaId present: "+k);t=c.getReviewById(k.reviewId);x=u(t.mediaList);E=B;switch(E){case X.RIGHT:return[3,1];case X.LEFT:return[3,
5]}return[3,10];case 1:if(!(x<t.mediaList.length-1))return[3,2];y(C(x+1,t.mediaList));return[3,4];case 2:return[4,v()];case 3:T.sent(),T.label=4;case 4:return[3,10];case 5:if(!(0<x))return[3,6];y(C(x-1,t.mediaList));return[3,9];case 6:return[4,c.fetchPreviousReview(k.reviewId)];case 7:return(R=T.sent())?[4,z(C(R.mediaGroup.mediaList.length-1,R.mediaGroup.mediaList),R.mediaGroup.id)]:[3,9];case 8:T.sent(),T.label=9;case 9:return[3,10];case 10:return[2]}})})},handleExpanderClick:function(B){switch(B){case Aa.EXPAND:f.expandText();
break;case Aa.HIDE:f.hideText()}},handleReportAbuseClick:function(B){return g.__awaiter(void 0,void 0,void 0,function(){var t,x;return g.__generator(this,function(E){switch(E.label){case 0:if(!k.reviewId)throw Error("no reviewId found while reporting abuse: "+k);h.reportAbuse.closeTooltipPopover();E.label=1;case 1:return E.trys.push([1,5,,6]),[4,q.reportAbuse({reviewId:k.reviewId,asin:B,domain:Ca()})];case 2:t=E.sent();if(!t.success&&t.redirectUrl)return Z["default"].setLocation(t.redirectUrl),[2];
if(!t.success)return[3,4];m.show();return[4,v()];case 3:return E.sent(),[2];case 4:return t.success?[3,6]:(l.show(),[2]);case 5:throw x=E.sent(),l.show(),x;case 6:return[2]}})})},handleHelpulVoteClick:function(B){return g.__awaiter(void 0,void 0,void 0,function(){var t,x;return g.__generator(this,function(E){switch(E.label){case 0:if(!k.reviewId)throw Error("no reviewId found while handling helpfulvote call: "+k);E.label=1;case 1:return E.trys.push([1,3,,4]),[4,n.helpful({reviewId:k.reviewId,domain:Ca(),
asin:B})];case 2:return t=E.sent(),!t.success&&t.redirectUrl&&Z["default"].setLocation(t.redirectUrl),t.success?(h.helpfulVote.addReviewId(k.reviewId),[2]):t.success?[3,4]:(l.show(),[2]);case 3:throw x=E.sent(),l.show(),x;case 4:return[2]}})})},openReportAbuseTooltip:h.reportAbuse.openTooltipPopover,toggleMediaButtonsVisibility:function(B){h.toggleMediaButtonsVisibility(B,k.reviewId,k.mediaId)},getCurrentReviewDetails:function(){return k},updateReviewDetails:p,renderSingleReviewFromSharedLibrary:D}},
Rc=I["default"].setup(),Sc=function(a){var b=0,c=function(m,l,q){var n;return n={},n[M.DATA_MEDIA_ID]=m,n[M.DATA_MEDIATYPE]=q,n[M.DATA_REVIEW_ID]=l,n[M.DATA_SHOW_GALLERY_IN_MODAL]="false",n},d=function(m){var l;return l={},l[M.DATA_CSA_C_TYPE]="element",l[M.DATA_CSA_SLOT_ID]=m,l},e=function(m){return[{tag:"img",elementAttributes:{src:m.thumbnailUrl,alt:m.altText}}]},f=function(m,l){var q={tag:"img",elementAttributes:{src:m.thumbnailUrl,alt:m.altText}};return l?[q,{tag:"div",elementAttributes:{class:"_Y3Itb_media-gallery-item-video-overlay-container_RHWdX"},
children:[{tag:"div",elementAttributes:{class:"_Y3Itb_media-gallery-item-video-overlay_cGzRu"},children:[{tag:"i",elementAttributes:{"class":"a-icon a-icon-star-mini a-star-mini-"+l.rating}},{tag:"span",textContent:"\u25b7 "+m.videoDuration}]}]}]:[q]},h=function(m,l,q,n,w){return m.map(function(k,r){var p,C=k.mediaType==ab.IMAGE?k.image:k.video;if(C){var u=k.mediaType==ab.IMAGE?e(k.image):f(k.video,k.metadata),v=null===(p=k.metadata)||void 0===p?void 0:p.contributionId;if(v)return{tag:"button",elementAttributes:g.__assign(g.__assign({class:k.mediaType==
ab.IMAGE?"_Y3Itb_media-gallery-item_3LROo":"_Y3Itb_media-gallery-item-video_1k9yY"},c(C.physicalId,v,k.mediaType)),d(w+"_"+v+"_"+C.physicalId+"_"+n)),observer:r==l?q:void 0,children:g.__spread(u),clickHandler:function(z){return Rc.attach(Y.galleryItemClickHandler,z)}}}}).filter(function(k){return void 0!==k})};return{updateGallery:function(m,l,q,n){m=h(m,l,q,b,n);b++;0<m.length&&Ob(a,{type:U.APPEND_ELEMENT,key:F.GalleryBlock,elements:m})}}},Tc=function(a,b,c){var d=S(b,"_Y3Itb_media-popover-gallery-container-grid_mLjpJ"),
e=S(b,"_Y3Itb_gallery-spinner_34BcK"),f=a===G.IMAGE?"cm_cr_image_gallery_popover":"cm_cr_video_gallery_popover",h=new IntersectionObserver(function(n,w){n.forEach(function(k){return g.__awaiter(void 0,void 0,void 0,function(){var r;return g.__generator(this,function(p){switch(p.label){case 0:if(!k.isIntersecting)return[3,4];p.label=1;case 1:return p.trys.push([1,3,,4]),A(e,N),[4,c.fetchReviewsNextPage()];case 2:return p.sent(),q(),A(e,K),w.unobserve(k.target),[3,4];case 3:throw r=p.sent(),r;case 4:return[2]}})})})},
{root:fa.unscope(d),rootMargin:"0px",threshold:.25}),m=Sc(d),l=0,q=function(){for(var n=c.getAllReviews(),w=c.getAllReviewIds(),k=[],r=l;r<w.length;r++)k.push.apply(k,g.__spread(n[w[r]].mediaList)),l++;m.updateGallery(k,5<=k.length?k.length-5:-1,h,f)};return{hide:function(){return A(b,K)},show:function(){return A(b,N)},update:function(){return g.__awaiter(void 0,void 0,void 0,function(){var n;return g.__generator(this,function(w){switch(w.label){case 0:return n=c.getAllReviewIds(),0!=n.length?[3,
2]:[4,c.fetchReviewsNextPage()];case 1:w.sent(),w.label=2;case 2:return q(),[2]}})})},scrollToMediaId:function(n){n&&(n=Ua(b,'div[data-mediaid="'+n+'"]'),A(n,function(w){return w.scrollIntoView()}))}}},Uc=function(a){var b=S(a,"_Y3Itb_media-popover-see-all-container_1Lmmi");return{show:function(){return A(b,function(c){return N(c)})},hide:function(){return A(b,function(c){return K(c)})}}},Vc=function(a,b){var c=[],d={},e,f,h=function(){return g.__awaiter(void 0,void 0,void 0,function(){var k,r;return g.__generator(this,
function(p){switch(p.label){case 0:return k=va.setup(["getGroupedMediaReviews"]),[4,k.getGroupedMediaReviews({asin:a,nextToken:e,mediaType:b,limit:50})];case 1:return r=p.sent(),m(r.mediaGroupList),e=r.nextToken,[2]}})})},m=function(k){k.forEach(function(r){d[r.id]=r;0>c.indexOf(r.id)&&c.push(r.id)})},l=function(k){return!!d[k]},q=function(k){return c.indexOf(k)},n=function(){return g.__awaiter(void 0,void 0,void 0,function(){var k;return g.__generator(this,function(r){switch(r.label){case 0:k=0===
Object.keys(d).length;if(!k&&(k||f||!e))return[3,5];r.label=1;case 1:return r.trys.push([1,,3,4]),[4,h()];case 2:return r.sent(),[3,4];case 3:return f=!1,[7];case 4:return[2,!0];case 5:return[2,!1]}})})},w=function(k,r){return d[k].mediaList.map(function(p){return p.mediaType===G.IMAGE?p.image:p.video}).findIndex(function(p){return(null===p||void 0===p?void 0:p.physicalId)===r})};return{fetchReview:function(k){return g.__awaiter(void 0,void 0,void 0,function(){var r,p,C,u;return g.__generator(this,
function(v){switch(v.label){case 0:if(!k)throw Error("fetchReview was called without a reviewId");r=l(k);v.label=1;case 1:return r?[3,3]:[4,n()];case 2:return p=v.sent(),r=l(k),p?[3,1]:[3,3];case 3:if(l(k))return[3,5];C=va.setup(["getMediaGroup"]);return[4,C.getMediaGroup({reviewId:k})];case 4:u=v.sent(),m(u),e="",O.logCounter("desktop.missingReviewId",1),v.label=5;case 5:return l(k)?[2,{mediaGroup:d[k],reviewRank:q(k)}]:[2]}})})},isReviewFetched:l,fetchReviewsNextPage:n,fetchNextReview:function(k){return g.__awaiter(void 0,
void 0,void 0,function(){var r,p;return g.__generator(this,function(C){switch(C.label){case 0:return r=q(k)+1,r>=c.length?[4,n()]:[3,2];case 1:C.sent(),C.label=2;case 2:return p=c[r],l(p)?[2,{mediaGroup:d[p],reviewRank:r}]:[2]}})})},fetchPreviousReview:function(k){return g.__awaiter(void 0,void 0,void 0,function(){var r,p;return g.__generator(this,function(C){r=q(k)-1;if(0>r)return[2];p=c[r];return l(p)?[2,{mediaGroup:d[p],reviewRank:r}]:[2]})})},getReviewById:function(k){return d[k]},getReviewIndexById:q,
getAllReviews:function(){return d},getAllReviewIds:function(){return c},isFirstMediaItem:function(k,r){var p=q(k);k=w(k,r);return 0===p&&0===k},isLastMediaItem:function(k,r){var p=q(k);r=w(k,r);return!e&&p===c.length-1&&r===d[k].mediaList.length-1}}},Ga=function(){var a={};return{setData:function(b,c){a[b]=c},getData:function(b){return a[b]},hasData:function(b){return b in a},removeData:function(b){delete a[b]},clearData:function(){for(var b in a)a.hasOwnProperty(b)&&delete a[b]}}}(),Wc=function(a,
b,c,d,e){var f=Vc(b,c),h=Ec(d),m=Uc(d),l=new ya(M.LOADPOPOVER_ERROR_TOAST_BAR_NAME,d),q=S(d,"_Y3Itb_single-review-media-popover-container_1h9X2");if(!q)throw Error("Unable to find singleReviewMediaPopoverContainer");var n=Qc(c,q,f,e);d=S(d,"_Y3Itb_gallery-container_2pBFm");if(!d)throw Error("Unable to find mediaGalleryContainer");var w=Tc(c,d,f);return{loadModal:function(k){return g.__awaiter(void 0,void 0,void 0,function(){var r;return g.__generator(this,function(p){switch(p.label){case 0:return l.hide(),
n.hide(),w.hide(),h.show(),h.setLoadingAnimation(!0),k.popoverDetails.popover?[4,k.popoverDetails.popover.showSync()]:[3,2];case 1:p.sent(),p.label=2;case 2:return p.trys.push([2,4,,5]),r=k.showGalleryInModal?w:n,[4,r.update(k)];case 3:return p.sent(),r.show(),k.showGalleryInModal?m.hide():m.show(),h.hide(),[3,5];case 4:p.sent();O.logCounter("desktop.popoverLoading.Error",1);h.setLoadingAnimation(!1);if(!k.mediaType||!k.asin)throw Error("mediaType or asin was not found while setting parameters for toastbar: "+
k.mediaType+", "+k.asin);p=new Map([[M.DATA_POPOVER_NAME,k.popoverDetails.popoverName],[M.DATA_ASIN,k.asin],[M.DATA_MEDIATYPE,k.mediaType.toString()]]);if(k.showGalleryInModal)p.set(M.DATA_SHOW_GALLERY_IN_MODAL,"true");else{if(!k.reviewId||!k.mediaId)throw Error("mediaId or reviewId was not found while setting parameters for toastbar: "+k.reviewId+", "+k.mediaId);p.set(M.DATA_REVIEW_ID,k.reviewId);p.set(M.DATA_MEDIA_ID,k.mediaId)}l.setClickParams(p);l.show();return[3,5];case 5:return[2]}})})},updateModalWithReview:function(k,
r){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(p){switch(p.label){case 0:return w.hide(),m.show(),[4,n.update({reviewId:k,mediaId:r,asin:b,mediaType:c})];case 1:return p.sent(),n.show(),[2]}})})},showMediaGallery:function(){return g.__awaiter(void 0,void 0,void 0,function(){var k;return g.__generator(this,function(r){switch(r.label){case 0:return k=n.getCurrentReviewDetails().mediaId,n.hide(),m.hide(),h.show(),h.setLoadingAnimation(!0),[4,w.update()];case 1:return r.sent(),
h.hide(),w.show(),w.scrollToMediaId(k),[2]}})})},updateMediaInModal:n.updateMedia,handleModalMediaProgressionClick:n.handleModalMediaProgressionClick,handleExpanderClick:n.handleExpanderClick,openReportAbuseDialog:n.openReportAbuseTooltip,handleReportAbuseClick:function(){return n.handleReportAbuseClick(b)},handleHelpulVoteClick:function(){return n.handleHelpulVoteClick(b)},closeModal:function(){return Ea.getPopoverByName(a).hide()}}},Xc=function(a,b){return g.__awaiter(void 0,void 0,void 0,function(){var c;
return g.__generator(this,function(d){switch(d.label){case 0:return c=ba["default"].setup(["triggerWeblab"]),[4,c.triggerWeblab({weblabId:a,isCustomerIdBasedWeblab:b})];case 1:return[2,d.sent()]}})})},Yc=function(){function a(){this.desktopPopoverModalOptions={dataStrategy:"preload",hideHeader:!0,closeButton:!0,padding:"none",name:"cr-media-popover"}}a.prototype.onVideoClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){throw Error("Video click handler on Desktop is not yet implemented.");
})})};a.prototype.onImageClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.showImagePopover(b,!1)];case 1:return c.sent(),[2]}})})};a.prototype.onSeeMoreClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f;return g.__generator(this,function(h){switch(h.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=G[d.mediatype],f=Wa(e),f!==ja.IMAGE?
[3,2]:[4,this.showImagePopover(b,!0)];case 1:return h.sent(),[3,3];case 2:throw O.logError("loadDesktopVideoGalleryError",f),Error("Video gallery is not available on desktop.");case 3:return[2]}})})};a.prototype.showImagePopover=function(b,c){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(d){switch(d.label){case 0:return[4,this.openModal(b,c)];case 1:return d.sent(),[2]}})})};a.prototype.openModal=function(b,c){return g.__awaiter(this,void 0,void 0,function(){var d,
e,f,h,m,l,q,n,w,k,r,p,C,u,v,z;return g.__generator(this,function(D){switch(D.label){case 0:d=b.currentTarget;e=Jb(d);if(c&&(!e.mediaType||!e.asin))throw Error("media props are missing while trying to load the modal: "+JSON.stringify(e));if(!(c||e.mediaType&&e.asin&&e.reviewId&&e.mediaId))throw Error("media props are missing while trying to load the modal: "+JSON.stringify(e));f=e.mediaType===G.IMAGE?"_Y3Itb_cm_cr_image_popoversection_3iYPp":"_Y3Itb_cm_cr_video_popoversection_2v7yY";h=ka["default"].cardRoot.getElementsByClassName(f)[0];
m=h.getElementsByClassName("_Y3Itb_media-popover-container_2BBbs")[0];l=this.desktopPopoverModalOptions.name+"_"+e.mediaType;q=h.querySelector("div[data-reviewbind=SingleReviewMediaBlock]");n=(null===q||void 0===q?void 0:q.getAttribute("data-closebuttonaria"))||"";w=(null===q||void 0===q?void 0:q.getAttribute("data-modaltitlearia"))||"";r=k=!1;if(!m)return[3,2];(p=m.querySelector("div[data-reviewid]"))&&(r="true"===p.dataset.iscustomerrecognized);return r?[4,Xc("COFEE_DD_MEDIA_CARDS_MIGRATION_SHARED_LIBRARY_1247512")]:
[3,2];case 1:C=D.sent(),"T1"===C.treatment&&(k=!0),D.label=2;case 2:return u=g.__assign(g.__assign({},this.desktopPopoverModalOptions),{name:l,closeButtonLabel:n,popoverLabel:w}),[4,Cc.get(l,m,d,u)];case 3:v=D.sent();z=Ga.hasData(e.mediaType)?Ga.getData(e.mediaType):Wc(l,e.asin,e.mediaType,m,k);if(!z)throw Error("Could not load ModalManager for opening modal: "+e);return[4,z.loadModal({asin:e.asin,mediaId:e.mediaId,reviewId:e.reviewId,mediaType:e.mediaType,showGalleryInModal:c,popoverDetails:{popoverName:this.desktopPopoverModalOptions.name+
"_"+e.mediaType,popover:v}})];case 4:return D.sent(),Ga.hasData(e.mediaType)||Ga.setData(e.mediaType,z),v.updatePosition(),d.classList.remove("a-declarative"),[2]}})})};return a}(),xb=function(a,b){a=b?a+". Error object: "+JSON.stringify({message:b.message,name:b.name,stack:b.stack}):a;vb.log(a,"FATAL")},qa;(function(a){a.CAROUSEL="crsl";a.IMAGES_CAROUSEL="crsl_img";a.VIDEOS_CAROUSEL="crsl_vid"})(qa||(qa={}));var ra;(function(a){a.DETAIL_PAGE_WIDGET="dp";a.IMAGE_GALLERY="img";a.MEDIA_GALLERY="mg";
a.OTHER="othr"})(ra||(ra={}));var sa;(function(a){a.SEE_MORE="sm";a.POPOVER="pop";a.IMAGE="img";a.VIDEO="vid"})(sa||(sa={}));var ta;(function(a){a.DESKTOP="d";a.MOBILE_APP="ma";a.MOBILE_BROWSER="mb";a.TABLET_APP="ta";a.TABLET_BROWSER="tb";a.UNKNOWN="unkn"})(ta||(ta={}));var Ba=function(){function a(b,c,d,e){this.page=b;this.device=c;this.widget=d;this.location=e}a.prototype.toString=function(){return a.PREFIX+a.DELIMITER+this.page+a.DELIMITER+this.device+a.DELIMITER+this.widget+a.DELIMITER+this.location};
a.prototype.appendToString=function(b){return b?this.toString()+a.DELIMITER+b:this.toString()};a.MAX_LENGTH=32;a.PREFIX="cm_cr";a.DELIMITER="_";return a}(),Zc=new Ba(ra.DETAIL_PAGE_WIDGET,ta.MOBILE_APP,qa.CAROUSEL,sa.IMAGE),$c=new Ba(ra.DETAIL_PAGE_WIDGET,ta.MOBILE_APP,qa.CAROUSEL,sa.VIDEO),ad=new Ba(ra.DETAIL_PAGE_WIDGET,ta.MOBILE_APP,qa.IMAGES_CAROUSEL,sa.SEE_MORE),bd=new Ba(ra.DETAIL_PAGE_WIDGET,ta.MOBILE_APP,qa.VIDEOS_CAROUSEL,sa.SEE_MORE),cd=new Ba(ra.DETAIL_PAGE_WIDGET,ta.MOBILE_BROWSER,qa.IMAGES_CAROUSEL,
sa.SEE_MORE),dd=new Ba(ra.DETAIL_PAGE_WIDGET,ta.MOBILE_BROWSER,qa.CAROUSEL,sa.VIDEO),ed=function(){function a(){}a.prototype.onVideoClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.onMediaClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onImageClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,
this.onMediaClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onSeeMoreClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f;return g.__generator(this,function(h){switch(h.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=G[d.mediatype],f=Wa(e),[4,this.goToGallery(b,f)];case 1:return h.sent(),[2]}})})};a.prototype.onMediaClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,m;return g.__generator(this,
function(l){switch(l.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=G[d.mediatype],f=d.rank,h={reviewId:d.reviewid,mediaType:e,url:d.url,thumbnailUrl:d.thumbnailurl,physicalId:d.physicalid,asin:d.asin,isSingleReview:!1,hidePivot:!1,refMarker:a.getIVXRefMarker(e,f),ingressType:"dpreviews",filter:e===G.IMAGE?"image":"video",metricsPrefix:e===G.IMAGE?"CarouselImageToAppX":"CarouselVideoToAppX"},[4,cb()];case 1:return m=l.sent(),m.addEventListener("com.amazon.mshop.ivx1.closed.progressPositionAndMediaIdSend",
function(){this.refocusToMedia(d.physicalId);m.removeEventListener("com.amazon.mshop.ivx1.closed.progressPositionAndMediaIdSend")}),[4,Zb(m,h)];case 2:return l.sent(),[2]}})})};a.prototype.refocusToMedia=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){return[2,new Promise(function(d,e){var f=Q["default"].cardRoot.ownerDocument.querySelector('button[data-physicalid="'+b+'"]');setTimeout(function(){null===f||void 0===f?void 0:f.focus();d()},0)})]})})};
a.prototype.goToGallery=function(b,c){var d;return g.__awaiter(this,void 0,void 0,function(){var e,f,h,m;return g.__generator(this,function(l){switch(l.label){case 0:return e=null===(d=b.currentTarget)||void 0===d?void 0:d.dataset,f=e.asin,h=c===ja.IMAGE?ad:bd,[4,cb()];case 1:return m=l.sent(),m.navigate({url:wb(h.toString(),c,f),successCallback:function(){O.logNoError("loadMediaGalleryError",c)},failCallback:function(q){xb("Failed to load gallery for asin: "+f+".",q);O.logError("loadMediaGalleryError",
c)}}),[2]}})})};a.getIVXRefMarker=function(b,c){return(b===G.IMAGE?Zc:$c).appendToString(c)};return a}(),V=function(){function a(b){var c=this;this.popover=b;this.loadMediaResources=function(){for(var d=c.popover.querySelectorAll("[data-lazyimagesource]"),e=0;e<d.length;e++){var f=d[e],h=f.getAttribute("data-lazyimagesource");f="img"===f.tagName.toLowerCase()?f:f.getElementsByTagName("img")[0];f.getAttribute("src")!=h&&f.setAttribute("src",h)}};this.getCurrentMediaIndex=function(){for(var d=c.popover.querySelectorAll("[data-mediaid]"),
e=0;e<d.length;e++)if("none"!==d[e].style.display)return e;return 0};this.getPreviousPopoverWidget=function(){return c.popover.previousElementSibling?new a(c.popover.previousElementSibling):null};this.getNextPopoverWidget=function(){return c.popover.nextElementSibling?new a(c.popover.nextElementSibling):null};this.getNumbersOfMedia=function(){return c.popover.querySelectorAll("[data-mediaid]").length};this.toggleOverlay=function(){var d=c.popover.getElementsByClassName("_Y3Itb_overlay-content-container_1ubFP")[0];
d.classList.contains("_Y3Itb_media-popover-overlay-fade-out_1eneO")?(d.classList.remove("_Y3Itb_media-popover-overlay-fade-out_1eneO"),d.classList.add("_Y3Itb_media-popover-overlay-fade-in_bZzwP")):(d.classList.add("_Y3Itb_media-popover-overlay-fade-out_1eneO"),d.classList.remove("_Y3Itb_media-popover-overlay-fade-in_bZzwP"))};this.scrollIntoSelf=function(){c.popover.scrollIntoView()};this.scrollIntoMediaByIndex=function(d){c.scrollIntoSelf();var e=!1;c.popover.querySelectorAll("[data-mediaid]").forEach(function(f,
h){e?c.removeHighlightPageIndicator(h):c.addHighlightPageIndicator(h);h==d?(N(f),e=!0):K(f)})};this.scrollIntoMediaId=function(d){c.scrollIntoSelf();c.popover.querySelectorAll("[data-mediaid]").forEach(function(e,f){e.getAttribute("data-mediaid")===d&&c.scrollIntoMediaByIndex(f)})};this.getReviewId=function(){return c.popover.getAttribute("data-reviewid")};this.getPageIndicator=function(d){var e=c.popover.getElementsByClassName("_Y3Itb_media-popover-page-indicator_36NFP")[0];if(e)return e.childNodes[d]};
this.addHighlightPageIndicator=function(d){d=c.getPageIndicator(d);null===d||void 0===d?void 0:d.classList.add("_Y3Itb_highlighted_1QxVg")};this.removeHighlightPageIndicator=function(d){d=c.getPageIndicator(d);null===d||void 0===d?void 0:d.classList.remove("_Y3Itb_highlighted_1QxVg")}}a.getPopoverWidgetById=function(b){return b?Q["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-list-container_3mcnh")[0].querySelector("div[data-reviewid='"+b+"']"):null};a.prototype.handlePopoverClick=
function(b){switch(b){case X.LEFT:if(0<this.getCurrentMediaIndex())this.scrollIntoMediaByIndex(this.getCurrentMediaIndex()-1);else if(b=this.getPreviousPopoverWidget())b.scrollIntoSelf(),b.scrollIntoMediaByIndex(b.getNumbersOfMedia()-1);break;case X.CENTER:this.toggleOverlay();break;case X.RIGHT:if(this.getCurrentMediaIndex()<this.getNumbersOfMedia()-1)this.scrollIntoMediaByIndex(this.getCurrentMediaIndex()+1);else if(b=this.getNextPopoverWidget())b.scrollIntoSelf(),b.scrollIntoMediaByIndex(0)}};
a.prototype.scrollIntoNextPopover=function(){var b=this.getNextPopoverWidget()||this.getPreviousPopoverWidget();b&&b.scrollIntoSelf()};return a}(),da;(function(a){a.closePopoverClickHandler="ClosePopoverClickHandler";a.popoverClickHandler="PopoverClickHandler";a.desktopLeftClickHandler="DesktopLeftClickHandler";a.desktopRightClickHandler="DesktopRightClickHandler";a.openReportConfirmationDialogClickHandler="OpenReportConfirmationDialogClickHandler";a.helpfulVoteClickHandler="HelpfulVoteClickHandler";
a.confirmReportAbuseClickHandler="ConfirmReportAbuseClickHandler";a.noopHandler="noopHandler";a.loadMediaPopover="loadMediaPopover";a.closePopoverErrorDialogClickHandler="ClosePopoverErrorDialogClickHandler"})(da||(da={}));var fd=function(){function a(b){this.popover=b;b=b.getElementsByClassName("_Y3Itb_cr-popover-overlay-text-container_NfghQ")[0];this.text=b.querySelector("._Y3Itb_cr-text_28H9k");this.title=b.querySelector("._Y3Itb_cr-title_3bWqW");this.expandButton=b.querySelector("._Y3Itb_cr-text-expand-button_2BWKW");
this.hideButton=b.querySelector("._Y3Itb_cr-text-hide-button_2qNi2")}a.prototype.toggleElementExpansion=function(b,c){c?(b.classList.remove("_Y3Itb_truncated_j_-Jw"),b.classList.add("_Y3Itb_expanded_2wQ4c")):(b.classList.remove("_Y3Itb_expanded_2wQ4c"),b.classList.add("_Y3Itb_truncated_j_-Jw"))};a.prototype.initResizeObserver=function(){var b=this;if(this.title||this.text)this.observer=new ResizeObserver(function(c){var d;try{for(var e=g.__values(c),f=e.next();!f.done;f=e.next())a.isTruncated(f.value.target,
"_Y3Itb_truncated_j_-Jw")&&N(b.expandButton)}catch(m){var h={error:m}}finally{try{f&&!f.done&&(d=e.return)&&d.call(e)}finally{if(h)throw h.error;}}}),this.title&&this.observer.observe(this.title),this.text&&this.observer.observe(this.text)};a.prototype.expandText=function(){this.text&&a.isTruncated(this.text,"_Y3Itb_truncated_j_-Jw")&&this.toggleElementExpansion(this.text,!0);this.title&&a.isTruncated(this.title,"_Y3Itb_truncated_j_-Jw")&&this.title.classList.remove("_Y3Itb_truncated_j_-Jw");K(this.expandButton);
N(this.hideButton);this.setPopoverOverlayGradient(!0);this.showActionButtons(!1)};a.prototype.toggleText=function(){this.text&&a.isTruncated(this.text,"_Y3Itb_truncated_j_-Jw")||this.title&&a.isTruncated(this.title,"_Y3Itb_truncated_j_-Jw")?this.expandText():this.hideText()};a.prototype.hideText=function(){this.text&&(this.text.offsetHeight<this.text.scrollHeight&&(this.text.scrollTop=0),this.toggleElementExpansion(this.text,!1));this.title&&this.title.classList.add("_Y3Itb_truncated_j_-Jw");K(this.hideButton);
this.setPopoverOverlayGradient(!1);this.showActionButtons(!0)};a.prototype.setPopoverOverlayGradient=function(b){var c=this.popover.getElementsByClassName("_Y3Itb_cr-media-popover-overlay-container_32qUq")[0];c&&(b?(c.classList.add("_Y3Itb_popover-overlay-gradient_114MI"),c.dataset.mixOperations=da.noopHandler):c.classList.contains("_Y3Itb_popover-overlay-gradient_114MI")&&(c.classList.remove("_Y3Itb_popover-overlay-gradient_114MI"),c.dataset.mixOperations&&delete c.dataset.mixOperations))};a.prototype.showActionButtons=
function(b){var c=this.popover.getElementsByClassName("_Y3Itb_cr-action-buttons-container_28a_m")[0];c&&(b?N(c):K(c))};a.isTruncated=function(b,c){return b&&b.offsetHeight<b.scrollHeight&&b.classList.contains(c)};return a}(),qb=function(a){if(a)return(null===a||void 0===a?0:a.getElementsByClassName("_Y3Itb_cr-popover-overlay-text-container_NfghQ")[0])?new fd(a):void 0},gd=function(){return function(){var a=this;this.show=function(){N(a.popoverList)};this.hide=function(){K(a.popoverList)};this.getNumberOfPopoversLoaded=
function(){return a.popoverList.childNodes.length};this.getNumberOfPopoversLeft=function(){if(a.currentReviewId){var b=0;a.popoverList.childNodes.forEach(function(c,d){c.getAttribute("data-reviewid")==a.currentReviewId&&(b=a.getNumberOfPopoversLoaded()-d)});return b}return a.popoverList.childNodes.length};this.addPopovers=function(b){b.querySelectorAll("._Y3Itb_media-popover-container_15D5F").forEach(function(c){c=fa.unscope(c);var d=c.getAttribute("data-reviewid");V.getPopoverWidgetById(d)||(a.popoverList.appendChild(c),
a.observer.observe(c),c=qb(V.getPopoverWidgetById(d)),null===c||void 0===c?void 0:c.initResizeObserver())})};this.scrollTo=function(b,c){a.setCurrentReviewId(b);b=V.getPopoverWidgetById(b);(new V(b)).scrollIntoMediaId(c)};this.setCurrentReviewId=function(b){a.currentReviewId=b};this.doesPopoverExists=function(b){return null!=V.getPopoverWidgetById(b)};this.getNextToken=function(){return a.popoverList.getAttribute("data-next-token")};this.setNextToken=function(b){return a.popoverList.setAttribute("data-next-token",
b)};this.setOnScrollCallback=function(b){a.onScrollCallback=b};this.popoverList=Q["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-list-container_3mcnh")[0];this.observer=new IntersectionObserver(function(b){b.forEach(function(c){if(c.isIntersecting){c=new V(c.target);var d=c.getReviewId(),e=a.currentReviewId;a.setCurrentReviewId(d);if(a.onScrollCallback)a.onScrollCallback(d);c.loadMediaResources();c=qb(V.getPopoverWidgetById(e));null===c||void 0===c?void 0:c.hideText()}})},
{threshold:.5})}}(),Va=function(){function a(){this.confirmationDialog=Q["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-report-abuse-confirmation-dialog_7HNIt");this.confirmButton=Q["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-report-abuse-confirmation-dialog-button_35f75")}a.prototype.setReviewId=function(b){this.confirmButton.dataset.id=b};a.prototype.setAsin=function(b){this.confirmButton.dataset.asin=b};a.prototype.show=function(){N(this.confirmationDialog)};
a.prototype.hide=function(){K(this.confirmationDialog)};return a}(),Qb=function(){function a(){this.popoverSkeleton=Q["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-skeleton-container_3DI7n")[0];this.profileSkeleton=this.popoverSkeleton.getElementsByClassName("_Y3Itb_profile-skeleton_1JfdD")[0]}a.prototype.show=function(){N(this.popoverSkeleton)};a.prototype.hide=function(){K(this.popoverSkeleton)};a.prototype.setLoadingAnimation=function(b){b?this.profileSkeleton.classList.add("_Y3Itb_loading_3908t"):
this.profileSkeleton.classList.contains("_Y3Itb_loading_3908t")&&this.profileSkeleton.classList.remove("_Y3Itb_loading_3908t")};return a}(),ua;(function(a){a[a.Popover=0]="Popover";a[a.Gallery=1]="Gallery";a[a.ReportAbuseConfirmationDialog=2]="ReportAbuseConfirmationDialog"})(ua||(ua={}));var Ha=function(){function a(){}a.getInstance=function(){a.instance||(a.instance=new a);return a.instance};a.prototype.initPopoverWidgetList=function(){null==this.popoverWidgetList&&(this.popoverWidgetList=new gd);
return this.popoverWidgetList};a.prototype.initPopoverSkeletonClient=function(){this.popoverSkeleton=new Qb};a.prototype.initPopover=function(b){a.currentScreen=ua.Popover;a.popoverName=b;this.resetOverlayComponents();this.initPopoverWidgetList();this.initPopoverSkeletonClient()};a.prototype.loadMediaPopover=function(b){return g.__awaiter(this,void 0,void 0,function(){var c,d,e,f,h,m,l,q=this;return g.__generator(this,function(n){switch(n.label){case 0:return this.initPopover(b.popoverDetails.popoverName),
this.popoverSkeleton.show(),this.popoverWidgetList.hide(),this.popoverSkeleton.setLoadingAnimation(!0),b.popoverDetails.popover?[4,b.popoverDetails.popover.showSync()]:[3,2];case 1:n.sent(),n.label=2;case 2:c=this.popoverWidgetList.doesPopoverExists(b.reviewId),d=0,n.label=3;case 3:n.trys.push([3,9,,10]),n.label=4;case 4:if(c)return[3,6];e=0===d;return[4,this.fetchAnotherPopoversPage(b.asin,b.mediaType,e)];case 5:return f=n.sent(),c=this.popoverWidgetList.doesPopoverExists(b.reviewId),d++,f?[3,4]:
[3,6];case 6:if(c)return[3,8];h=va.setup(["renderPopover"]);return[4,h.renderPopover({reviewId:b.reviewId})];case 7:m=n.sent(),this.popoverWidgetList.addPopovers(m),this.popoverWidgetList.setNextToken(""),c=!0,O.logCounter("mobileweb.missingReviewId",1),n.label=8;case 8:return this.popoverWidgetList.show(),c&&this.popoverWidgetList.scrollTo(b.reviewId,b.mediaId),this.popoverSkeleton.hide(),[3,10];case 9:return n.sent(),O.logCounter("mobile.popoverLoading.Error",1),this.popoverSkeleton.setLoadingAnimation(!1),
l=new ya("loadPopoverError"),l.setClickParams(new Map([["data-popovername",b.popoverDetails.popoverName],["data-asin",b.asin],["data-mediatype",b.mediaType.toString()],["data-reviewid",b.reviewId],["data-mediaid",b.mediaId]])),l.show(),[3,10];case 10:return this.popoverWidgetList.setOnScrollCallback(function(){5>=q.popoverWidgetList.getNumberOfPopoversLeft()&&q.fetchAnotherPopoversPage(b.asin,b.mediaType)}),[2]}})})};a.prototype.resetOverlayComponents=function(){(new Va).hide();(new ya("loadPopoverError")).hide();
(new ya("reportAbuseThankYouMessage")).hide()};a.prototype.showReportAbuseConfirmationDialog=function(b,c){a.currentScreen=ua.ReportAbuseConfirmationDialog;var d=new Va;d.setReviewId(b);d.setAsin(c);d.show()};a.prototype.back=function(){switch(a.currentScreen){case ua.Popover:case ua.Gallery:Ea.getPopoverByName(a.popoverName).hide();break;case ua.ReportAbuseConfirmationDialog:(new Va).hide(),a.currentScreen=ua.Popover}};a.prototype.fetchAnotherPopoversPage=function(b,c,d){void 0===d&&(d=!1);return g.__awaiter(this,
void 0,void 0,function(){var e,f;return g.__generator(this,function(h){switch(h.label){case 0:e=this.popoverWidgetList.getNumberOfPopoversLoaded();f=this.popoverWidgetList.getNextToken();if(!(d||!this.isAlreadyLoadingMedia&&f&&500>=e))return[3,5];this.isAlreadyLoadingMedia=!0;h.label=1;case 1:return h.trys.push([1,,3,4]),[4,this.loadPopovers(b,c,f)];case 2:return h.sent(),[3,4];case 3:return this.isAlreadyLoadingMedia=!1,[7];case 4:return[2,!0];case 5:return[2,!1]}})})};a.prototype.loadPopovers=function(b,
c,d){return g.__awaiter(this,void 0,void 0,function(){var e,f;return g.__generator(this,function(h){switch(h.label){case 0:return e=va.setup(["renderPopoverList"]),[4,e.renderPopoverList({asin:b,nextToken:d,mediaType:c,limit:50})];case 1:return f=h.sent(),this.popoverWidgetList.addPopovers(f),d=f.getAttribute("data-next-token"),this.popoverWidgetList.setNextToken(d),[2,d]}})})};return a}().getInstance(),hd=function(){function a(){}a.prototype.onVideoClickHandler=function(b){var c;return g.__awaiter(this,
void 0,void 0,function(){var d,e,f,h,m,l,q,n,w=this;return g.__generator(this,function(k){d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;e=d.asin;f=d.physicalid;h=d.reviewid;m=d.extension;l=d.thumbnailurl;q=this.getRefMarker(d.rank);Ja["default"].trigger("a:declarative:reviews:open-mweb-immersive-video-modal:click",{$event:b.event,$target:b.currentTarget,data:{asin:e,filter:"video",isSingleReview:!0,mediaType:"video",metricsPrefix:"CarouselVideoToAppX",physicalId:f,refMarker:q,reviewId:h,
shouldTriggerRefTag:!0,slateImageUrl:l,url:"https://m.media-amazon.com/images/I/"+f+"."+m}});n=function(){w.refocusToMedia(f);Ja["default"].off("vse:ns:partialcomponents:vse_reviews_mobile:lightboxClosed",n)};Ja["default"].on("vse:ns:partialcomponents:vse_reviews_mobile:lightboxClosed",n);return[2]})})};a.prototype.refocusToMedia=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){return[2,new Promise(function(d,e){var f=Q["default"].cardRoot.ownerDocument.querySelector('button[data-physicalid="'+
b+'"]');setTimeout(function(){null===f||void 0===f?void 0:f.focus();d()},0)})]})})};a.prototype.getRefMarker=function(b){return dd.appendToString(b)};return a}(),id=function(){function a(){this.mWebImmersiveVideoClickHandler=new hd}a.prototype.addMinHeightToParent=function(b){(b=Q["default"].cardRoot.ownerDocument.querySelector("."+b))&&b.parentElement&&(b.parentElement.style.minHeight="inherit")};a.prototype.onVideoClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,
function(c){switch(c.label){case 0:return[4,this.mWebImmersiveVideoClickHandler.onVideoClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onImageClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h,m;return g.__generator(this,function(l){switch(l.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=ka["default"].cardRoot.getElementsByClassName("_Y3Itb_media-popover-container_2BBbs")[0],f="cr-media-popover",[4,Bc.get(f,e,
b.currentTarget)];case 1:return h=l.sent(),m=G[d.mediatype],[4,Ha.loadMediaPopover({mediaType:m,asin:d.asin,reviewId:d.reviewid,mediaId:d.physicalid,popoverDetails:{popoverName:f,popover:h}})];case 2:return l.sent(),this.addMinHeightToParent("_Y3Itb_media-popover-container_2BBbs"),b.currentTarget&&b.currentTarget.classList.remove("a-declarative"),[2]}})})};a.prototype.onSeeMoreClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,h;return g.__generator(this,function(m){d=
null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;e=G[d.mediatype];f=Wa(e);h=d.asin;if(f===ja.IMAGE)Z["default"].setLocation(wb(cd.toString(),ja.IMAGE,h));else throw O.logError("loadVideoGalleryError",f),Error("Video gallery is not available on mWeb.");return[2]})})};return a}(),jd=function(){function a(){}a.getThumbnailClickHandler=function(){return g.__awaiter(this,void 0,void 0,function(){var b;return g.__generator(this,function(c){switch(c.label){case 0:return[4,Hb()];case 1:b=c.sent();
switch(b){case ia.MSHOP:return[2,new ed];case ia.MWEB:return[2,new id];case ia.DESKTOP:return[2,new Yc]}return[2]}})})};return a}(),kd=function(){function a(b){this.clickHandler=b}a.prototype.registerThumbnailClickHandlers=function(){this.registerCRVideoThumbnailClickHandler();this.registerCRImageThumbnailClickHandler();this.registerCRSeeMoreThumbnailClickHandler()};a.prototype.registerCRVideoThumbnailClickHandler=function(){var b=this,c=I["default"].setup().define;c(zc.clickHandler,"click",function(d){return g.__awaiter(b,
void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onVideoClickHandler(d)];case 1:return e.sent(),O.logCounter("videoThumbnail.click",1),[2]}})})})};a.prototype.registerCRImageThumbnailClickHandler=function(){var b=this,c=I["default"].setup().define;c(xc.clickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onImageClickHandler(d)];
case 1:return e.sent(),O.logCounter("imageThumbnail.click",1),[2]}})})})};a.prototype.registerCRSeeMoreThumbnailClickHandler=function(){var b=this,c=I["default"].setup().define;c(yc.clickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){var e,f;return g.__generator(this,function(h){switch(h.label){case 0:return[4,this.clickHandler.onSeeMoreClickHandler(d)];case 1:return h.sent(),e=G[null===(f=d.currentTarget)||void 0===f?void 0:f.dataset.mediatype],O.logCounter("seeMore."+
e.toLowerCase()+".click",1),[2]}})})})};return a}(),rb;(rb||(rb={})).closePopoverClickHandler="ClosePopoverClickHandler";var ld=function(){function a(){}a.registerClosePopoverClickHandler=function(){var b=I["default"].setup().define;b(rb.closePopoverClickHandler,"click",function(c){c.stopBubble();Ha.back()})};return a}(),Ia;(function(a){a.expandTextClickHandler="expandTextClickHandler";a.hideTextClickHandler="hideTextClickHandler";a.toggleTextClickHandler="toggleTextClickHandler"})(Ia||(Ia={}));var md=
function(){function a(){}a.registerTextExpanderClickHandlers=function(){a.registerExpandTextClickHandler();a.registerHideTextClickHandler();a.registerToggleTextClickHandler()};a.registerExpandTextClickHandler=function(){var b=I["default"].setup().define;b(Ia.expandTextClickHandler,"click",function(c){c.stopBubble();c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.expandText()})};a.registerHideTextClickHandler=function(){var b=I["default"].setup().define;b(Ia.hideTextClickHandler,"click",
function(c){c.stopBubble();c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.hideText()})};a.registerToggleTextClickHandler=function(){var b=I["default"].setup().define;b(Ia.toggleTextClickHandler,"click",function(c){c.stopBubble();c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.toggleText()})};a.getTextExpanderClient=function(b){var c;b=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset.reviewid;return qb(V.getPopoverWidgetById(b))};return a}(),Rb=function(){function a(){this.errorDialog=
Q["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-error-dialog_2LoQP")}a.prototype.show=function(){N(this.errorDialog)};a.prototype.hide=function(){K(this.errorDialog)};return a}(),sb;(sb||(sb={})).closeToastBar="closeToastBarClickHandler";var Sb=function(){function a(){}a.registerCloseToastBarClickHandler=function(){var b=I["default"].setup().define;b(sb.closeToastBar,"click",function(c){c.stopBubble();c=c.currentTarget.closest("div[data-toast-bar-name='"+c.currentTarget.dataset.toastBarName+
"']");A(c,function(d){return K(d)})})};return a}(),nd=function(){function a(){}a.prototype.registerMediaPopoverClickHandlers=function(){ld.registerClosePopoverClickHandler();this.registerOpenPopoverReportConfirmationDialog();this.registerHelpfulVoteClickHandler();this.registerMediaOverlayClickHandlers();this.registerNoopHandler();this.registerConfirmReportAbuseClickHandler();this.registerClosePopoverErrorDialogClickHandler();this.registerLoadMediaPopoverClickHandler();Sb.registerCloseToastBarClickHandler()};
a.prototype.registerNoopHandler=function(){var b=I["default"].setup().define;b(da.noopHandler,"click",function(c){c.stopBubble()})};a.prototype.registerMediaOverlayClickHandlers=function(){this.registerMediaOverlayNavigationClickHandlers();md.registerTextExpanderClickHandlers()};a.prototype.registerClosePopoverErrorDialogClickHandler=function(){var b=I["default"].setup().define;b(da.closePopoverErrorDialogClickHandler,"click",function(c){c.stopBubble();(new Rb).hide()})};a.prototype.registerMediaOverlayNavigationClickHandlers=
function(){var b=I["default"].setup().define;b(da.popoverClickHandler,"click",function(c){var d=c.event,e=c.currentTarget;var f=d.clientX/e.clientWidth*100;d=d.clientY/e.clientHeight*100;e=(e.clientWidth>e.clientHeight?Fa.LANDSCAPE:Fa.POTRAIT)===Fa.POTRAIT?{lowerBound:33,upperBound:67}:{lowerBound:40,upperBound:80};f=d<=e.lowerBound||d>=e.upperBound?X.NONE:25>=f?X.LEFT:75<=f?X.RIGHT:X.CENTER;(new V(V.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(f)});b(da.desktopRightClickHandler,
"click",function(c){(new V(V.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(X.RIGHT)});b(da.desktopLeftClickHandler,"click",function(c){(new V(V.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(X.LEFT)})};a.prototype.registerOpenPopoverReportConfirmationDialog=function(){var b=I["default"].setup().define;b(da.openReportConfirmationDialogClickHandler,"click",function(c){c.stopBubble();Ha.showReportAbuseConfirmationDialog(c.currentTarget.dataset.id,
c.currentTarget.dataset.asin)})};a.prototype.showErrorDialog=function(){(new Va).hide();(new Rb).show()};a.prototype.registerConfirmReportAbuseClickHandler=function(){var b=this,c=I["default"].setup().define,d=ba["default"].setup(["reportAbuse"]);c(da.confirmReportAbuseClickHandler,"click",function(e){e.stopBubble();var f=e.currentTarget.firstChild.dataset.id;e=e.currentTarget.firstChild.dataset.asin;d.reportAbuse({reviewId:f,domain:Ca(),asin:e}).then(function(h){!h.success&&h.redirectUrl?Z["default"].setLocation(h.redirectUrl):
h.success?(Ha.back(),(new V(V.getPopoverWidgetById(f))).scrollIntoNextPopover(),(new ya("reportAbuseThankYouMessage")).show()):b.showErrorDialog()})})};a.prototype.registerHelpfulVoteClickHandler=function(){var b=this,c=I["default"].setup().define,d=ba["default"].setup(["helpful"]);c(da.helpfulVoteClickHandler,"click",function(e){e.stopBubble();var f=e.currentTarget.dataset.id;e=e.currentTarget.dataset.asin;d.helpful({reviewId:f,domain:Ca(),asin:e}).then(function(h){!h.success&&h.redirectUrl?Z["default"].setLocation(h.redirectUrl):
h.success?(new ob(ob.getActionButtonsContainer(f))).likeButtonClicked():b.showErrorDialog()})})};a.prototype.registerLoadMediaPopoverClickHandler=function(){var b=this,c=I["default"].setup().define;c(da.loadMediaPopover,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){var e,f,h,m;return g.__generator(this,function(l){switch(l.label){case 0:return e=new Qb,f=null===(m=d.currentTarget)||void 0===m?void 0:m.dataset,h=G[f.mediatype],e.show(),e.setLoadingAnimation(!0),[4,Ha.loadMediaPopover({asin:f.asin,
mediaType:h,reviewId:f.reviewid,mediaId:f.mediaid,popoverDetails:{popoverName:f.popovername},isDesktop:!Gb()})];case 1:return l.sent(),[2]}})})})};return a}(),aa=I["default"].setup().define,ea=function(a,b){A(a.currentTarget,function(c){var d=Jb(c);if(!d.mediaType)throw Error("unable to extract mediaType from element: "+a.operationName+", "+c.nodeName);var e=Ga.getData(d.mediaType);if(!e)throw Error("unable to get modalManager: "+a.operationName+", "+d);b(e,d,c.dataset)})},od=function(){aa(Y.galleryItemClickHandler,
"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){ea(a,function(c,d,e){if(!d.reviewId||!d.mediaId)throw Error("reviewId or mediaId was not found on the media gallery item: "+JSON.stringify(e));c.updateModalWithReview(d.reviewId,d.mediaId,d.mediaType)});return[2]})})})},pd=function(){aa(Y.showMediaGalleryClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){ea(a,function(c){return c.showMediaGallery()});
return[2]})})})},qd=function(){aa(Y.reloadMediaPopover,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){ea(a,function(c,d,e){if("true"===e.showgalleryinmodal&&!d.asin)throw Error("asin was not found on the toastbar : "+JSON.stringify(e));if(!("true"===e.showgalleryinmodal||d.reviewId&&d.mediaId&&d.asin))throw Error("reviewId/mediaId/asin was not found on the toastbar : "+JSON.stringify(e));c.loadModal({asin:d.asin,mediaId:d.mediaId,reviewId:d.reviewId,
mediaType:d.mediaType,showGalleryInModal:"true"==e.showgalleryinmodal?!0:!1,popoverDetails:{popoverName:e.popovername}})});return[2]})})})},rd=function(){aa(Y.thumbnailClickHandler,"click",function(a){ea(a,function(b,c,d){if(!c.mediaId)throw Error("mediaId was not found while clicking on media thumbnail: "+d);b.updateMediaInModal(c.mediaId)})})},sd=function(){aa(Y.rightClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){ea(a,function(c){return c.handleModalMediaProgressionClick(X.RIGHT)});
return[2]})})});aa(Y.leftClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){ea(a,function(c){return c.handleModalMediaProgressionClick(X.LEFT)});return[2]})})})},td=function(){aa(Y.expandTextClickHandler,"click",function(a){ea(a,function(b){return b.handleExpanderClick(Aa.EXPAND)})});aa(Y.hideTextClickHandler,"click",function(a){ea(a,function(b){return b.handleExpanderClick(Aa.HIDE)})})},ud=function(){aa(Y.openReportConfirmationDialogClickHandler,
"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){ea(a,function(c){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(d){c.openReportAbuseDialog(a.currentTarget);return[2]})})});return[2]})})});aa(Y.confirmReportAbuseClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){ea(a,function(c){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,
function(d){c.handleReportAbuseClick();return[2]})})});return[2]})})})},vd=function(){aa(Y.helpfulVoteClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){ea(a,function(c){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(d){c.handleHelpulVoteClick();return[2]})})});return[2]})})})},wd=function(){aa(Y.closeMediaPopover,"click",function(a){ea(a,function(b){return g.__awaiter(void 0,void 0,void 0,
function(){return g.__generator(this,function(c){b.closeModal();return[2]})})})})},xd=function(){aa(Y.noopHandler,"click",function(a){a.stopBubble()})},yd=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a,b;return g.__generator(this,function(c){switch(c.label){case 0:return[4,Hb()];case 1:a=c.sent();switch(a){case ia.DESKTOP:od();pd();qd();rd();sd();td();ud();vd();xd();wd();Sb.registerCloseToastBarClickHandler();break;case ia.MWEB:b=new nd,b.registerMediaPopoverClickHandlers()}return[2]}})})};
tb._operationNames=[];tb.card=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a,b,c,d,e;return g.__generator(this,function(f){switch(f.label){case 0:return O.setPrefix("cr-media-carousel"),[4,jd.getThumbnailClickHandler()];case 1:return a=f.sent(),b=new kd(a),b.registerThumbnailClickHandlers(),[4,db()];case 2:return f.sent()?[3,4]:[4,yd()];case 3:f.sent(),f.label=4;case 4:c=va.setup(["getTreatmentNoTrigger"]),f.label=5;case 5:return f.trys.push([5,10,,11]),[4,c.getTreatmentNoTrigger({weblabID:"COFEE_DD_MEDIA_CARDS_MIGRATION_SHARED_LIBRARY_1247512"})];
case 6:return d=f.sent(),"T1"!==d?[3,9]:[4,sc()];case 7:return f.sent(),[4,tc()];case 8:f.sent(),f.label=9;case 9:return[3,11];case 10:return e=f.sent(),O.logError("client.getWeblabTreatmentError",e),[3,11];case 11:return O.logCounter("client.loaded",1),[2]}})})}});
