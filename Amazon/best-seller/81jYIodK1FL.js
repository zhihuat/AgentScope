(function(v){var l=window.AmazonUIPageJS||window.P,u=l._namespace||l.attributeErrors,B=u?u("VSEComponentAssets",""):l;B.guardFatal?B.guardFatal(v)(B,window):B.execute(function(){v(B,window)})})(function(v,l,u){(function(){function B(d){l.URLSearchParams&&"1"===(new l.URLSearchParams(l.location.search)).get("iveDebug")&&(l.DistributionMetricsDebugInfo?l.DistributionMetricsDebugInfo.push(d):l.DistributionMetricsDebugInfo=[d])}function I(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(d){var c=16*Math.random()|0;return("x"==d?c:c&3|8).toString(16)})}l.vseFeatures=l.vseFeatures||{};var D=l.gatedP||{register:function(d,c,a,b,g){void 0===g&&(g=l.vseFeatures);v.now(d).execute(d+"-prereg",function(f){f||g[c]||(g[c]=!0,b.resolve(a(b)).then(function(){v.now(d).execute(d+"-reg",function(a){a||(v.log("Gated registration failed to register module!","ERROR",d),g[c]=!1)})}))})},declare:function(d,c,a,b){void 0===b&&(b=l.vseFeatures);v.now(d).execute(d+"-prereg",function(g){g||b[c]||
(b[c]=!0,v.declare(d,a))})}},m={count:function(d,c){var a=l.ue;a&&a.count("vse:csm:"+d,c)},emitNexusMetric:function(d,c,a,b){void 0===b&&(b=!1);l.ue&&l.ue.event&&d&&d.events&&d.events[0]&&d.events[0].data&&(l.ue.event(d.events[0].data,c,a),b&&B(d.events[0].data))},emitSushiMetric:function(d,c,a,b){var g=this;void 0===c&&(c=!1);a=a||"https://unagi-na.amazon.com/1/events/com.amazon.eel.vse.metricstest.nexus";b=b||0;if(!(3<=b)){var f=JSON.stringify(d).replace(/\\\\/g,""),k={params:f,paramsFormat:"json",
contentType:"application/json; charset\x3dutf-8",error:function(){g.emitSushiMetric(d,c,a,++b)}},h=navigator.userAgent.match(/iPhone/i),n=!1;v.now("mash").execute("vse-detect-mshop",function(){n=!0});var t=null!==h&&n;v.when("A").execute("Emit-VSE-Metrics",function(b){navigator&&navigator.sendBeacon&&!t?navigator.sendBeacon(a,f):b.post(a,k)});c&&B(d)}},logFatal:function(d,c,a){l.ueLogError&&l.ueLogError(a,{logLevel:"FATAL",attribution:d,message:c})},logError:function(d,c,a){l.ueLogError&&l.ueLogError(a,
{logLevel:"ERROR",attribution:d,message:c})}},F={makeApplicationSushiPayloadBuilder:function(d,c){return function(a){var b={eventSource:c.eventSource,requestId:c.requestId,sessionId:c.sessionId,placementContext:c.placementContext,creativeId:c.creativeId||"",marketplaceId:c.marketplaceId,weblabIds:c.weblabIds,clientId:c.clientId,isInternal:c.isInternal.toString(),isRobot:c.isRobot.toString(),pageAsin:c.pageAsin,customerId:c.customerId,sessionType:c.sessionType||1,refMarkers:c.refMarkers,eventId:I(),
timestamp:new Date,userAgentData:navigator.userAgent,titleSessionId:0,videoAsin:0,pageUrl:null!==l.location.href?l.location.href.substring(0,500):"",videoAsinList:c.videoAsinList||"",rankingStrategy:""};return{events:[{data:d.$.extend(b,a)}]}}},makeApplicationNexusPayloadBuilder:function(d,c){return function(a){var b={eventSource:c.eventSource,placementContext:c.placementContext,userAgentData:navigator.userAgent,videoAsin:c.videoAsin||"",pageAsin:c.pageAsin||"",videoAsinList:c.videoAsinList||"",titleSessionId:"0",
stringPayload:"",intPayload:1,rankingStrategy:"",creativeId:c.creativeId||"",clientId:c.clientId,pageUrl:null!==l.location.href?l.location.href.substring(0,500):"",customerId:c.customerId||""};return{events:[{data:d.$.extend(b,a)}]}}},makeClickstreamNexusPayloadBuilder:function(d,c){return function(a){return d.$.extend({timestamp:new Date,actionType:c.actionType,eventOwner:c.producerId,eventType:c.eventType,productId:c.productId},a)}},extendWithNewField:function(d,c,a){return d&&d.events&&d.events[0]&&
d.events[0].data?(d=d.events[0].data,d[c]=a,{events:[{data:d}]}):d}},y={fetchLatestPageState:function(d,c){d.state.replace(c,JSON.parse(d.$("script[type\x3d'a-state'][data-a-state*\x3d"+c+"]").html()));return d.state(c)},isDefined:function(d){return"undefined"!==typeof d&&null!==d}},w={updateReftagParam:function(d,c){return w.updateQueryStringParameter(d,"ref_?","ref",c)},updateQueryStringParameter:function(d,c,a,b){c=new RegExp("([?\x26/])"+c+"\x3d.*?(\x26|$)","i");var g=-1!==d.indexOf("?")?"\x26":
"?";return d.match(c)?d.replace(c,"$1"+a+"\x3d"+b+"$2"):d+g+a+"\x3d"+b},generateUUID:function(){for(var d="",c=0;13>c;c++)d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return d},decodeEntities:function(d){var c=document.createElement("textarea");c.innerHTML=d;return c.value},triggerShare:function(d,c,a,b){if(c){c=screen.width;var g=screen.height;a=a?a:.7*c;b=b?b:.7*g;l.open(d,"_blank","toolbar\x3d0,status\x3d0,width\x3d"+a+",height\x3d"+b+
",top\x3d"+(g/2-b/2)+",left\x3d"+(c/2-a/2))}else l.open(d,"_self")},getPageData:function(d){return"undefined"!==typeof d.pageLevelStateKey?A.state(d.pageLevelStateKey):d.pageLevelData},buildUrl:function(d,c){c=c||{};for(var a=l.navigator&&l.navigator.userAgent&&l.navigator.userAgent.match(/iPhone/i),b=Object.keys(c),g=0<b.length&&("sms:"!==d||!a)?"?":"",a=0;a<b.length;a++)"?"!==g&&(g+="\x26"),c[b[a]]&&(g+=b[a]+"\x3d"+encodeURIComponent(c[b[a]]));return d+g},generateReftags:function(d,c){var a,b;d=
w.getPageData(d);"undefined"!==typeof d&&(a=d.clientRef,b=d.deviceTypeRef);a=a?a:"un";b=b?b:"un";d=c?c:"un";c=w.generateUUID();d="cm_sw_"+d;a=a+"_"+b+"_"+c;return{returnReftag:d+"_r_"+a,clickReftag:d+"_c_"+a}},copyLinkToClipboard:function(d){var c=w.generateReftags(d,"cp"),c=w.updateReftagParam(d.url,c.returnReftag);l.isSecureContext&&navigator.clipboard&&navigator.clipboard.writeText(c).then(function(){var a=document.getElementById(d.socialShareId+"-copy");if(a){var b=a.getElementsByClassName("ive-copy-text")[0];
if(b){var c=b.textContent;b.textContent=d.shareCopyLinkSuccessText;setTimeout(function(){b&&(b.textContent=c)},1E3)}}}).catch(function(){m.count("iveSocialShareCopyLinkFailed",1)})}},ha={share:function(d,c){var a={facebook:{shareEndpoint:"https://www.facebook.com/dialog/share",params:function(a){return{href:w.decodeEntities(a.url),display:"popup",quote:a.quote?w.decodeEntities(a.quote):"",app_id:"465632727431967"}},ref:"fb",height:450,width:700,isWebShare:!0},pinterest:{shareEndpoint:"https://www.pinterest.com/pin/create/button",
params:function(a){return{url:w.decodeEntities(a.url),media:w.decodeEntities(a.image),description:w.decodeEntities(a.description)}},ref:"pi",height:620,width:700,isWebShare:!0},twitter:{shareEndpoint:"https://twitter.com/intent/tweet",params:function(a){var c=w.decodeEntities(a.title);a=w.decodeEntities(a.url);if(c){var d=a?Math.min(a.length,20):-1;200<c.length+d+1&&(c=c.substring(0,200-(d+1+3))+"...")}return{text:c,url:a}},ref:"tw",height:470,width:670,isWebShare:!0},email:{shareEndpoint:"mailto:",
params:function(a){return{subject:w.decodeEntities(a.title),body:w.decodeEntities(a.description)+"\n"+w.decodeEntities(a.url)}},ref:"em",height:470,width:670,isWebShare:!1},sms:{shareEndpoint:"sms:",params:function(a){return{body:w.decodeEntities(a.title)+" "+w.decodeEntities(a.url)}},ref:"sm",height:470,width:670,isWebShare:!1},whatsapp:{shareEndpoint:"https://api.whatsapp.com/send",params:function(a){return{text:w.decodeEntities(a.description)+"\n"+w.decodeEntities(a.url)}},ref:"wa",height:470,
width:670,isWebShare:!0}};"copy"===c?w.copyLinkToClipboard(d):(c=a[c],a=w.generateReftags(d,c.ref),d.url=w.updateReftagParam(d.url,a.returnReftag),d=w.buildUrl(c.shareEndpoint,c.params(d)),w.triggerShare(d,c.isWebShare,c.width,c.height))}},z={sendRequest:function(d,c,a,b,g){d.ajax(c,{params:a,paramsFormat:"json",crossDomain:!0,method:"POST",withCredentials:!0,contentType:"application/json",success:b,error:g})}},ia={sendRequest:function(d,c,a,b,g){d.ajax(c,{params:a,paramsFormat:"json",crossDomain:!0,
method:"POST",withCredentials:!0,contentType:"application/json",success:b,error:g})}},ja={getClosedCaptions:function(d,c){var a=[];if(!d.objectIsEmpty(c))for(d=c.split(","),c=0;c<d.length;c+=2)d[c+1]!==u&&a.push({locale:d[c],url:d[c+1]});return a}},H=function(){return function(d){this.message=d}}(),J=function(){function d(c,a){void 0===a&&(a={refTagRecorderEndPoint:"/gp/mobile/tag/?",retryLimit:3});this.A=c;this.config=a}d.prototype.emitRefTag=function(c,a){void 0===a&&(a=0);if(!(a>=this.config.retryLimit)){var b=
this;this.A.get(this.config.refTagRecorderEndPoint+"ref\x3d"+c,{error:function(){b.emitRefTag(c,++a)}})}};return d}(),ka=u&&u.__assign||Object.assign||function(d){for(var c,a=1,b=arguments.length;a<b;a++){c=arguments[a];for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(d[g]=c[g])}return d},la=function(){function d(c){var a=this;this.config=c;this.log=function(b){if(a.videoEvent){var c=a.$container.closest("[data-csa-c-id]");0<c.length?(a.basePayload.parentElementId=c.data("csa-c-id"),a.videoEvent("setEntity",
{video:ka({},a.basePayload,b)}),a.videoEvent("log",{schemaId:a.schemaId},{ent:"all"})):l.ue&&(l.ue.count(d.CANNOT_FIND_CSA_WIDGET,1),m.logError("ive-lucid-video-events","Cannot find CSA widget, container id: "+a.$container.attr("id")+", eventPayload: "+JSON.stringify(b),"Cannot find CSA widget, container id: "+a.$container.attr("id")+", eventPayload: "+JSON.stringify(b)))}else m.count("ive:csa:cannotCreateVideoEvent:noVideoEvent",1)};this.schemaId=c.schemaId;this.$container=c.$container;this.basePayload=
{player:"Brila",parentElementId:""};l.csa?this.videoEvent=l.csa("Events",{producerId:c.producerId,lob:l.ue_lob?l.ue_lob:""}):m.count("ive:csa:cannotCreateVideoEvent:noCsaAvailable",1)}d.CANNOT_FIND_CSA_WIDGET="ive-cannot-find-csa-widget";return d}(),Q=function(){function d(c,a,b,g,f){var k=this;this.player=a;this.A=b;this.isIvx=g;this.clientPrefix=f;this.secondsFromLastEvent=this.lastLoggedEventInterval=this.loggingInterval=this.initialLoggingDelay=0;this.aciContentId="";this.emitCarouselClickEvent=
function(){k.logCSAEvent(k.secondsFromLastEvent,"ENDED");k.isAutoplay=!1};this.attachPlayerEventListeners=function(){k.player.on("playbackStart",k._playbackStartHandler);k.player.on("playbackComplete",k._playbackCompleteHandler);k.player.on("fullscreenchange",k._playerModeChangeHandler);k.player.on("pause",k._playbackPauseHandler);k.player.on("mute",k._playbackMuteHandler);k.player.on("unmute",k._playbackUnmuteHandler);k.player.on("enableClosedCaptions",k._playbackEnableClosedCaptionsHandler);k.player.on("disableClosedCaptions",
k._playbackDisableClosedCaptionsHandler);k.A.on("vse:"+k.clientPrefix+":player:continuous:play",function(){k.isAutoplay=!0});k.A.on("vse:"+k.clientPrefix+":page:lightBoxClosed",function(){k.isAutoplay=!1})};this._playbackStartHandler=function(){k.aciContentId=k.getCurrentACIContentId();k.logCSAEvent(k.secondsFromLastEvent,"PLAYING");m.count(k.clientPrefix+":csa:startPlaying",1);k.removeCSAEventHandler();k.addCSAEventHandler()};this._playbackCompleteHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,
"ENDED");k.removeCSAEventHandler()};this._playerModeChangeHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"MODE_CHANGED",k.currentPlayerMode);k.removeCSAEventHandler();k.addCSAEventHandler()};this._playbackPauseHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"STOPPED");k.removeCSAEventHandler()};this._playbackMuteHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"MUTED");k.removeCSAEventHandler();k.addCSAEventHandler()};this._playbackUnmuteHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,
"UNMUTED");k.removeCSAEventHandler();k.addCSAEventHandler()};this._playbackEnableClosedCaptionsHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"CAPTIONS_ON");k.removeCSAEventHandler();k.addCSAEventHandler()};this._playbackDisableClosedCaptionsHandler=function(){k.logCSAEvent(k.secondsFromLastEvent,"CAPTIONS_OFF");k.removeCSAEventHandler();k.addCSAEventHandler()};this.addCSAEventHandler=function(){k.lastLoggedEventInterval=k.A.interval(function(){k.secondsFromLastEvent++},d.TIMERS.TIME_FROM_LAST_EVENT_MS);
k.initialLoggingDelay=k.A.delay(function(){k.logCSAEvent(k.secondsFromLastEvent,"PLAYING");k.loggingInterval=k.A.interval(function(){k.logCSAEvent(k.secondsFromLastEvent,"NONE")},d.TIMERS.SUBSEQUENT_INTERVAL_MS)},d.TIMERS.INITIAL_DELAY_MS)};this.removeCSAEventHandler=function(){clearInterval(k.lastLoggedEventInterval);clearInterval(k.loggingInterval);clearTimeout(k.initialLoggingDelay);k.secondsFromLastEvent=0;k.loggingInterval=0;k.initialLoggingDelay=0};this.logCSAEvent=function(a,b,c){""!==k.aciContentId?
(k.currentPlayerMode=k.getCurrentPlayerMode(),a={contentId:k.aciContentId,viewDuration:a.toString(),playerMode:c||k.currentPlayerMode,isAutoPlayed:k.isAutoplay.toString(),isCaptionOn:k.player.isCaptionOn().toString(),isAudioOn:(!k.player.isMuted()).toString(),videoRequestId:k.player.getTitleSessionId().toString(),eventName:b},k.csa.log(a),k.secondsFromLastEvent=0):m.count(k.clientPrefix+":csa:noContentIdPresented",1)};this.csa=new la(c);this.player=a;this.currentPlayerMode=this.getCurrentPlayerMode();
this.isAutoplay=this.player.isAutoplayed();this.attachPlayerEventListeners()}d.prototype.getCurrentPlayerMode=function(){return this.isIvx?"IMMERSIVE_VIEW":this.player.isFullscreen()?"FULL_SCREEN":"MODAL"};d.prototype.getCurrentACIContentId=function(){return this.player.getCurrent().aciContentId||""};d.TIMERS={INITIAL_DELAY_MS:2E3,SUBSEQUENT_INTERVAL_MS:3E4,TIME_FROM_LAST_EVENT_MS:1E3};return d}(),R=function(){return function(d){var c=this;this.A=d;this.buildTag=function(a){if(!a.href)return"";var b=
"tag\x3d"+a.vendorTrackingId,g=a.asin;c.A.objectIsEmpty(g)||(g="\x26creativeASIN\x3d"+g);var d="linkCode\x3d",d=c.A.objectIsEmpty(a.linkCode)?d+"vse":d+a.linkCode,f=a.aciContentId,h="";c.A.objectIsEmpty(a.aciContentId)||(h="\x26asc_contentid\x3d"+f);b=b+"\x26"+d+g+h;b=0>a.href.indexOf("?")?"?"+b:"\x26"+b;return a.href+b}}}(),S={queueComplete:!0},T=function(){function d(c,a,b){var g=this;this.player=c;this.frame=a;this.assets=[];this.currentIndex=0;this.eventEmitter=new b.EventEmitter;this.player.on("playbackComplete",
function(){g.currentIndex++;g.doPlay()})}d.prototype.play=function(c){c?this.player.play(c):this.player.play();return this};d.prototype.emitStartCountMetric=function(){this.player.emitStartCountMetric();return this};d.prototype.emitScrubberClick=function(){this.player.emitScrubberClick();return this};d.prototype.emitSkipForwardClick=function(){this.player.emitSkipForwardClick();return this};d.prototype.emitSkipBackwardClick=function(){this.player.emitSkipBackwardClick();return this};d.prototype.getCurrentTime=
function(){return this.player.getCurrentTime()};d.prototype.setCurrentTime=function(c){this.player.setCurrentTime(c);return this};d.prototype.getMediaDuration=function(){return this.player.getMediaDuration()};d.prototype.mute=function(c){this.player.mute(c);return this};d.prototype.unmute=function(){this.player.unmute();return this};d.prototype.isMuted=function(){return this.player.isMuted()};d.prototype.resume=function(c){this.player.resume(c);return this};d.prototype.pause=function(c){this.player.pause(c);
return this};d.prototype.next=function(){this.player.stop();this.currentIndex++;this.doPlay();return this};d.prototype.previous=function(){this.player.stop();this.currentIndex--;this.doPlay();return this};d.prototype.seek=function(c){this.player.seek(c);return this};d.prototype.enqueue=function(c,a){void 0===a&&(a=this.assets.length);c instanceof Array?(c=c.slice(),c.splice(0,0,this.assets),Array.prototype.splice.apply(this.assets,c)):this.assets.splice(a,0,c);return this};d.prototype.dequeue=function(c){var a=
this,b;if("number"===typeof c)b=[c];else if(c instanceof Array){var g=c.map(function(a){return a.contentId});b=this.assets.map(function(a){return g.indexOf(a.contentId)}).filter(function(a){-1!=a})}else b=[this.assets.map(function(a,b){return b}).filter(function(b){a.assets[b].contentId==c.contentId})[0]];for(var d=0,f=b.length;d<f;d++)this.assets.splice(b[d],1);return this};d.prototype.on=function(c,a){if(S.hasOwnProperty(c))this.eventEmitter.on(c,a);else this.player.on(c,a);return this};d.prototype.off=
function(c,a){S.hasOwnProperty(c)?this.eventEmitter.off(c,a):this.player.off(c,a);return this};d.prototype.ready=function(c){this.player.ready(c);return this};d.prototype.readyState=function(){return this.player.readyState()};d.prototype.load=function(){this.player.load();return this};d.prototype.getAssets=function(){return this.assets};d.prototype.getCurrentAssetIndex=function(){return this.currentIndex-1};d.prototype.getPosition=function(){return this.player.getPosition()};d.prototype.isPlaying=
function(){return this.player.isPlaying()};d.prototype.isPaused=function(){return this.player.isPaused()};d.prototype.getVersion=function(){return this.player.getVersion()};d.prototype.destroy=function(){this.player.destroy()};d.prototype.addChild=function(c,a){this.player.addChild(c,a);return this};d.prototype.removeChild=function(c){this.player.removeChild(c);return this};d.prototype.loadNextVideoPoster=function(c){this.player.loadNextVideoPoster(c);return this};d.prototype.blur=function(){this.player.blur();
return this};d.prototype.requestFullscreen=function(){this.player.requestFullscreen();return this};d.prototype.exitFullscreen=function(){this.player.exitFullscreen();return this};d.prototype.isFullscreen=function(){return this.player.isFullscreen()};d.prototype.fluid=function(c){this.player.fluid(c);return this};d.prototype.aspectRatio=function(c){this.player.aspectRatio(c);return this};d.prototype.enableCurrentTextTrack=function(c){void 0===c&&(c="en");this.player.enableCurrentTextTrack(c);return this};
d.prototype.disableCurrentTextTrack=function(c){void 0===c&&(c="en");this.player.disableCurrentTextTrack(c);return this};d.prototype.updateTextTrack=function(c){this.player.updateTextTrack(c);return this};d.prototype.removeCurrentTextTracks=function(){this.player.removeCurrentTextTracks();return this};d.prototype.setInitialData=function(c){var a=document.getElementsByClassName("vse-player-container");this.player.setInitialData(c);c&&c.aciContentId&&0<a.length&&(a[0].hasAttribute("data-csa-c-content-id")||
""===a[0].getAttribute("data-csa-c-content-id"))&&a[0].setAttribute("data-csa-c-content-id",c.aciContentId);return this};d.prototype.showPoster=function(c){this.player.showPoster(c);return this};d.prototype.getCurrent=function(){return this.player.getCurrent()};d.prototype.isCaptionOn=function(){return this.player.isCaptionOn()};d.prototype.isAutoplayed=function(){return this.player.isAutoplayed()};d.prototype.getTitleSessionId=function(){return this.player.getTitleSessionId()};d.prototype.requestPictureInPicture=
function(){this.player.requestPictureInPicture();return this};d.prototype.exitPictureInPicture=function(){this.player.exitPictureInPicture();return this};d.prototype.setPlayerMode=function(c){this.player.setPlayerMode(c);return this};d.prototype.doPlay=function(){var c=this.player.getCurrent();c&&this.assets[this.currentIndex]?this.assets[this.currentIndex].contentId==c.contentId?this.player.play():this.player.play(this.assets[this.currentIndex]):this.assets[this.currentIndex]&&this.player.play(this.assets[this.currentIndex])};
return d}(),ma=function(){function d(c,a){var b=this;this.isMshop=this.isReportWidgetClosed=this.mouseOverVideoPlayer=!1;this.DISCLOSURE_SELECTOR=".ive-video-disclosure-container-wrapper";this.INFLUENCER_DISCLOSURE_SELECTOR=".ive-aip-link";this.PUBLISHER_DISCLOSURE_SELECTOR=".ive-osp-link";this.HIDDEN_CSS_CLASS="aok-hidden";this.REPORT_COPYRIGHT_SELECTOR=".vse-fb-copyright";this.REPORT_SHOWN_METRIC="ive:player:report:shown";this.REPORT_SUBMITTED_METRIC="ive:player:report:submit";this.REPORT_HIDDEN_METRIC=
"ive:player:report:hidden";this.update=function(a){b.report&&b.report.setActiveVideoAndSource(a.contentId,a.vendorCode,a.aciContentId);if(!0===b.config.includeEarnsComissionDisclosure&&b.$disclosureContainer){var c=b.$disclosureContainer.find(b.INFLUENCER_DISCLOSURE_SELECTOR),d=b.$disclosureContainer.find(b.PUBLISHER_DISCLOSURE_SELECTOR),f="Influencer"===a.creatorType;a="3P"===a.creatorType;c.toggleClass(b.HIDDEN_CSS_CLASS,!f);d.toggleClass(b.HIDDEN_CSS_CLASS,f);b.$disclosureContainer.toggleClass(b.HIDDEN_CSS_CLASS,
!(f||a))}};this.destroy=function(){b.report&&b.$reportContainer.remove();b.$disclosureContainer&&b.$disclosureContainer.remove()};this.deRegisterReport=function(){b.A.off("vse:"+b.reportId+":feedback:shown");b.A.off("vse:"+b.reportId+":feedback:hidden");b.A.off("vse:"+b.reportId+":feedback:submitted:success")};this.addReportHandlers=function(){b.A.on("vse:"+b.reportId+":feedback:shown",function(){m.count(b.REPORT_SHOWN_METRIC,1);b.playerShim&&b.playerShim.isPlaying()&&b.playerShim.pause();b.isReportWidgetClosed=
!1;b.$reportContainer.find(b.REPORT_COPYRIGHT_SELECTOR).click(function(a){b.isMshop&&(a.preventDefault(),b.report.showInfringementNotSupport())})});b.A.on("vse:"+b.reportId+":feedback:hidden",function(){m.count(b.REPORT_HIDDEN_METRIC,1);b.isReportWidgetClosed=!0;b.mouseOverVideoPlayer||b.hideReportWidget();b.$reportContainer.find(b.REPORT_COPYRIGHT_SELECTOR).unbind("click")});b.A.on("vse:"+b.reportId+":feedback:submitted:success",function(){m.count(b.REPORT_SUBMITTED_METRIC,1)})};this.showReportWidget=
function(){b.$reportContainer.css({display:"inline-block"});b.toggleDimVideoPlayer(!0)};this.hideReportWidget=function(){b.$reportContainer.css({display:"none"});b.toggleDimVideoPlayer(!1)};this.toggleDimVideoPlayer=function(a){b.$playerContainer.find("video").toggleClass("dim-video-player",a)};this.mouseLeaveHandler=function(){b.isReportWidgetClosed&&b.hideReportWidget();b.mouseOverVideoPlayer=!1};this.config=c;this.playerShim=a}d.prototype.initialize=function(c){var a=this;v.when("A","a-button",
"ready").execute("IVECreateBasicComponentsForPlayer",function(b,g){a.A=b;a.isMshop=b.capabilities.mobile&&b.capabilities.isAmazonApp;a.$playerContainer=a.A.$("#"+a.config.parentId);a.deRegisterReport();var d=b.state(a.config.reportPageStateName);a.reportId=d.id;b=new a.config.feedbackFactory({A:b,buttonApi:g});a.report=b.create(a.reportId,a.config.reportPageStateName,!1);a.addReportHandlers();a.$disclosureContainer=a.$playerContainer.parent().find(a.DISCLOSURE_SELECTOR);a.$playerContainer.append(a.$disclosureContainer);
a.update(c);a.$reportContainer=a.$playerContainer.parent().find(".ive-"+a.config.clientPrefix+"-report-container");a.isReportWidgetClosed=!0;a.$reportContainer.removeClass(a.HIDDEN_CSS_CLASS);a.$playerContainer.append(a.$reportContainer);b="report-overlays-player-"+a.reportId;a.A.declarative.create(a.$playerContainer,b,{});a.A.declarative(b,"mouseenter touchstart focus",function(){a.isReportWidgetClosed&&a.showReportWidget();a.mouseOverVideoPlayer=!0;a.A.capabilities.touch&&a.A.delay(a.mouseLeaveHandler,
3E3)});a.A.declarative(b,"mouseleave",a.mouseLeaveHandler)})};return d}(),na=u&&u.__assign||Object.assign||function(d){for(var c,a=1,b=arguments.length;a<b;a++){c=arguments[a];for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(d[g]=c[g])}return d},U=function(){function d(c,a,b,g){var d=this;this.config=a;this.libs=g;this.VSE_CC_KEY="vse_brila_cc_status";this.lastFrameTime=0;this.DRAW_DELAY_IN_MS=20;this.registerEventsForLazyBlur=function(a,b){if(b&&a)d.videoJS.on("timeupdate",function(){setTimeout(function(){d.draw(b.getContext("2d",
{alpha:!1}),a,d.getCurrentTime())},100)})};this.draw=function(a,b,c){void 0===c&&(c=0);var g=Math.abs(c-d.lastFrameTime);if(null===a||null===b||!d.isPlaying()||performance===u)return!1;var f=performance.now();f-d.lastFrameTime>=d.DRAW_DELAY_IN_MS&&(d.drawCover(a,b,g,c),d.lastFrameTime=f);l.requestAnimationFrame(function(){d.draw(a,b,c)})};this.drawCover=function(a,b,c,g){d.lastFrameTime=g;if(a){a.canvas.width=a.canvas.clientWidth;a.canvas.height=a.canvas.clientHeight;c=a.canvas.width;g=a.canvas.height;
var f=b.videoWidth,k=b.videoHeight,h=Math.max(c/f,g/k),f=f*h,k=k*h;a.imageSmoothingEnabled=!1;a.drawImage(b,(c-f)/2,(g-k)/2,f,k)}};this.encodeForHtml=function(a){return a.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#39;")};this.eventEmitter=new g.EventEmitter;this.currentAsset=b;this.localStorageEnabled=this.testLocalStorage();this.initHandlers();this.parentContainerId=a.parentId+"-element";this.altTextElement=this.createAltTextElement(a.parentId);
var f;!a.isReactFactory&&(f=document.getElementById(a.parentId))&&(this.videoElement=document.createElement("video"),this.videoElement.id=this.parentContainerId,this.videoElement.className=a.isVideoImmersivePlayer?"video-js brila-vip-vjs":"video-js brila-video-js",this.videoElement.setAttribute("playsinline","true"),this.videoElement.setAttribute("disablepictureinpicture","true"),a.shouldDisableControls||a.isChromelessPlayer||this.videoElement.setAttribute("controls","true"),!0===a.shouldAutoplay&&
this.videoElement.setAttribute("autoplay","true"),!0!==a.shouldStartMuted&&!0!==a.isChromelessPlayer||this.videoElement.setAttribute("muted","true"),a.shouldPreload||this.videoElement.setAttribute("preload","none"),!0===a.enableDynamicBlur&&(this.dynamicBlurWrapper=document.createElement("canvas"),this.dynamicBlurWrapper.classList.add("awa-blur-wrapper"),f.appendChild(this.dynamicBlurWrapper),f.classList.add("awa-blur-background")),f.appendChild(this.videoElement));b=this.getDefaultLanguageForPlayer();
g={player:{playsinline:!0,autoplay:a.shouldAutoplay,loop:a.shouldLoop,muted:a.shouldStartMuted||a.isChromelessPlayer,preload:a.shouldPreload?"auto":"none",techOrder:["html5"],textTrackSettings:!1,html5:{hls:{overrideNative:c.overrideNativePlayer()},nativeAudioTracks:!1,nativeVideoTracks:!1,nativeTextTracks:!1},controlBar:{pictureInPictureToggle:!1},language:b},hotkeys:{skipInitialFocus:a.skipInitialFocus,enableInactiveFocus:a.enableInactiveFocus}};a.languageLocalization&&(g.player.languages=(n={},
n[b]={Play:a.languageLocalization.play,"Play Video":a.languageLocalization.playVideo,Pause:a.languageLocalization.pause,Mute:a.languageLocalization.mute,Unmute:a.languageLocalization.unmute,VolumeSlider:a.languageLocalization.volumeSlider,"Volume Level":a.languageLocalization.volumeLevel,Fullscreen:a.languageLocalization.fullscreen,"Exit Fullscreen":a.languageLocalization.nonfullscreen,Captions:a.languageLocalization.captions,Subtitles:a.languageLocalization.subtitles,"Progress Bar":a.languageLocalization.scrubberBar},
n));!0===a.allowCrossOrigin&&(g.player.crossorigin="anonymous");a.closedCaptionsConfig&&(g.languages=(t={},t[b]=na({"captions off":a.closedCaptionsConfig.captionsOffText,"subtitles off":a.closedCaptionsConfig.captionsOffText},a.closedCaptionsConfig.languageToLabelTexts),t));!0===a.isChromelessPlayer&&(g.player.children=["MediaLoader"],g.player.controls=!1);!0===a.isVideoImmersivePlayer?(g.player.bigPlayButton=!1,g.player.posterImage=a.posterSource,g.player.controlBar={playToggle:!1,volumePanel:!1,
currentTimeDisplay:!0,remainingTimeDisplay:!0,fullscreenToggle:!1}):!0===a.shouldDisableControls&&(g.player.controlBar={volumePanel:!1});this.videoJS=n=c.embed(this.parentContainerId,a,g);if(t=document.getElementById(this.parentContainerId)){t.setAttribute("style","width:100%; height:100%;");!1!==a.showPosterImage&&this.videoJS.poster(a.posterSource);this.currentAsset&&(this.currentAsset.altText||this.currentAsset.videoTitle)&&(b=this.currentAsset.altText||this.currentAsset.videoTitle||"",b=this.getLocalizedString("Play Video")+
", "+this.encodeForHtml(b),this.altTextElement.setAttribute("aria-label",b));t.insertBefore(this.altTextElement,t.firstChild);this.setAriaLabels(this.videoJS,t);if(b=t.querySelector(".vjs-big-play-button"))b.tabIndex=-1;a.shouldPreload&&this.videoJS.src({src:a.videoUrl,type:a.mimeType});this.vseMetrics=c.metrics(this.videoJS);this.vseMetrics.updateMuteMetrics(this.eventEmitter);if(c=t.querySelector(".vjs-progress-holder.vjs-slider.vjs-slider-horizontal"))c.onclick=function(a){d.emitScrubberClick()};
this.overrideActivityCheck();!0===a.isVideoImmersivePlayer?(this.videoJS.on("click",function(){d.eventEmitter.emit("playerClick")}),this.videoJS.on("touchstart",function(){d.eventEmitter.emit("playerClick")})):(this.videoJS.aspectRatio("16:9"),(c=t.querySelector(".vjs-remaining-time"))&&c.setAttribute("tabindex","0"))}this.videoJS.on("ended",function(){d.eventHandlers.onPlaybackComplete()});this.videoJS.on("playing",function(){d.eventHandlers.onPlaybackStart();d.config.useAutoplayFallback&&(d.eventEmitter.emit("autoplaySucceeded"),
d.config.useAutoplayFallback=!1)});this.videoJS.on("cancelContinuousPlay",function(){d.eventHandlers.onCancelContinuousPlay()});this.videoJS.on("playUpNext",function(){d.eventHandlers.onPlayUpNext()});var h=this;n.ready(function(){h.eventEmitter.emit("playerLoaded");f&&f.children[0]&&(f.children[0].removeAttribute("role"),f.children[0].removeAttribute("aria-label"))});if(a.feedbackFactory||!0===a.includeEarnsComissionDisclosure)this.basicComponents=new ma(a,this),this.basicComponents.initialize(this.currentAsset);
var n,t}d.prototype.play=function(c){var a=this,b=Date.now();this.vseMetrics.setPlayCommandInvokeTimestamp(b);if(this.isDPXDesktopFullScreenRequest(c))return this.vseMetrics.setPageLoadStartTimestamp(b),this.videoJS.play();this.setInitialData(c);this.dynamicBlurWrapper&&(c=document.getElementById(this.videoElement.id),this.registerEventsForLazyBlur(c,this.dynamicBlurWrapper));!0===this.config.useAutoplayFallback&&(c=this.videoJS.play())&&c.then(function(a){}).catch(function(b){a.eventEmitter.emit("autoplayFailed")});
return this.videoJS.play()};d.prototype.setInitialData=function(c){var a=this.getTextTrackMode("en");if(c&&c.rankingStrategy&&1===Object.keys(c).length)this.vseMetrics.setRankingStrategy(c.rankingStrategy);else if(c&&!(1===Object.keys(c).length&&"rankingStrategy"in c)&&(this.currentAsset&&c.contentId===this.currentAsset.contentId?this.config.shouldPreload||this.videoJS.src({src:c.videoUrl,type:c.mimeType}):(this.videoJS.poster(c.imageUrl),this.videoJS.posterImage.show(),this.vseMetrics.setContentId&&
this.vseMetrics.setContentId(c.contentId),this.vseMetrics.setAciContentId(c.aciContentId),this.vseMetrics.setRefTag&&this.vseMetrics.setRefTag(c.refTag?c.refTag:""),this.vseMetrics.setOspAttribution&&this.vseMetrics.setOspAttribution({vendorTrackingId:c.vendorTrackingId?c.vendorTrackingId:"",videoReferenceId:c.videoReferenceId?c.videoReferenceId:"",productAsin:c.productAsin?c.productAsin:""}),this.videoJS.src({src:c.videoUrl,type:c.mimeType}),this.currentAsset=c),this.setSeekTimeForInitialData(c),
this.vseMetrics.setRankingStrategy(c.rankingStrategy),this.vseMetrics.setCreatorType&&this.vseMetrics.setCreatorType(c.creatorType),this.basicComponents!==u&&this.basicComponents.update(c),c&&(c.altText||c.title))){var b=c.altText||c.title||"",b=this.getLocalizedString("Play Video")+", "+this.encodeForHtml(b);this.altTextElement?this.altTextElement.setAttribute("aria-label",b):this.videoElement.setAttribute("aria-label",b)}this.removeCurrentTextTracks();b=[];this.currentAsset&&this.currentAsset.closedCaptions&&
(b=this.currentAsset.closedCaptions);c&&c.closedCaptions&&(b=c.closedCaptions);this.updateTextTrack(b);this.vseMetrics.updateTextTrackMetrics(this.eventEmitter);"showing"===a&&this.enableCurrentTextTrack();c=c&&c.eventTimestamp?c.eventTimestamp:Date.now();this.vseMetrics.setPageLoadStartTimestamp(c)};d.prototype.setSeekTimeForInitialData=function(c){c&&c.seekTime&&this.videoJS.currentTime(c.seekTime)};d.prototype.showPoster=function(c){this.videoJS.poster(c);this.videoJS.posterImage.show();return this};
d.prototype.updateTextTrack=function(c){for(var a=this,b=this.videoJS.textTracks(),g=0;g<c.length;g++){var d=c[g],f=!1;if(b)for(var h=0,n=b;h<n.length;h++){var t=n[h];"subtitles"===t.kind&&t.language===d.locale&&(f=!0)}f||this.videoJS.addRemoteTextTrack({src:d.url,kind:"subtitles",srclang:d.locale,label:this.config.closedCaptionsConfig.captionsOnTexts[d.locale.substring(0,2)],"default":!1},!1)}if(this.localStorageEnabled){c=this.videoJS.remoteTextTracks();var e=localStorage.getItem(this.VSE_CC_KEY);
e||localStorage.setItem(this.VSE_CC_KEY,"disabled");if(b)for(var t=function(b){"disabled"!==e&&"subtitles"===b.kind&&(b.mode="showing",x.eventEmitter.emit("texttrackenable",b));b.on("modechange",function(){localStorage.setItem(a.VSE_CC_KEY,"showing"===b.mode?"showing":"disabled")})},x=this,g=0;g<b.length;g++)t(b[g]);if(c)for(var b=function(b){"disabled"!==e&&"subtitles"===b.kind&&(b.mode="showing",q.eventEmitter.emit("texttrackenable",b));b.on("modechange",function(){localStorage.setItem(a.VSE_CC_KEY,
"showing"===b.mode?"showing":"disabled")})},q=this,g=0;g<c.length;g++)t=c[g],b(t)}return this};d.prototype.overrideActivityCheck=function(){var c=this;if(this.videoJS){var a=this.videoJS.userActive,b=0;this.videoJS.userActive=function(g){if(c.videoJS){var d=document.activeElement;return g!==u&&c.closestParent(d,"#"+c.parentContainerId)?(0===b&&(b=setTimeout(function(){b=0;c.videoJS&&(d=document.activeElement,c.closestParent(d,"#"+c.parentContainerId)?c.videoJS.userActive(a.call(c.videoJS)):c.videoJS.userActive(!1))},
2E3)),a.call(c.videoJS,!0)):a.call(c.videoJS,g)}b&&(clearTimeout(b),b=0)}}};d.prototype.closestParent=function(c,a){return c?c.closest(a):null};d.prototype.enableCurrentTextTrack=function(c){void 0===c&&(c="en");this.changeTextTrackMode(c,"showing");return this};d.prototype.disableCurrentTextTrack=function(c){void 0===c&&(c="en");this.changeTextTrackMode(c,"disabled");return this};d.prototype.muted=function(c){return this.videoJS.muted(c)};d.prototype.mute=function(c){this.videoJS.muted(!0,c);return this};
d.prototype.unmute=function(c){this.videoJS.muted(!1,c);return this};d.prototype.isMuted=function(){return this.videoJS.muted()};d.prototype.getCurrentTime=function(){return this.videoJS.currentTime()};d.prototype.setCurrentTime=function(c){this.videoJS.currentTime(c);return this};d.prototype.getMediaDuration=function(){return isNaN(this.videoJS.duration())?0:this.videoJS.duration()};d.prototype.pause=function(c){this.videoJS.pause(c);return this};d.prototype.resume=function(c){this.videoJS.play();
return this};d.prototype.seek=function(c){this.videoJS.currentTime(c);return this};d.prototype.stop=function(){this.videoJS.pause();this.currentAsset=u;return this};d.prototype.on=function(c,a){this.eventEmitter.on(c,a);this.videoJS.on(c,a);return this};d.prototype.off=function(c,a){return this};d.prototype.ready=function(c){this.videoJS.ready(c);return this};d.prototype.readyState=function(){return this.videoJS.readyState()};d.prototype.load=function(){this.videoJS.load();return this};d.prototype.getCurrent=
function(){return this.currentAsset};d.prototype.getPosition=function(){return this.videoJS.currentTime()};d.prototype.isPlaying=function(){return!this.videoJS.paused()};d.prototype.isPaused=function(){return this.videoJS.paused()};d.prototype.getVersion=function(){return"VJS"};d.prototype.destroy=function(){this.vseMetrics.publishBeforeDispose();this.videoJS.off("ended",this.eventHandlers.onPlaybackComplete);this.videoJS.dispose();this.videoJS=null;this.basicComponents!==u&&this.basicComponents.destroy()};
d.prototype.addChild=function(c,a){this.videoJS.addChild(c,a);return this};d.prototype.removeChild=function(c){this.videoJS.removeChild(c);return this};d.prototype.loadNextVideoPoster=function(c){this.videoJS.poster(c);this.videoJS.posterImage.show();return this};d.prototype.aspectRatio=function(c){this.videoJS.aspectRatio(c);return this};d.prototype.requestFullscreen=function(){this.videoJS.requestFullscreen();return this};d.prototype.exitFullscreen=function(){this.videoJS.exitFullscreen();return this};
d.prototype.isFullscreen=function(){return this.videoJS.isFullscreen()};d.prototype.fluid=function(c){this.videoJS.fluid(c);return this};d.prototype.blur=function(){this.videoJS.blur();return this};d.prototype.isCaptionOn=function(){var c=this.videoJS.remoteTextTracks();if(c)for(var a=0;a<c.length;a++)if("showing"===c[a].mode)return!0;if(c=this.videoJS.textTracks())for(a=0;a<c.length;a++)if("showing"===c[a].mode)return!0;return!1};d.prototype.isAutoplayed=function(){return this.videoJS.options()&&
this.videoJS.options().autoplay?this.videoJS.options().autoplay:!1};d.prototype.getTitleSessionId=function(){return this.vseMetrics.getTitleSessionId()};d.prototype.requestPictureInPicture=function(){this.videoJS.requestPictureInPicture();return this};d.prototype.exitPictureInPicture=function(){this.videoJS.exitPictureInPicture();return this};d.prototype.emitStartCountMetric=function(){this.vseMetrics.emitStartCountMetric();return this};d.prototype.emitScrubberClick=function(){this.vseMetrics.emitScrubberClick();
return this};d.prototype.emitSkipForwardClick=function(){this.vseMetrics.emitSkipForwardClick();return this};d.prototype.emitSkipBackwardClick=function(){this.vseMetrics.emitSkipBackwardClick();return this};d.prototype.setPlayerMode=function(c){this.vseMetrics.updatePlacementContext(c);return this};d.prototype.initHandlers=function(){var c=this;this.eventHandlers={onPlaybackComplete:function(){return c.player_onPlaybackComplete()},onPlaybackStart:function(){return c.player_onPlaybackStart()},onCancelContinuousPlay:function(){return c.player_onCancelContinuousPlay()},
onPlayUpNext:function(){return c.player_onPlayUpNext()}}};d.prototype.player_onPlaybackComplete=function(){var c=this.currentAsset;if(this.previousAsset=this.currentAsset)this.previousAsset.eventTimestamp=Date.now();this.eventEmitter.emit("playbackComplete",c)};d.prototype.player_onCancelContinuousPlay=function(){this.currentAsset=this.previousAsset;this.eventEmitter.emit("cancelContinuousPlay",this.previousAsset)};d.prototype.player_onPlayUpNext=function(){this.eventEmitter.emit("playUpNext",this.previousAsset)};
d.prototype.player_onPlaybackStart=function(){this.currentAsset&&(this.currentAsset.eventTimestamp=Date.now());this.eventEmitter.emit("playbackStart",this.currentAsset)};d.prototype.isDPXDesktopFullScreenRequest=function(c){return this.config.sushiMetricsConfig&&this.config.sushiMetricsConfig.placementContext&&-1!==this.config.sushiMetricsConfig.placementContext.indexOf("desktop_web.ImageBlock")&&c&&!c.hasOwnProperty("refTag")&&this.currentAsset&&c.contentId!==this.currentAsset.contentId};d.prototype.changeTextTrackMode=
function(c,a){var b=this.videoJS.remoteTextTracks();if(b)for(var g=0;g<b.length;g++){var d=b[g];"subtitles"===d.kind&&d.language===c&&(d.mode=a)}if(b=this.videoJS.textTracks())for(g=0;g<b.length;g++)d=b[g],"subtitles"===d.kind&&d.language===c&&(d.mode=a)};d.prototype.getTextTrackMode=function(c){var a=this.videoJS.remoteTextTracks();if(a)for(var b=0;b<a.length;b++){var g=a[b];if("subtitles"===g.kind&&g.language===c)return g.mode}if(a=this.videoJS.textTracks())for(b=0;b<a.length;b++)if(g=a[b],"subtitles"===
g.kind&&g.language===c)return g.mode;return"disabled"};d.prototype.removeCurrentTextTracks=function(){var c=this.videoJS.remoteTextTracks();if(c)for(var a=0;a<c.length;a++)this.videoJS.removeRemoteTextTrack(c[a])};d.prototype.getDefaultLanguageForPlayer=function(){return this.config.languageCode?this.config.languageCode.toString():"en"};d.prototype.setAriaLabels=function(c,a){var b=c.controlBar;if(b)for(c=0,b=b.children();c<b.length;c++){var g=b[c].el();if(g.classList.contains("vjs-progress-control")){var d=
g.querySelector(".vjs-slider");d.title=d.ariaLabel}else"button"===g.tagName.toLowerCase()?g.title&&g.setAttribute("aria-label",g.title):(d=g.querySelector("button"),g=g.querySelector(".vjs-control-text"),d&&g&&d.setAttribute("aria-label",g.innerText))}(a=a.querySelector(".vjs-volume-bar.vjs-slider-bar"))&&a.setAttribute("title",this.getLocalizedString("Volume Level"))};d.prototype.testLocalStorage=function(){try{return l.localStorage.setItem("foo","bar"),l.localStorage.removeItem("foo"),!0}catch(c){return!1}};
d.prototype.getLocalizedString=function(c){return this.videoJS.localize(c)};d.prototype.createAltTextElement=function(c){var a=this,b=document.createElement("div");b.id="altText-"+c;b.className="ive-alttext-container";b.setAttribute("tabindex","0");b.setAttribute("role","description");b.onclick=function(){a.videoJS.paused()?a.videoJS.play():a.videoJS.pause()};b.onkeydown=function(b){if("Enter"===b.key||" "===b.key)b.preventDefault(),a.videoJS.paused()?a.videoJS.play():a.videoJS.pause()};return b};
return d}(),V=function(){function d(c,a){var b=this;this.libs=a;this.commands=[];c.then(function(a){b.playerInstance=a;b.executeCommands()})}d.prototype.executeCommands=function(){for(var c=0;c<this.commands.length;c++)if(this.playerInstance)this.commands[c](this.playerInstance)};d.prototype.play=function(c){var a=this;this.playerInstance?this._play(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._play(c,b[0])});return this};
d.prototype.mute=function(c){var a=this;this.playerInstance?this._mute(this.playerInstance,c):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._mute(b[0],c)});return this};d.prototype.unmute=function(){var c=this;this.playerInstance?this._unmute(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._unmute(a[0])});return this};d.prototype.isMuted=function(){var c=this;if(this.playerInstance)return this._isMuted(this.playerInstance);
this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._isMuted(a[0])});return!0};d.prototype.emitStartCountMetric=function(){this.playerInstance&&this._emitStartCountMetric(this.playerInstance);return this};d.prototype.emitSkipForwardClick=function(){this.playerInstance&&this._emitSkipForwardClick(this.playerInstance);return this};d.prototype.emitSkipBackwardClick=function(){this.playerInstance&&this._emitSkipBackwardClick(this.playerInstance);return this};
d.prototype.emitScrubberClick=function(){this.playerInstance&&this._emitScrubberClick(this.playerInstance);return this};d.prototype.getCurrentTime=function(){var c=this;if(this.playerInstance)return this._getCurrentTime(this.playerInstance);this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._getCurrentTime(a[0])});return 0};d.prototype.setCurrentTime=function(c){var a=this;this.playerInstance?this._setCurrentTime(c,this.playerInstance):this.commands.push(function(){for(var b=
[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._setCurrentTime(c,b[0])})};d.prototype.getMediaDuration=function(){var c=this;if(this.playerInstance)return this._getMediaDuration(this.playerInstance);this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._getMediaDuration(a[0])});return 0};d.prototype.pause=function(c){var a=this;this.playerInstance?this._pause(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=
arguments[g];return a._pause(c,b[0])});return this};d.prototype.resume=function(c){var a=this;this.playerInstance?this._resume(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._resume(c,b[0])});return this};d.prototype.stop=function(){var c=this;this.playerInstance?this._stop(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._stop(a[0])});return this};d.prototype.seek=
function(c){var a=this;this.playerInstance?this._seek(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._seek(c,b[0])});return this};d.prototype.on=function(c,a){var b=this;this.playerInstance?this._on(c,a,this.playerInstance):this.commands.push(function(){for(var g=[],d=0;d<arguments.length;d++)g[d]=arguments[d];return b._on(c,a,g[0])});return this};d.prototype.off=function(c,a){var b=this;this.playerInstance?this._off(c,a,this.playerInstance):
this.commands.push(function(){for(var g=[],d=0;d<arguments.length;d++)g[d]=arguments[d];return b._off(c,a,g[0])});return this};d.prototype.ready=function(c){var a=this;this.playerInstance?this._ready(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._ready(c,b[0])});return this};d.prototype.load=function(){var c=this;this.playerInstance?this._load(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=
arguments[b];return c._load(a[0])});return this};d.prototype.readyState=function(){return this.playerInstance?this.playerInstance.readyState():0};d.prototype.aspectRatio=function(c){var a=this;this.playerInstance?this._aspectRatio(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._aspectRatio(c,b[0])});return this};d.prototype.getCurrent=function(){if(this.playerInstance)return this.playerInstance.getCurrent()};d.prototype.getPosition=
function(){return this.playerInstance?this.playerInstance.getPosition():0};d.prototype.isPlaying=function(){return this.playerInstance?this.playerInstance.isPlaying():!1};d.prototype.isPaused=function(){return this.playerInstance?this.playerInstance.isPaused():!1};d.prototype.getVersion=function(){return this.playerInstance?this.playerInstance.getVersion():""};d.prototype.destroy=function(){var c=this;this.playerInstance?this._destroy(this.playerInstance):this.commands.push(function(){for(var a=[],
b=0;b<arguments.length;b++)a[b]=arguments[b];return c._destroy(a[0])})};d.prototype.addChild=function(c,a){this.playerInstance&&this.playerInstance.addChild(c,a);return this};d.prototype.removeChild=function(c){this.playerInstance&&this.playerInstance.removeChild(c);return this};d.prototype.loadNextVideoPoster=function(c){this.playerInstance&&this.playerInstance.loadNextVideoPoster(c);return this};d.prototype.setInitialData=function(c){this.playerInstance&&this.playerInstance.setInitialData(c);return this};
d.prototype.updateTextTrack=function(c){this.playerInstance&&this.playerInstance.updateTextTrack(c);return this};d.prototype.removeCurrentTextTracks=function(){this.playerInstance&&this.playerInstance.removeCurrentTextTracks();return this};d.prototype.showPoster=function(c){this.playerInstance&&this.playerInstance.showPoster(c);return this};d.prototype.blur=function(){this.playerInstance&&this.playerInstance.blur();return this};d.prototype.requestFullscreen=function(){var c=this;this.playerInstance?
this._requestFullscreen(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c._requestFullscreen(a[0])});return this};d.prototype.exitFullscreen=function(){this.playerInstance&&this.playerInstance.exitFullscreen();return this};d.prototype.isFullscreen=function(){return this.playerInstance?this.playerInstance.isFullscreen():!1};d.prototype.fluid=function(c){this.playerInstance&&this.playerInstance.fluid(c);return this};d.prototype.enableCurrentTextTrack=
function(c){void 0===c&&(c="en");this.playerInstance&&this.playerInstance.enableCurrentTextTrack(c)};d.prototype.disableCurrentTextTrack=function(c){void 0===c&&(c="en");this.playerInstance&&this.playerInstance.disableCurrentTextTrack(c)};d.prototype.isCaptionOn=function(){return this.playerInstance?this.playerInstance.isCaptionOn():!1};d.prototype.isAutoplayed=function(){return this.playerInstance?this.playerInstance.isAutoplayed():!1};d.prototype.getTitleSessionId=function(){return this.playerInstance?
this.playerInstance.getTitleSessionId():""};d.prototype.requestPictureInPicture=function(){var c=this;this.playerInstance?this._requestPictureInPicture(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];c._requestPictureInPicture(a[0])});return this};d.prototype.exitPictureInPicture=function(){var c=this;this.playerInstance?this._exitPictureInPicture(this.playerInstance):this.commands.push(function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=
arguments[b];c._exitPictureInPicture(a[0])});return this};d.prototype.setPlayerMode=function(c){var a=this;this.playerInstance?this._setPlayerMode(c,this.playerInstance):this.commands.push(function(){for(var b=[],g=0;g<arguments.length;g++)b[g]=arguments[g];return a._setPlayerMode(c,b[0])});return this};d.prototype._setPlayerMode=function(c,a){a.setPlayerMode(c)};d.prototype._play=function(c,a){c?a.play(c):a.play()};d.prototype._mute=function(c,a){c.mute(a)};d.prototype._unmute=function(c){c.unmute()};
d.prototype._emitStartCountMetric=function(c){c.emitStartCountMetric()};d.prototype._emitScrubberClick=function(c){c.emitScrubberClick()};d.prototype._emitSkipForwardClick=function(c){c.emitSkipForwardClick()};d.prototype._emitSkipBackwardClick=function(c){c.emitSkipBackwardClick()};d.prototype._isMuted=function(c){return c.isMuted()};d.prototype._getCurrentTime=function(c){return c.getCurrentTime()};d.prototype._setCurrentTime=function(c,a){a.setCurrentTime(c)};d.prototype._getMediaDuration=function(c){return c.getMediaDuration()};
d.prototype._pause=function(c,a){a.pause(c)};d.prototype._stop=function(c){c.stop()};d.prototype._requestFullscreen=function(c){c.requestFullscreen()};d.prototype._resume=function(c,a){a.resume(c)};d.prototype._seek=function(c,a){a.seek(c)};d.prototype._on=function(c,a,b){b.on(c,a)};d.prototype._off=function(c,a,b){b.off(c,a)};d.prototype._ready=function(c,a){a.ready(c)};d.prototype._load=function(c){c.load()};d.prototype._destroy=function(c){c.destroy();this.playerInstance=null};d.prototype._aspectRatio=
function(c,a){a.aspectRatio(c)};d.prototype._requestPictureInPicture=function(c){c.requestPictureInPicture()};d.prototype._exitPictureInPicture=function(c){c.exitPictureInPicture()};return d}(),oa=function(){function d(){}d.prototype.create=function(c,a,b){b=b?b:c.initialVideo;a={contentId:""+b.contentId,customerId:c.customerId,isForesterTrackingDisabled:c.sushiMetricsConfig.isRobot,foresterMetadataParams:{client:c.requestMetadata.clientId,marketplaceId:c.requestMetadata.marketplaceId,method:c.requestMetadata.method,
requestId:c.requestMetadata.requestId,session:c.requestMetadata.sessionId},videoUrl:b.videoUrl,posterSource:b.imageUrl,pageAsin:c.requestMetadata.pageAsin,parentId:a,vendorCode:b.vendorCode,videoTitle:b.videoTitle,shouldStartMuted:c.shouldStartMuted||!1,shouldAutoplay:c.shouldAutoplay||!1,shouldPreload:"undefined"===typeof c.shouldPreload?!0:c.shouldPreload,shouldOverrideBackground:c.shouldOverrideBackground||!1,useAutoplayFallback:c.useAutoplayFallback,shouldDisableControls:c.shouldDisableControls||
!1,useCarousel:c.useCarousel,useBuyBox:c.useBuyBox,languagePreferenceStrings:c.languagePreferenceStrings,metricsEmissionMethod:c.metricsEmissionMethod,enableClickBasedAttribution:c.enableClickBasedAttribution,sushiMetricsConfig:{eventSource:c.sushiMetricsConfig.eventSource,endpoint:c.sushiMetricsConfig.endpoint,requestId:c.sushiMetricsConfig.requestId,sessionId:c.sushiMetricsConfig.sessionId,customerId:c.sushiMetricsConfig.customerId,refMarkers:c.sushiMetricsConfig.refMarkers,sessionType:c.sushiMetricsConfig.sessionType,
placementContext:c.sushiMetricsConfig.placementContext,marketplaceId:c.sushiMetricsConfig.marketplaceId,weblabIds:c.sushiMetricsConfig.weblabIds,pageAsin:c.sushiMetricsConfig.pageAsin,isInternal:c.sushiMetricsConfig.isInternal,isRobot:c.sushiMetricsConfig.isRobot,clientId:c.sushiMetricsConfig.clientId,creativeId:c.sushiMetricsConfig.creativeId||""},refTag:c.refTag,ospData:{vendorTrackingId:b.vendorTrackingId,videoReferenceId:b.videoReferenceId,productAsin:b.productAsin},useUpNextComponent:c.useUpNextComponent,
isVideoImmersivePlayer:c.isVideoImmersivePlayer,ospLinkCode:c.ospLinkCode,clientPrefix:c.clientPrefix,languageCode:c.languageCode,isChromelessPlayer:c.isChromelessPlayer,enableDelphiAttribution:c.enableDelphiAttribution,aciContentId:b.aciContentId,mimeType:b.mimeType,isReactFactory:c.isReactFactory,version:c.version,shouldLoop:c.shouldLoop||!1,skipInitialFocus:c.skipInitialFocus||!1,enableInactiveFocus:!1!==c.enableInactiveFocus,closedCaptionsConfig:c.closedCaptionsConfig,languageLocalization:c.languageLocalization,
alwaysSetInitialVideo:c.alwaysSetInitialVideo,showPosterImage:c.showPosterImage,allowCrossOrigin:c.allowCrossOrigin,enableDynamicBlur:c.enableDynamicBlur};c.eventTimestamp&&(a.eventTimestamp=c.eventTimestamp);c.nexusMetricsConfig&&(a.nexusMetricsConfig={eventSource:c.nexusMetricsConfig.eventSource,isInternal:c.nexusMetricsConfig.isInternal,playerTSMMetricsSchemaId:c.nexusMetricsConfig.playerTSMMetricsSchemaId,widgetMetricsSchemaId:c.nexusMetricsConfig.widgetMetricsSchemaId,producerId:c.nexusMetricsConfig.producerId,
refMarkers:c.nexusMetricsConfig.refMarkers,placementContext:c.nexusMetricsConfig.placementContext,weblabIds:c.nexusMetricsConfig.weblabIds,pageAsin:c.nexusMetricsConfig.pageAsin,clientId:c.nexusMetricsConfig.clientId,creativeId:c.nexusMetricsConfig.creativeId,videoAsin:c.nexusMetricsConfig.videoAsin,videoAsinList:c.nexusMetricsConfig.videoAsinList});c.clickstreamNexusMetricsConfig&&(a.clickstreamNexusMetricsConfig={actionType:c.clickstreamNexusMetricsConfig.actionType,eventOwner:c.clickstreamNexusMetricsConfig.eventOwner,
eventType:c.clickstreamNexusMetricsConfig.eventType,productId:c.clickstreamNexusMetricsConfig.productId,producerId:c.clickstreamNexusMetricsConfig.producerId,schemaId:c.clickstreamNexusMetricsConfig.schemaId});c.feedbackFactory&&(a.feedbackFactory=c.feedbackFactory,a.reportPageStateName=c.reportPageStateName);c.includeEarnsComissionDisclosure&&(a.includeEarnsComissionDisclosure=c.includeEarnsComissionDisclosure);return a};return d}(),W=function(){function d(c){this.deps=c}d.prototype.create=function(c){var a=
this,b=I(),g=new this.deps.promise(function(a,c){l[b]={resolve:a,reject:c}});v.when("brila").execute("construct-player",function(a){l[b].resolve(a)});var d=document.getElementById(c.containerId),f=c.containerId+"-container";d.innerHTML='\x3cdiv id\x3d"'+f+'" style\x3d"width:100%; height:100%"\x3e\x3c/div\x3e';d=(new this.deps.promise(function(b,d){g.then(function(g){var e=new U(g,(new oa).create(c,f),c.initialVideo,a.deps);e.on("playerLoaded",function(){b(e)})})})).then(function(a){return a});return new T(new V(d,
this.deps),document.getElementById(f),this.deps)};return d}(),K=function(d,c){return c={exports:{}},d(c,c.exports),c.exports}(function(d){function c(){}function a(a,b,c){this.fn=a;this.context=b;this.once=c||!1}function b(){this._events=new c;this._eventsCount=0}var g=Object.prototype.hasOwnProperty,f="~";Object.create&&(c.prototype=Object.create(null),(new c).__proto__||(f=!1));b.prototype.eventNames=function(){var a=[],b,c;if(0===this._eventsCount)return a;for(c in b=this._events)g.call(b,c)&&a.push(f?
c.slice(1):c);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(b)):a};b.prototype.listeners=function(a,b){a=this._events[f?f+a:a];if(b)return!!a;if(!a)return[];if(a.fn)return[a.fn];b=0;for(var c=a.length,g=Array(c);b<c;b++)g[b]=a[b].fn;return g};b.prototype.emit=function(a,b,c,g,e,d){var q=f?f+a:a;if(!this._events[q])return!1;var q=this._events[q],E=arguments.length,l,m;if(q.fn){q.once&&this.removeListener(a,q.fn,u,!0);switch(E){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,
b),!0;case 3:return q.fn.call(q.context,b,c),!0;case 4:return q.fn.call(q.context,b,c,g),!0;case 5:return q.fn.call(q.context,b,c,g,e),!0;case 6:return q.fn.call(q.context,b,c,g,e,d),!0}m=1;for(l=Array(E-1);m<E;m++)l[m-1]=arguments[m];q.fn.apply(q.context,l)}else{var p=q.length,r;for(m=0;m<p;m++)switch(q[m].once&&this.removeListener(a,q[m].fn,u,!0),E){case 1:q[m].fn.call(q[m].context);break;case 2:q[m].fn.call(q[m].context,b);break;case 3:q[m].fn.call(q[m].context,b,c);break;case 4:q[m].fn.call(q[m].context,
b,c,g);break;default:if(!l)for(r=1,l=Array(E-1);r<E;r++)l[r-1]=arguments[r];q[m].fn.apply(q[m].context,l)}}return!0};b.prototype.on=function(b,c,g){c=new a(c,g||this);b=f?f+b:b;this._events[b]?this._events[b].fn?this._events[b]=[this._events[b],c]:this._events[b].push(c):(this._events[b]=c,this._eventsCount++);return this};b.prototype.once=function(b,c,g){c=new a(c,g||this,!0);b=f?f+b:b;this._events[b]?this._events[b].fn?this._events[b]=[this._events[b],c]:this._events[b].push(c):(this._events[b]=
c,this._eventsCount++);return this};b.prototype.removeListener=function(a,b,g,d){a=f?f+a:a;if(!this._events[a])return this;if(!b)return 0===--this._eventsCount?this._events=new c:delete this._events[a],this;var e=this._events[a];if(e.fn)e.fn!==b||d&&!e.once||g&&e.context!==g||(0===--this._eventsCount?this._events=new c:delete this._events[a]);else{for(var x=0,q=[],m=e.length;x<m;x++)(e[x].fn!==b||d&&!e[x].once||g&&e[x].context!==g)&&q.push(e[x]);q.length?this._events[a]=1===q.length?q[0]:q:0===--this._eventsCount?
this._events=new c:delete this._events[a]}return this};b.prototype.removeAllListeners=function(a){a?(a=f?f+a:a,this._events[a]&&(0===--this._eventsCount?this._events=new c:delete this._events[a])):(this._events=new c,this._eventsCount=0);return this};b.prototype.off=b.prototype.removeListener;b.prototype.addListener=b.prototype.on;b.prototype.setMaxListeners=function(){return this};b.prefixed=f;b.EventEmitter=b;"undefined"!==typeof d&&(d.exports=b)}).EventEmitter,X=u,Y=u;v.when("a-sheet").execute(function(d){X=
d});v.when("a-popover").execute(function(d){Y=d});var Z={getBottomSheet:function(){return X},getPopoverFactory:function(){return Y}},qa=function(){function d(c,a){var b=this;this.config=c;this._showMoreMenuExperience=a;this.activeVideoSource=this.activeVideo="VIDEO_NOT_SELECTED";this.reportURL="";this.activeVideoACI="VIDEO_NOT_SELECTED";this.ivxReportCloseIconClass="ivx-report-close";this.ivxAmazonAppClass="ivx-amazon-app";this.reportCloseIconSelector=".a-sheet-close";this.showMoreMenuExperience=
this.registered=!1;this.getTokensSuccessCallback=function(a){a.slate&&(b.slateToken=a.slate);a.csrf&&(b.csrfToken=a.csrf);b.callFeedbackLambdaOrCastVoteReportAapi()};this.getTokensErrorCallback=function(a,c){(0===a.http.status||500<=a.http.status&&600>a.http.status)&&0<c?b.getTokensAndSubmit(c-1):b.callFeedbackLambdaOrCastVoteReportAapi()};this.getTokensAndSubmit=function(a){void 0===a&&(a=3);var c=b.shouldCallCastVoteReportAapi()?["csrf"]:["slate"];z.sendRequest(b.A,d.GET_AUTH_TOKEN_ENDPOINT,c,b.getTokensSuccessCallback,
function(c){return b.getTokensErrorCallback(c,a)})};this._submitErrorCallback=function(a){b.A.trigger("vse:"+b.id+":feedback:submitted:error")};this._submitSuccessCallback=function(a){b.A.trigger("vse:"+b.id+":feedback:submitted:success")};this.A=c.A;this.pageStateName=c.pageStateName;this.buttonApi=c.buttonApi;this.id=this.config.id;this.showMoreMenuExperience=this._showMoreMenuExperience;c=y.fetchLatestPageState(this.A,this.pageStateName);this.moreMenuSheet=this.A.$("#"+this.id+"-more-menu");this.feedbackForm=
this.A.$("#"+this.id+"-form");this.thankYouSection=this.A.$("#"+this.id+"-ty-container");this.InfringementNotSupportSection=this.A.$("#"+this.id+"-infringement-container");this.submitButton=this.buttonApi("#"+this.id+"-btn-submit");this.reportIllegalContentLinkSelector=this.A.$(".vse-fb-report-illegal-content");this.feedbackContainerSelector=this.A.$("#"+this.id);c&&this.validateFormElements()&&(this.isMobile=c.isMobile,this.endpoint=c.feedbackEndpoint,this.marketplaceId=c.marketplaceId,this.pageAsin=
c.pageAsin,this.customerId=c.customerId,this.slateToken=c.slateToken,this.bottomSheetFactory=Z.getBottomSheet(),this.popoverFactory=Z.getPopoverFactory(),this.aapiEndpoint=c.amazonApiEndpoint,this.language=c.language,this.registered||(this.A.declarative(this.id+"-btn-close","click",function(){return b.closeFeedbackForm()}),this.A.declarative(this.id+"-btn-submit","click",function(){return b.submitFeedback()}),this.showMoreMenuExperience&&this.A.declarative(this.id+"-report-btn","click",function(){return b.moreMenuToFeedbackForm()}),
this.A.on("a:sheet:afterShow:"+this.id+"-sheet",function(a){b.showFeedbackForm?(b.A.trigger("vse:"+b.id+":feedback:shown"),b.updateBottomSheetHeight(),b.A.capabilities.isAmazonApp&&b.isMobile&&a.sheet.$container.addClass(b.ivxAmazonAppClass),a.sheet.$contentContainer.siblings(b.reportCloseIconSelector).addClass(b.ivxReportCloseIconClass)):(b.showFeedbackForm(),b.updateBottomSheetHeight())}),this.A.on("a:sheet:afterHide:"+this.id+"-sheet",function(a){b.showMoreMenuExperience?(b.feedbackForm.addClass("aok-hidden").fadeIn(10),
b.hideThankYou(),b.hideInfringementNotSupport(),b.resetMoreMenuSheet(),b.showMoreMenuSheet()):(b.hideThankYou(),b.hideInfringementNotSupport());b.A.capabilities.isAmazonApp&&b.isMobile&&a.sheet.$container.removeClass(b.ivxAmazonAppClass);a.sheet.$contentContainer.siblings(b.reportCloseIconSelector).removeClass(b.ivxReportCloseIconClass);b.A.trigger("vse:"+b.id+":feedback:hidden")}),this.A.on("a:popover:afterShow:"+this.id+"-popover",function(a){b.showFeedbackForm()}),this.A.on("a:popover:afterHide:"+
this.id+"-popover",function(a){b.hideFeedbackForm()}),this.registered=!0))}d.prototype.resetMoreMenuSheet=function(){this.showMoreMenuExperience&&this.updateBottomSheetHeight(1)};d.prototype.moreMenuToFeedbackForm=function(){this.moreMenuSheet.addClass("aok-hidden").fadeOut(10);this.showFeedbackForm();this.updateBottomSheetHeight();return this};d.prototype.showMoreMenuSheet=function(){this.moreMenuSheet.removeClass("aok-hidden").fadeIn(400)};d.prototype.showFeedbackForm=function(c){this.hideThankYou();
this.showMoreMenuExperience&&this.feedbackForm.removeClass("aok-hidden").fadeIn(400);this.A.trigger("vse:"+this.id+":feedback:shown");return this};d.prototype.hideFeedbackForm=function(){this.isMobile?this.getAndSetBottomSheetInstance()&&(this.bottomSheetInstance.hide(),this.resetMoreMenuSheet()):this.getAndSetPopoverInstance()&&this.popoverInstance.hide();this.A.trigger("vse:"+this.id+":feedback:hidden");return this};d.prototype.setActiveVideoAndSource=function(c,a,b,g){this.activeVideo=c;this.activeVideoSource=
a;this.activeVideoACI="amzn1.vse.video."+c;g&&(this.reportURL=g)};d.prototype.submitFeedback=function(){this.getTokensAndSubmit();this.A.trigger("vse:"+this.id+":feedback:submitted");this.showThankYou();this.updateBottomSheetHeight(this.thankYouSection.scrollHeight+this.getFeedbackFormVerticalPadding())};d.prototype.shouldCallCastVoteReportAapi=function(){return!!this.reportURL&&0<this.reportURL.trim().length};d.prototype.callFeedbackLambdaOrCastVoteReportAapi=function(){var c=this.shouldCallCastVoteReportAapi()?
this.createCastVoteReportRequest():this.createLwisRequest();this.A.$.ajax(c)};d.prototype.getFeedbackFormVerticalPadding=function(){var c=parseInt(this.feedbackContainerSelector.css("padding-top"),10),a=parseInt(this.feedbackContainerSelector.css("padding-bottom"),10);return c+a};d.prototype.createLwisPayload=function(){return{videoId:this.activeVideo,customerId:this.customerId,marketplaceId:this.marketplaceId,slateToken:this.slateToken}};d.prototype.createCastVoteReportRequest=function(){var c=document.querySelector('meta[name\x3d"encrypted-slate-token"]'),
c=c instanceof HTMLMetaElement?c.content:"";return{url:this.aapiEndpoint+this.reportURL,data:JSON.stringify({}),type:"POST",crossDomain:!0,headers:{"Accept-Language":this.language,Accept:'application/vnd.com.amazon.api+json; type\x3d"sharedcontents.cast-vote/v1"',"x-api-csrf-token":this.csrfToken,"x-amzn-encrypted-slate-token":c,"Content-Type":'application/vnd.com.amazon.api+json; type\x3d"sharedcontents.cast-vote.request/v1"'},xhrFields:{withCredentials:!0},error:this._submitErrorCallback,success:this._submitSuccessCallback}};
d.prototype.createLwisRequest=function(){return{url:this.endpoint,data:JSON.stringify(this.createLwisPayload()),type:"POST",contentType:"application/json; charset\x3dutf-8",crossDomain:!0,headers:{Authorization:"allow","X-Amzn-Slate-Token":this.slateToken},error:this._submitErrorCallback,success:this._submitSuccessCallback}};d.prototype.closeFeedbackForm=function(){this.hideFeedbackForm();this.A.trigger("vse:"+this.id+":feedback:closed")};d.prototype.updateReportIllegalContentLink=function(){var c=
encodeURIComponent(""+l.location.origin+l.location.pathname);this.reportIllegalContentLinkSelector.attr("href",l.location.origin+"/manage-content/report/illegal?mediaAci\x3d"+this.activeVideoACI+"\x26referer\x3d"+c)};d.prototype.showInfringementNotSupport=function(){this.feedbackForm.fadeOut(200);this.InfringementNotSupportSection.removeClass("aok-hidden").fadeIn(400);this.updateBottomSheetHeight(this.InfringementNotSupportSection.height()+this.getFeedbackFormVerticalPadding());return this};d.prototype.hideInfringementNotSupport=
function(){this.feedbackForm.fadeIn(10);this.InfringementNotSupportSection.addClass("aok-hidden").fadeOut(10);return this};d.prototype.showThankYou=function(){var c=this;this.feedbackForm.fadeOut(200,function(){c.thankYouSection.removeClass("aok-hidden").fadeIn(400);c.A.trigger("vse:"+c.id+":thank-you:shown")});return this};d.prototype.hideThankYou=function(){this.feedbackForm.fadeIn(10);this.thankYouSection.addClass("aok-hidden").fadeOut(10);this.A.trigger("vse:"+this.id+":thank-you:hidden");return this};
d.prototype.validateFormElements=function(){return this.thankYouSection.length&&this.submitButton.size()&&this.feedbackForm.length};d.prototype.getAndSetBottomSheetInstance=function(){return this.bottomSheetFactory?this.bottomSheetInstance?this.bottomSheetInstance:this.bottomSheetInstance=this.bottomSheetFactory.get(this.id+"-sheet"):u};d.prototype.getAndSetPopoverInstance=function(){return this.popoverFactory?this.popoverInstance?this.popoverInstance:this.popoverInstance=this.popoverFactory.get(this.id+
"-popover"):u};d.prototype.updateBottomSheetHeight=function(c){c=c||this.feedbackContainerSelector.outerHeight();this.isMobile&&this.getAndSetBottomSheetInstance()&&this.bottomSheetInstance.changeHeight({height:c,duration:.1})};d.GET_AUTH_TOKEN_ENDPOINT="/vap/ew/auth/token/batch";return d}(),ra=function(){function d(c){this.config=c;this.feedbackWidgets={}}d.prototype.create=function(c,a,b){void 0===b&&(b=!1);a=this.feedbackWidgets[c]||new qa({id:c,pageStateName:a,A:this.config.A,buttonApi:this.config.buttonApi},
b);return this.feedbackWidgets[c]=a};d.prototype.get=function(c){return this.feedbackWidgets[c]};return d}(),p=function(){function d(){}d.POSITIVE_VOTE="positive";d.NEGATIVE_VOTE="negative";d.NONE_VOTE="none";d.VOTE_STATUS="status";d.EMPTY_STRING="";d.DEFAULT_MIN_GUTTER=24;d.DEFAULT_HEIGHT_ANIMATION_SPEED=200;d.CAROUSEL_PREV_BUTTON_CLASS=".a-carousel-goto-prevpage";d.CAROUSEL_NEXT_BUTTON_CLASS=".a-carousel-goto-nextpage";d.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASSHIDDEN_CLASS="aok-hidden";d.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASS=
"vse-carousel-goto-deactive-btn";d.ANIMATION_SPEED_400=400;d.ANIMATION_SPEED_100=100;d.BOUNCE_CAROUSEL_FACTOR=30;d.BOUNCE_SCROLL_BAR_FACTOR=6;d.SWING="swing";d.FIRST_PAGE="first-page";d.LAST_PAGE="last-page";d.$GROUP_1=".segment-title-G1";d.$GROUP_2=".segment-title-G2";d.$GROUP_3=".segment-title-G3";d.$GROUP_EXPVERNAC=".segment-title-EXPVERNAC";d.NO_GUTTER=0;d.TOLERANT=-.5;d.CURRENT_GUTTER="currentGutter";d.NUMBER_OF_CARDS_TO_LOAD_ADDITIONALLY=1;d.VIP_CAROUSEL_CSS_CLASS="vse-vip-lb-carousel";return d}(),
L=function(){function d(c,a){this.element=c;this.videoVoteConfig=a;this.countsFetched=!1;this.positiveVoteCount=0;this.showPositiveVotes=!1;this.negativeVoteCount=0;this.showNegativeVotes=!1;this.prompt=c.find(".vse-vote-helpful-text");this.positiveVoteText=c.find(".vse-vote-positive");this.positiveVoteIcon=c.find(".vse-vote-positive-icon");this.negativeVoteText=c.find(".vse-vote-negative");this.negativeVoteIcon=c.find(".vse-vote-negative-icon");this.previousVote=p.EMPTY_STRING}d.prototype.getVoteCount=
function(c){return c===p.POSITIVE_VOTE?this.positiveVoteCount:c===p.NEGATIVE_VOTE?this.negativeVoteCount:0};d.prototype.setVoteCount=function(c,a){0>a&&(a=0);c===p.POSITIVE_VOTE?(this.positiveVoteCount=a,this.positiveVoteText.html(String(a))):c===p.NEGATIVE_VOTE&&(this.negativeVoteCount=a,this.negativeVoteText.html(String(a)));this.element.addClass("updated")};d.prototype.getPreviousVote=function(){return this.previousVote};d.prototype.setPreviousVote=function(c){var a=this;if(c===p.POSITIVE_VOTE)this.positiveVoteIcon.addClass("hasvoted"),
this.negativeVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(p.POSITIVE_VOTE)&&this.setVoteCount(p.POSITIVE_VOTE,1),setTimeout(function(){a.positiveVoteIcon.attr("aria-label","Click to remove your vote. Total vote count: "+a.getVoteCount(p.POSITIVE_VOTE))},100);else if(c===p.NEGATIVE_VOTE)this.negativeVoteIcon.addClass("hasvoted"),this.positiveVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(p.NEGATIVE_VOTE)&&this.setVoteCount(p.NEGATIVE_VOTE,1);else if(c===p.NONE_VOTE)this.negativeVoteIcon.removeClass("hasvoted"),
this.positiveVoteIcon.removeClass("hasvoted"),setTimeout(function(){a.positiveVoteIcon.attr("aria-label","Click to vote positive. Total vote count: "+a.getVoteCount(p.POSITIVE_VOTE))},100);else return;this.previousVote=c};d.prototype.setContentId=function(c){this.contentId=c};d.prototype.getContentId=function(){return this.contentId};d.prototype.showOrHide=function(c,a,b,g){this.showPositiveVotes=c;this.showNegativeVotes=a;this.showPrompt=b;c?(this.positiveVoteText.addClass("vse-show"),this.positiveVoteIcon.addClass("vse-show")):
(this.positiveVoteText.removeClass("vse-show"),this.positiveVoteIcon.removeClass("vse-show"));a?(this.negativeVoteText.addClass("vse-show"),this.negativeVoteIcon.addClass("vse-show")):(this.negativeVoteText.removeClass("vse-show"),this.negativeVoteIcon.removeClass("vse-show"));b?this.prompt.addClass("vse-show"):this.prompt.removeClass("vse-show");g?this.element.addClass("vse-show"):this.element.removeClass("vse-show")};d.prototype.updateWithNewVote=function(c){if(c===p.POSITIVE_VOTE||c===p.NEGATIVE_VOTE){var a=
c==p.POSITIVE_VOTE?p.NEGATIVE_VOTE:p.POSITIVE_VOTE,b=this.getVoteCount(c),g=this.getVoteCount(a);c===this.getPreviousVote()?(this.setPreviousVote(p.NONE_VOTE),this.setVoteCount(c,b-1)):this.getPreviousVote()!==p.EMPTY_STRING&&this.getPreviousVote()!==p.NONE_VOTE?(this.setVoteCount(a,g-1),this.setVoteCount(c,b+1),this.setPreviousVote(c)):(this.setPreviousVote(c),this.setVoteCount(c,b+1))}};return d}(),sa=function(){return function(d,c,a){this.contentId=d;this.positiveVoteCount=c;this.negativeVoteCount=
a}}(),ta=function(){return function(d,c,a){this.contentId=d;this.positiveVoteCount=c;this.voteStatus=a}}(),M=function(){function d(c,a){this.A=c;this.videoVoteConfig=a}d.prototype.createFromContent=function(c,a){c=this.A.$("#"+c).find('[.vse-video-votes][data-contentid\x3d"'+a+'"]');return new L(c,this.videoVoteConfig)};d.prototype.createFromSelector=function(c){var a=this.A.$(""+c);if(!a)throw new H("VideoVoteContainerFactory can not find selector by the name of "+c+".");return new L(a,this.videoVoteConfig)};
d.prototype.sendVoteToRemote=function(c,a,b){var g=this,d=this.getBasicPayload(this.videoVoteConfig),f=this.A.$.extend(d,{contentId:b,positive:c,negative:a});return new this.videoVoteConfig.dependencies.promise(function(a,b){ia.sendRequest(g.A,"/vap/ew/subcomponent/votes/writing",f,function(b,c,g){null!==g.http.responseURL&&g.http.responseURL!==u&&g.http.responseURL.includes("signin")&&(c=g.http.responseURL,g=encodeURIComponent(l.location.href),c=c.replace(/return_to=.*?&/,"return_to\x3d"+g+"\x26"),
l.location.href=c);a(b)},function(a){m.count("vse:votecast:failed",1);b(a)})})};d.prototype.fetchVoteCountAndStatus=function(c){var a=this,b=this.getVoteCountAndStatusBasicPayload(this.videoVoteConfig),g=this.A.$.extend(b,{contentId:c});return new this.videoVoteConfig.dependencies.promise(function(b,c){z.sendRequest(a.A,"/vap/ew/subcomponent/votes/countandstatus",g,function(g){g=a.convertPayloadToVoteCountAndStatusData(g);null!=g&&b(g);c(g)},function(a){m.count("vse:votegetcountsandstatus:failed",
1);c(a)})})};d.prototype.fetchVoteHistory=function(c){var a=this,b=this.getBasicPayload(this.videoVoteConfig),g=this.A.$.extend(b,{contentId:c});return new this.videoVoteConfig.dependencies.promise(function(b,c){z.sendRequest(a.A,"/vap/ew/subcomponent/votes/status",g,function(a){b(a)},function(a){m.count("vse:votehistory:failed",1);c(a)})})};d.prototype.convertPayloadToVoteData=function(c){var a=[],b;for(b in c)c.hasOwnProperty(b)&&a.push(new sa(b,c[b].positive,c[b].negative));return a};d.prototype.convertPayloadToVoteCountAndStatusData=
function(c){var a=null;if(null===c||0===Object.keys(c).length)return null;var b=Object.keys(c)[0];c.hasOwnProperty(b)&&(a=new ta(b,c[b].positive,c[b].status));return a};d.prototype.fetchVoteCounts=function(c){var a=this,b=this.getBasicPayload(this.videoVoteConfig),g=this.A.$.extend(b,{contentIds:c});return new this.videoVoteConfig.dependencies.promise(function(b,c){z.sendRequest(a.A,"/vap/ew/subcomponent/votes",g,function(g){g=a.convertPayloadToVoteData(g);0<g.length&&b(g);c(g)},function(a){m.count("vse:votegetcounts:failed",
1);c(a)})})};d.prototype.getBasicPayload=function(c){return{placement:c.placementContext,requestId:c.requestId,sessionId:c.sessionId,page:c.page,bypassLogin:c.forceTreatment||!1}};d.prototype.getVoteCountAndStatusBasicPayload=function(c){return{placement:c.placementContext,page:c.page}};return d}(),ua=function(){return function(d){var c=this;this.config=d;this.getTabs=function(){return c.tabs};this.updateSegmentTabForVideo=function(a){c.config.A.$(""+c.segmentTabCssClassSelectorName).removeClass("vse-tab-active vse-tab-no-border");
for(var b=0;b<c.tabs.length&&a>=c.tabs[b].startIndex;++b);c.config.A.$(c.segmentTabCssClassSelectorName+".tab-"+(0<b?b-1:0)).addClass("vse-tab-active vse-tab-with-border")};this.updateSegmentTabOnClick=function(a){c.config.A.$(""+c.segmentTabCssClassSelectorName).removeClass("vse-tab-with-border").addClass("vse-tab-no-border");c.config.A.$(c.segmentTabCssClassSelectorName+"."+a.cssClassName).addClass("vse-tab-with-border")};this.tabs=d.segmentTabs||[];this.segmentTabCssClassSelectorName=this.config.segmentTabCssClassSelectorName}}(),
va=function(){function d(c,a,b,g,d,f){var h=this;this.carouselFramework=a;this.carouselConstants=b;this.A=g;this.contentCarouselConfig=d;this.deps=f;this.vseAssets=[];this.vseAssetIndex={};this.voteContainerIndex={};this.carouselPageSize=this.carouselTotalPages=0;this.carouselPageNumber=1;this.totalVideosLoaded={};this.showSeeMoreButton=!1;this.loadImagesManually=function(a,b){for(var c=a.getAttr(h.carouselConstants.PAGE_SIZE),g=b=(b-1)*c+1;g<b+c+p.NUMBER_OF_CARDS_TO_LOAD_ADDITIONALLY;g++){var d=
h.A.$(a.dom.$container.find(".vse-video-card:nth-child("+g+")"));d.addClass("vse-img-manually-loaded");h.A.loadDescendantImagesManually(d)}};this.getplaylist=function(){return h.vseAssets.slice()};this.getActiveAsset=function(){return h.activeAsset};this.scrollTo=function(){var a=h.A.$("#"+h.contentCarouselConfig.carouselName),b=a.find(".a-carousel");0<b.length?(a=a.find(".vse-flex-carousel-header"),a=a[0]?a[0].clientHeight:0,b.animate({scrollTop:b.scrollTop()+h.activeCard.position().top-a})):h.A.$("#"+
h.contentCarouselConfig.carouselName).animate({scrollTop:h.activeCard.offset().top-h.A.$("#"+h.contentCarouselConfig.carouselName).offset().top-h.additionalPaddingTop+h.A.$("#"+h.contentCarouselConfig.carouselName).scrollTop()})};this.rotateTo=function(a){h.useMultiCarousel?h.rotateToMultiCarousel(a):(h.markPlaying(a),h.contentCarouselConfig.isVerticalScroll&&h.scrollTo(),0!==h.carouselPageSize&&(a=h.findIndex(a),-1!==a&&(a=Math.floor(a/h.carouselPageSize)+1,h.carouselPageNumber!=a&&("none"==h.auiCarousel.getAttr("transitionStrategy")?
h.animateCarousel(a-1):h.auiCarousel.gotoPage(a)))))};this.rotateToMultiCarousel=function(a){h.markPlaying(a);0===h.carouselPageSize&&(h.carouselPageSize=1);a=h.findIndex(a);-1!==a&&(a=(a+1<h.vseAssets.length?a+1:a)+1,h.carouselPageNumber!=a&&("none"==h.auiCarousel.getAttr("transitionStrategy")?h.animateCarousel(a-1):h.auiCarousel.gotoPage(a)))};this.markPlaying=function(a){h.activeAsset=a;h.activeCard.removeClass("active");h.vseAssetIndex[a.contentId]&&(h.activeCard=h.vseAssetIndex[a.contentId].$el.closest("li").addClass("active"))};
this.findIndex=function(a){return h.vseAssets.indexOf(h.vseAssetIndex[a.contentId])};this.emitRefTag=function(a,b,c){0<h.listOffset&&(a=(a-h.listOffset+h.vseAssets.length)%h.vseAssets.length);h.refTagRecorder.emitRefTag(b+a+c)};this.destroy=function(){h.A.$("#"+h.contentCarouselConfig.carouselName+" .a-carousel-card.active").removeClass("active")};this.updateVotingElements=function(a,b){h.A.each(a,function(a){var c=h.vseAssetIndex[a.contentId].videoVoteContainer;c.setVoteCount(p.POSITIVE_VOTE,a.positiveVoteCount);
c.setVoteCount(p.NEGATIVE_VOTE,a.negativeVoteCount);c.countsFetched=!0;c.showOrHide(b,b,!1,b)})};this.updateVotingElementsForCountAndStatus=function(a,b){var c=h.vseAssetIndex[a.contentId].videoVoteContainer;c.setVoteCount(p.POSITIVE_VOTE,a.positiveVoteCount);c.countsFetched=!0;c.setPreviousVote(1===a.voteStatus?p.POSITIVE_VOTE:p.NONE_VOTE);c.showOrHide(b,b,!1,b)};this.initializeSegmentTabs=function(a){h.segmentTabsModule=new ua(a);h.segmentTabs=h.segmentTabsModule.getTabs();h.attachTabClickHandlers();
h.attachTabChangeHandlerOnCarouselScroll();h.showCreatorProfiles(".vse-video-customer-profile",".vse-video-labels")};this.showCreatorProfiles=function(a,b){var c="#"+h.contentCarouselConfig.carouselName+"."+p.VIP_CAROUSEL_CSS_CLASS+" .vse-video-card";h.A.$(c).each(function(c,g){c=h.A.$(g).find(a);var d=h.A.$(g).find(b);0<c.length&&0<d.length&&(d.html(c.removeClass("vse-hidden aok-hidden").detach().get(0).outerHTML),h.A.$(g).addClass("vse-video-card-has-profile"))});h.A.$(c+" .vse-profile").click(function(a){h.disableCreatorClicksOnMshop&&
a.preventDefault();a.stopPropagation();a.stopImmediatePropagation()})};this.attachTabClickHandlers=function(){h.segmentTabs.forEach(function(a){var b=h.A.$(h.segmentTabsModule.segmentTabCssClassSelectorName+"."+a.cssClassName);b.click(function(){h.animateCarousel(a.startIndex);b.hasClass("vse-tab-active")||h.segmentTabsModule.updateSegmentTabOnClick(a)})})};this.attachTabChangeHandlerOnCarouselScroll=function(){h.A.$("#"+h.contentCarouselConfig.carouselName+"."+p.VIP_CAROUSEL_CSS_CLASS+" .a-carousel-viewport").scroll(function(){h.A.$("#"+
h.contentCarouselConfig.carouselName+"."+p.VIP_CAROUSEL_CSS_CLASS+" .vse-video-card").each(function(a,b){h.orientationConfig.getCardInViewOffset(h.A.$(b))<=h.orientationConfig.getOffsetPointForTabUpdate()&&h.segmentTabsModule.updateSegmentTabForVideo(a)})})};this.animateCarousel=function(a){if(!h.A.objectIsEmpty(h.orientationConfig)){var b=h.orientationConfig.animatedCarouselDimensionValue();a*=h.shouldUseVerticalThumbnail&&b.verticalCarouselCardWidth?b.verticalCarouselCardWidth:b.carouselCardWidth;
h.useMultiCarousel&&h.resizeCarousel(a);h.auiCarousel.dom.$viewport.animate(h.orientationConfig.getCarouselPropertyToAnimate(a),500)}};this.resizeCarousel=function(a){var b=h.auiCarousel.dom.$viewport[0].scrollWidth-h.auiCarousel.dom.$viewport[0].clientWidth;if(b<a){var c=h.auiCarousel.dom.$carousel.css("width").slice(0,-2);h.auiCarousel.dom.$carousel.css("width",parseInt(c)+(a-b)+"px")}};this.scrollToActiveVideo=function(a){a=h.findIndex(a);h.animateCarousel(a)};this.updateSegmentTabForActiveVideo=
function(a){a=h.findIndex(a);h.segmentTabsModule.updateSegmentTabForVideo(a)};this.setOrientationConfig=function(a){h.orientationConfig=a};this.getAssetSpec=function(a,b,c,g){var d=a.data(),e=a.find(".vse-video-image").data("img"),f=a.find("[data-redirect-url]").data("redirectUrl")||"",e=e.replace("SR160,90_BG0,0,0_PKvse-overlay-play2","").replace("SR320,180_BG0,0,0_PKvse-overlay-play2",""),C=[];if(d.closedCaptions)for(var k=d.closedCaptions.split(","),n=0;n<k.length-1;n+=2)C.push({locale:k[n],url:k[n+
1]});a={index:b,contentId:a.attr("data-asin"),title:d.title,vendorName:d.vendorName,vendorCode:d.vendorCode,entityId:d.entityId,entityType:d.entityType,referenceUrl:d.referenceUrl,referenceLinkTitle:d.referenceTitle,videoUrl:d.videoUrl,$el:a,duration:d.duration,imageUrl:e,sponsored:d.sponsored,videoVoteContainer:h.voteContainerIndex[d.asin],productAsin:d.productAsin,refTag:c+b+g,continuousPlayRefTag:c+b+g+"_auto_play",relatedProducts:d.relatedProducts,vendorTrackingId:d.vendorTrackingId,videoReferenceId:d.videoRefId,
groupType:d.groupType,impressionRecorded:!1,closedCaptions:C,creatorType:d.creatorType,videoAge:d.videoAge,rankingStrategy:d.rankingStrategy,aciContentId:d.aciContentId,mimeType:d.mimeType,showHotspots:d.showHotspots,hasHotspots:d.hasHotspots,labelDetails:{},ccvDisclosure:d.ccvDisclosure,segmentNumber:d.segmentNumber,altText:d.altText,disableVote:d.disableVote,redirectUrl:f,reportUrl:d.reportUrl,disableReportIllegalLink:d.disableReportIllegalLink};h.isUndefinedOrEmpty(d.labelName)||h.isUndefinedOrEmpty(d.labelType)||
h.isUndefinedOrEmpty(d.labelWeblabName)||(a.labelDetails={labelName:d.labelName,labelType:d.labelType,labelWeblabName:d.labelWeblabName,showLabel:d.showLabel,tooltipSelector:d.labelTooltipSelector});return a};this.isUndefinedOrEmpty=function(a){return h.A.objectIsEmpty(a)||""===a};this.displayOrHideCarouselButtons=function(a){var b=a.getAttr(h.carouselConstants.PAGE_NUMBER),c=a.getAttr(h.carouselConstants.TOTAL_PAGES),g=a.dom.$container.find(p.CAROUSEL_PREV_BUTTON_CLASS);a=a.dom.$container.find(p.CAROUSEL_NEXT_BUTTON_CLASS);
g.toggleClass(p.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASS,1===b||1===c);a.toggleClass(p.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASS,b===c||1===c)};this.removeActive=function(){h.activeAsset=u;h.activeCard.removeClass("active")};var n=g.$;this.activeCard=n([]);var t=this;this.auiCarousel=c;this.refTagRecorder=new J(g);this.showSeeMoreButton=d.seeMoreFunctionality.showSeeMoreButton;this.useMultiCarousel=d.useMultiCarousel;this.disableCreatorClicksOnMshop=d.disableCreatorClicksOnMshop;this.shouldUseVerticalThumbnail=
d.shouldUseVerticalThumbnail;this.additionalPaddingTop=parseInt(n("#"+d.carouselName).css("paddingTop"));n("#"+d.carouselName).find(".a-carousel-heading").after(n("#"+d.carouselName).find(".vse-upload-link").removeClass("aok-hidden"));n("#"+d.carouselName+" .vse-video-item").each(function(a){a=t.getAssetSpec(n(this),a,t.contentCarouselConfig.refTagPrefix,t.contentCarouselConfig.celQueryStringParam);t.vseAssets.push(a);t.vseAssetIndex[a.contentId]=a});d.showVideoVotes&&d.videoVoteConfig&&(this.videoVoteContainerFactory=
new M(g,d.videoVoteConfig),g.each(this.vseAssetIndex,function(a){a.disableVote||(h.voteContainerIndex[a.contentId]=h.videoVoteContainerFactory.createFromContent(h.contentCarouselConfig.carouselName,a.contentId),a.videoVoteContainer=h.voteContainerIndex[a.contentId])}));n("#"+d.carouselName+" .vse-video-card").find(p.$GROUP_1).first().addClass("first-item");n("#"+d.carouselName+" .vse-video-card").find(p.$GROUP_2).first().addClass("first-item");n("#"+d.carouselName+" .vse-video-card").find(p.$GROUP_3).first().addClass("first-item");
n("#"+d.carouselName+" .vse-video-card").find(p.$GROUP_EXPVERNAC).first().addClass("first-item");(c=d.useMShopVDPFallback&&g.capabilities.isAmazonApp&&g.capabilities.android&&0===g.capabilities.androidVersion.indexOf("8"))||n("#"+d.carouselName).delegate(".a-carousel-card a","click",function(a){if(!(0<n(this).closest(".vse-sm-expander").length))if(n(this).closest("li").hasClass("active"))a.preventDefault();else{var b=t.vseAssetIndex[n(this).closest("li").find(".vse-video-item").data("asin")];t.markPlaying(b);
b.eventTimestamp=Date.now();g.trigger("vse:contentCarousel:"+d.carouselName+":click",b);b=t.findIndex(b);t.emitRefTag(b,t.contentCarouselConfig.refTagPrefix,t.contentCarouselConfig.celQueryStringParam);d.isPreventDefault&&a.preventDefault()}});var e=c?t.contentCarouselConfig.refTagPrefix+"_mshop_fallback":t.contentCarouselConfig.refTagPrefix;n("#"+d.carouselName+" .vse-carousel-item").each(function(a){var b=n(this);b.attr("href",b.data("redirect-url")+"?ref\x3d"+e+a+t.contentCarouselConfig.celQueryStringParam)});
g.off("a:carousel:"+d.carouselName+":change:pageSize");g.off("a:carousel:"+d.carouselName+":change:pageNumber");g.on("a:carousel:"+d.carouselName+":change:pageSize",function(){h.carouselPageSize=h.auiCarousel.getAttr("pageSize");h.activeAsset&&h.rotateTo(h.activeAsset)});g.trigger("a:carousel:"+d.carouselName+":change:pageSize");g.on("a:carousel:"+d.carouselName+":change:pageNumber",function(a){a.carousel.getAttr("totalPages");h.carouselPageNumber=h.auiCarousel.getAttr("pageNumber");g.trigger("a:carousel:"+
d.carouselName+":scrollCarousel",h.carouselPageNumber,h.carouselPageSize)});g.trigger("a:carousel:"+d.carouselName+":updatePageIndex",this.carouselPageNumber,this.carouselPageSize);g.declarative(d.carouselName+"-sm-link","click touch",function(a){n("#"+d.carouselName+" .vse-video-item .vse-carousel-item").first().click()});d.showCreatorProfiles&&this.showCreatorProfiles(".vse-creator-profile",".vse-thumbn-cp-placeholder");this.showSeeMoreButton&&this.initializeTotalVideosLoaded();g.declarative(this.contentCarouselConfig.carouselName+
"-seeMoreRelatedVideosButtonClick","click touch",function(a){h.handleSeeMoreClick(a)});this.carouselFramework.onInit(""+this.contentCarouselConfig.carouselName,function(a){h.contentCarouselConfig.useCustomButtons&&(g.declarative.create(g.$("#"+d.carouselName),h.contentCarouselConfig.carouselName+"-declarative",{}),g.declarative(h.contentCarouselConfig.carouselName+"-declarative","mouseenter touchstart focus",function(){1!==a.getAttr(h.carouselConstants.TOTAL_PAGES)&&(g.$("#"+d.carouselName).addClass("vse-carousel-show-btn"),
g.$("#"+d.carouselName+" .vse-carousel-button").stop(!0,!0).fadeIn({duration:300,queue:!1}))}),g.declarative(h.contentCarouselConfig.carouselName+"-declarative","mouseleave",function(){1!==a.getAttr(h.carouselConstants.TOTAL_PAGES)&&(g.$("#"+d.carouselName).removeClass("vse-carousel-show-btn"),g.$("#"+d.carouselName+" .vse-carousel-button").stop(!0,!0).fadeOut({duration:300,queue:!1}))}),h.displayOrHideCarouselButtons(a));h.contentCarouselConfig.loadImagesManually&&h.loadImagesManually(a,1);g.on("a:carousel:"+
h.contentCarouselConfig.carouselName+":change:pageNumber",function(a){h.contentCarouselConfig.loadImagesManually&&(h.displayOrHideCarouselButtons(a.carousel),h.loadImagesManually(a.carousel,a.newValue))});g.on("a:carousel:"+h.contentCarouselConfig.carouselName+":change:pageSize",function(a){h.contentCarouselConfig.loadImagesManually&&(h.displayOrHideCarouselButtons(a.carousel),h.loadImagesManually(a.carousel,a.newValue))});h.useMultiCarousel&&h.activeAsset&&h.rotateToMultiCarousel(h.activeAsset)})}
d.prototype.changeStartingCardTo=function(c){var a=this;this.listOffset=this.findIndex(c);var b=this;this.A.$("#"+this.contentCarouselConfig.carouselName+" .vse-carousel-item").each(function(a){var c=b.A.$(this);a=(a-b.listOffset+b.vseAssets.length)%b.vseAssets.length;c.attr("href",c.data("redirect-url")+"?ref\x3d"+b.contentCarouselConfig.refTagPrefix+a)});this.contentCarouselConfig.isVerticalScroll||(this.carouselFramework.initializeAll(),this.carouselFramework.onInit(""+this.contentCarouselConfig.carouselName,
function(){a.rotateTo(c)}))};d.prototype.initializeTotalVideosLoaded=function(){for(var c=this.contentCarouselConfig.seeMoreFunctionality.segmentTypeToCountMap,a=0,b=Object.keys(c);a<b.length;a++){var g=b[a];this.totalVideosLoaded[g]=Math.min(this.contentCarouselConfig.seeMoreFunctionality.initialVisibleVideoCount,c[g])}};d.prototype.handleSeeMoreClick=function(c){c=c.$currentTarget.get()[0];c=this.A.$(c).find("[data-segment-id]").attr("data-segment-id");this.loadMoreVideos(c)};d.prototype.loadMoreVideos=
function(c){var a=this.A.$("#"+this.contentCarouselConfig.carouselName+" #vse-sm-link-"+c);a.closest(".vse-video-card").outerHeight(!0);for(var b=this.contentCarouselConfig.seeMoreFunctionality.newVisibleVideoCount,g=this.contentCarouselConfig.seeMoreFunctionality.segmentTypeToCountMap[c],d=this.getTotalVideosLoadedForSegment(c),b=Math.min(d+b,g),f=d;f<b;f++){var h=this.A.$("#"+this.contentCarouselConfig.carouselName+" #vse-video-element-"+c+"-"+f);h.closest("div.vse-hidden.vse-show-more").removeClass("vse-hidden vse-show-more");
h.closest("li.vse-sm-no-padding").removeClass("vse-sm-no-padding")}this.setTotalVideosLoadedForSegment(c,b);b>=g&&a.addClass("vse-hidden vse-show-more");this.getSeeMoreIndex(c);this.A.$("#"+this.contentCarouselConfig.carouselName+" #vse-video-element-"+c+"-"+(d-1)).closest(".vse-video-card").outerHeight(!0)};d.prototype.getSeeMoreIndex=function(c){c=c.replace(/.*_G(.)/,"$1");return parseInt(c)};d.prototype.getTotalVideosLoadedForSegment=function(c){return this.totalVideosLoaded[c]||0};d.prototype.setTotalVideosLoadedForSegment=
function(c,a){this.totalVideosLoaded[c]=a};d.prototype.resetVideosStateOnLightboxReopen=function(){var c=this;if(this.showSeeMoreButton){var a=this.A.$("#"+this.contentCarouselConfig.carouselName+" li.vse-video-card"),b=this.contentCarouselConfig.seeMoreFunctionality.segmentTypeToCountMap,g=0;a.each(function(a,d){a=c.getSegmentTypeFromElement(c.A.$(d));var f=b[a];g<Math.min(f,c.contentCarouselConfig.seeMoreFunctionality.initialVisibleVideoCount)?c.setTotalVideosLoadedForSegment(a,g+1):g<f&&(c.A.$(d).addClass("vse-sm-no-padding"),
c.A.$(d).children(".vse-video-item").addClass("vse-hidden vse-show-more"));g+=1;g==f&&(g>c.contentCarouselConfig.seeMoreFunctionality.initialVisibleVideoCount&&c.A.$(d).find("#vse-sm-link-"+a).removeClass("vse-hidden vse-show-more"),g=0)})}};d.prototype.getSegmentTypeFromElement=function(c){c=this.A.$(c).prevAll(".vse-flex-carousel-header").first();return 0<c.length&&(c=c.attr("class").match(/segment-title-(.+)/))&&c[1]?c[1].split(" ")[0]:p.EMPTY_STRING};return d}(),N=function(){function d(c,a,b,
g){this.carouselFramework=c;this.carouselConstants=a;this.A=b;this.deps=g}d.prototype.create=function(c){var a=this.carouselFramework.getCarousel(this.A.$("#"+c.carouselName));if(!a)throw new H("Carousel framework can not find carousel by the name of "+c.carouselName+".");return new va(a,this.carouselFramework,this.carouselConstants,this.A,c,this.deps)};return d}(),aa=function(){function d(c,a){var b=this;this.A=c;this.constants=a;this.repaint=function(a){var c=a.getDimensions().viewport.width,d=
a.dom.$carousel.children("li").get(0).getBoundingClientRect(),d=d.width?d.width:d.right-d.left,f=b.updateVisibleItems(a,c,d);b.updateCarouselDimensions(a,c,d);a.gotoIndex(f,{animationDuration:0,ignorePause:!0});a.triggerEvent("repaint")};this.resize=function(a,c){c.viewport&&c.viewport.width!==u&&b.repaint(a)};this.init=function(a){var c=a.getAttr(b.constants.FIRST_VISIBLE_ITEM);a.setAttr(b.constants.MIN_GUTTER,p.NO_GUTTER);a.setAttr(p.CURRENT_GUTTER,p.NO_GUTTER);b.repaint(a);1<c&&(c=Math.ceil(c/
a.getAttr(b.constants.PAGE_SIZE)),a.gotoPage(c));b.bindAttrChangeHandlers(a)}}d.prototype.determinePageSize=function(c,a,b){c=0;if(0<b)for(;a>p.TOLERANT;)c++,a-=b;0>a&&c--;return this.A.isFiniteNumber(c)&&0<c?c:1};d.prototype.bindAttrChangeHandlers=function(c){var a=this;c.onChange(this.constants.PAGE_NUMBER,function(){c.getAttr(a.constants.HIDE_OFF_SCREEN)&&c.dom.$carousel.children("li").css("visibility","")});c.onChange(this.constants.ANIMATING,function(b){if(!b&&c.getAttr(a.constants.HIDE_OFF_SCREEN)){var d=
c.getAttr(a.constants.FIRST_VISIBLE_ITEM)-1,f=d+c.getAttr(a.constants.PAGE_SIZE)-1;c.dom.$carousel.children("li").each(function(b,c){b=b>=d&&b<=f;a.A.$(c).css("visibility",b?"":"hidden")})}})};d.prototype.updateCarouselDimensions=function(c,a,b){var d;d=c.dom.$carousel;var f=d.children("li");a=f.length;var k=f.first().outerWidth(!0),f=f.eq(1).outerWidth(!0),k=(a-1)*f+k;d.css("width",k+"px");k={carousel:{width:k,outerWidth:d.outerWidth()},items:[]};for(d=0;d<a;d++)k.items.push({width:b,outerWidth:f});
c.updateDimensionsCache(k)};d.prototype.updateVisibleItems=function(c,a,b){var d=c.getAttr(this.constants.TOTAL_PAGES),f=c.getAttr(this.constants.PAGE_NUMBER),k=c.getAttr(this.constants.HIDE_OFF_SCREEN),h=c.dom.$carousel.children("li"),n=c.getAttr(this.constants.FIRST_VISIBLE_ITEM);a=this.determinePageSize(c,a,b);var t=(f-1)*a+1;c.setAttr(this.constants.PAGE_SIZE,a);f>d?(n=(d-1)*a+1,c.setAttr(this.constants.PAGE_NUMBER,d),c.setAttr(this.constants.FIRST_VISIBLE_ITEM,n)):n!==t&&(d=Math.ceil(n/a),n=
(d-1)*a+1,c.setAttr(this.constants.PAGE_NUMBER,d),c.setAttr(this.constants.FIRST_VISIBLE_ITEM,n));var e=n-1,x=e+a-1;h.each(function(a,c){c.style.visibility=!k||a>=e&&a<=x+p.NUMBER_OF_CARDS_TO_LOAD_ADDITIONALLY?"":"hidden";c.style.width=b+"px"});return n};return d}(),ba=function(){function d(c,a,b){var d=this;this.A=c;this.constants=a;this.slideTransition=b;this.carouselLeft=0;this.token=!1;this.init=function(a){d.$scrollBar=a.dom.$container.find(".vse-carousel-scrollbar-thumb");d.carouselLeft=-1*
parseInt(a.dom.$carousel.css("left"),10);d.slideTransition.init(a)};this.gotoNextPage=function(a,b){return d.slideTransition.gotoNextPage(a,b)};this.gotoPrevPage=function(a,b){return d.slideTransition.gotoPrevPage(a,b)};this.gotoPage=function(a,b,c){if(!d.locked()){d.lock();var f=b,t=a.getAttr(d.constants.TOTAL_PAGES),e=a.getAttr(d.constants.PAGE_SIZE),x=a.getAttr(d.constants.SET_SIZE);0<b&&b<=t&&a.setAttr(d.constants.PAGE_NUMBER,b);1>b?b=1:b>t&&(b=t);var q=e*(b-1)+1;b===t&&(q=Math.min(q,x-e+1));
1>f||f>t?(d.bounce(a.dom.$carousel,p.BOUNCE_CAROUSEL_FACTOR*(1>f?1:-1)),d.bounce(d.$scrollBar,1*p.BOUNCE_SCROLL_BAR_FACTOR)):d.gotoIndex(a,q,c)}};this.gotoIndex=function(a,b,c){var f=a.getDimensions();c=f.carousel.outerWidth;var f=f.viewport.outerWidth,t=c-f;b=Math.max(Math.min(a.getItemOffset(b),t),0);c=f/c;f=Math.min(c*f,f);d.$scrollBar=a.dom.$container.find(".vse-carousel-scrollbar-thumb");d.$scrollBar.width(f);d.$scrollBar.animate({left:c*b},p.ANIMATION_SPEED_400,p.SWING);a.dom.$carousel.animate({left:-b},
p.ANIMATION_SPEED_400,p.SWING,function(){d.carouselLeft=a.dom.$carousel.css("left");d.unlock()})};this.lock=function(){d.token=!0};this.unlock=function(){d.token=!1};this.locked=function(){return d.token};this.vseTransitionStrategy=c.copy(b);this.vseTransitionStrategy.init=function(a){return d.init(a)};this.vseTransitionStrategy.gotoPage=function(a,b,c){return d.gotoPage(a,b,c)};this.vseTransitionStrategy.gotoIndex=function(a,b,c){return d.gotoIndex(a,b,c)}}d.prototype.get=function(){return this.vseTransitionStrategy};
d.prototype.bounce=function(c,a){var b=this;c.each(function(c,d){var f=b.A.$(d);f.animate({marginLeft:a},p.ANIMATION_SPEED_400,p.SWING,function(){f.animate({marginLeft:0},p.ANIMATION_SPEED_100,p.SWING,b.unlock)})})};return d}(),r=function(){function d(){}d.IVE_CSS_CLASS_PREFIX="ive-";d.ATTRIBUTION_NAME="ive-inline-player";d.PLAYER_WRAPPER_SELECTOR=".ive-video-player-wrapper";d.LB_PLAYER_PLACEHOLDER_SELECTOR=".ive-inline-lb-player-placeholder";d.CLOSE_BUTTON_SELECTOR=".ive-inline-player-close-button";
d.AUDIO_TOGGLE_BUTTON_SELECTOR=".ive-inline-player-audio-toggle";d.PLAY_TOGGLE_BUTTON_SELECTOR=".ive-inline-player-play-toggle";d.EXPAND_BUTTON_SELECTOR=".ive-inline-player-expand";d.OSP_LINK_SELECTOR=".ive-inline-player-osp-link";d.REMAINING_TIME_SELECTOR=".ive-inline-player-remaining-time";d.PLAYER_CONTAINER_SELECTOR=".vse-player-container";d.MUTE_CSS_CLASS="ive-inline-player-mute";d.UNMUTE_CSS_CLASS="ive-inline-player-unmute";d.PLAY_CSS_CLASS="play";d.REPLAY_CSS_CLASS="replay";d.PAUSE_CSS_CLASS=
"pause";d.INLINE_PLAYER_MODE="inline";d.IVX_PLAYER_MODE="ivx";d.BLUR_WRAPPER_SELECTOR=".awa-blur-wrapper";d.LB_PLAYER_MODE="lb";d.INLINE_PLAYER_EXPAND_BUTTON_CLICK="inline:expand:click";d.INLINE_PLAYER_CLOSE_BUTTON_CLICK="inline:close:click";d.ROTATE_TO_ORIENTATION_METRIC_NAME="rotateTo";d.MUTED_AUDIO_PREF="muted";d.UNMUTED_AUDIO_PREF="unmuted";return d}(),ca=function(){return function(d,c,a){var b=this;this.openLightbox=function(a,c,d,f){var n=b.vars.sharedUtils.getModalFactory();b.vars.callback=
f;(f=n&&n.get(b.vars.A.$("#"+b.vars.popoverTriggerId)))?(b.vars.$ingressPlaceholder=a,b.setClickedVideo(c),f.show(),b.movePlayerToLightbox(a,c),d.preventDefault(),d.stopPropagation()):b.handleError("cannotOpenLightbox","Cannot find Lightbox popover for popoverTriggerId: "+b.vars.popoverTriggerId)};this.setClickedVideo=function(a){b.vars.clickedVideo&&(b.vars.previouslyClickedVideo=a);b.vars.clickedVideo=a};this.movePlayerToLightbox=function(a,c){b.vars.ingressAssetSpec=c;var d=b.vars.A.$("#"+b.vars.sharedUtils.vars.templateId).find(r.LB_PLAYER_PLACEHOLDER_SELECTOR);
if(0<a.length&&0<d.length){a.find(r.BLUR_WRAPPER_SELECTOR).hide();var f=function(){a.find(r.PLAYER_WRAPPER_SELECTOR).detach().appendTo(d)};b.vars.isMobile?setTimeout(f,500):f();b.changePlayerMode(b.vars.isMobile?r.IVX_PLAYER_MODE:r.LB_PLAYER_MODE);b.setClickedVideo(c);b.vars.previouslyClickedVideo&&b.vars.clickedVideo.contentId!==b.vars.previouslyClickedVideo.contentId||b.player.emitStartCountMetric()}};this.movePlayerToIngress=function(a){b.setCurrentIngressPlaceholder(a);var c=b.vars.sharedUtils.dom.$wrapper.find(r.LB_PLAYER_PLACEHOLDER_SELECTOR);
0<a.length&&0<c.length&&(c.find(r.PLAYER_WRAPPER_SELECTOR).detach().appendTo(a),b.changePlayerMode(r.INLINE_PLAYER_MODE),a.find(r.AUDIO_TOGGLE_BUTTON_SELECTOR).toggleClass(r.UNMUTE_CSS_CLASS,b.player.isMuted()).toggleClass(r.MUTE_CSS_CLASS,!b.player.isMuted()),b.setAudioPreferences())};this.addPlayerLoadedHandler=function(){b.player.on("loadeddata",function(){if(!b.vars.sharedUtils.inlinePlayerInitialized){var a="."+b.vars.clientPrefix+".ive-inline-player-controls",c="."+b.vars.clientPrefix+" .ive-inline-player-time",
d="."+b.vars.clientPrefix+" .ive-scrubber-bar-fill",f=0<b.vars.A.$(a).length,n=a+" .ive-inline-player-play-toggle",t=b.vars.shouldLoop;b.listenToMuteUnmuteEvents(b.player);b.player.on("timeupdate",function(a){b.vars.mediaEnded&&b.resetMediaEndedState(n);f?(b.vars.sharedUtils.vars.vipVideoDuration=b.player.getMediaDuration(),b.vars.sharedUtils.updateProgressBarAndTimeDisplay(a,c,d)):b.updateTimeDisplay()});t||b.listenToMediaEndedEvent(b.player,n,d,c);f&&(b.listenToPlayPauseEvents(b.player,n),b.vars.sharedUtils.initializeProgressBarTouchEvents(a,
".ive-scrubber-container",!0));b.vars.sharedUtils.inlinePlayerInitialized=!0}})};this.resetMediaEndedState=function(a){b.vars.mediaEnded=!1;b.vars.A.$(a).removeClass(""+r.REPLAY_CSS_CLASS);b.player.player.playerInstance.videoJS.hasStarted(!0)};this.listenToPlayPauseEvents=function(a,c){var d=b.vars.A.$(r.PLAYER_CONTAINER_SELECTOR).find(c);a.on("play",function(){d.removeClass(r.PLAY_CSS_CLASS+" "+r.REPLAY_CSS_CLASS)});a.on("pause",function(){d.addClass(""+r.PLAY_CSS_CLASS)})};this.listenToMuteUnmuteEvents=
function(a){b.toggleMuteButtonBasedOnPlayerState(a);a.on("volumechange",function(){b.toggleMuteButtonBasedOnPlayerState(a)})};this.toggleMuteButtonBasedOnPlayerState=function(a){b.vars.A.$(r.PLAYER_CONTAINER_SELECTOR).find(r.AUDIO_TOGGLE_BUTTON_SELECTOR).toggleClass(r.UNMUTE_CSS_CLASS,a.isMuted()).toggleClass(r.MUTE_CSS_CLASS,!a.isMuted())};this.listenToMediaEndedEvent=function(a,c,d,f){a.on("ended",function(){b.vars.A.$(c).addClass(""+r.REPLAY_CSS_CLASS);b.player.player.playerInstance.videoJS.hasStarted(!1);
b.vars.A.$(d).width("100%");b.vars.A.$(f).text("-0:00");b.vars.mediaEnded=!0})};this.addLightboxAfterShowAndBeforeHideEvents=function(){b.vars.A.off("a:popover:afterShow:"+b.vars.popoverId);b.vars.A.on("a:popover:afterShow:"+b.vars.popoverId,function(a){try{var c=void 0;if(b.vars.lightboxOpenedFirstTime){var d=b.vars.A.$(a.popover.$popover).find("[data-css-class]");d.length&&b.vars.A.$(a.popover.$popover).addClass(d.attr("data-css-class"));b.vars.lightboxOpenedFirstTime=!1;c=b.vars.clickedVideo.productAsin}else c=
b.vars.clickedVideo.contentId!==b.vars.previouslyClickedVideo.contentId?b.vars.clickedVideo.productAsin:u;b.triggerLightboxOpenEvent(b.vars.clickedVideo,c)}catch(f){b.handleError("cannotOpenLightbox",f)}});b.vars.A.off("a:popover:beforeHide:"+b.vars.popoverId);b.vars.A.on("a:popover:beforeHide:"+b.vars.popoverId,function(){b.closeLightbox()})};this.initializePlayerOverlayComponents=function(a){a.closest(r.PLAYER_CONTAINER_SELECTOR).delegate(r.CLOSE_BUTTON_SELECTOR,"click touchend",function(a){a.preventDefault();
a.stopPropagation();b.player.pause("inline-pause");b.emitMetric(b.vars.clientPrefix+":"+r.INLINE_PLAYER_CLOSE_BUTTON_CLICK);b.vars.A.trigger("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":closeButton:click");m.count("vse:ns:inlinePlayer:closeButton:click",1)});a.closest(r.PLAYER_CONTAINER_SELECTOR).delegate(r.AUDIO_TOGGLE_BUTTON_SELECTOR,"click touchend",function(a){a.preventDefault();a.stopPropagation();a=a.hasOwnProperty("originalEvent")?u:"programmatic-trigger";b.player.isMuted()?b.player.unmute(a):
b.player.mute(a);b.setAudioPreferences();b.vars.A.trigger("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":audioToggle:click");m.count("vse:ns:inlinePlayer:audioToggle:click",1)});a.closest(r.PLAYER_CONTAINER_SELECTOR).delegate(r.PLAY_TOGGLE_BUTTON_SELECTOR,"click touchend",function(a){a.preventDefault();a.stopPropagation();b.player.isPaused()?b.player.play():b.player.pause("inline-pause");b.vars.A.trigger("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":playToggle:click");m.count("vse:ns:inlinePlayer:playToggle:click",
1)});a.closest(r.PLAYER_CONTAINER_SELECTOR).delegate(r.EXPAND_BUTTON_SELECTOR,"click touchend",function(a){b.emitMetric(b.vars.clientPrefix+":"+r.INLINE_PLAYER_EXPAND_BUTTON_CLICK);b.vars.A.trigger("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":expandButton:click");m.count("vse:ns:inlinePlayer:expandButton:click",1)})};this.startPlaying=function(a,c,d){b.setCurrentIngressPlaceholder(c);b.changePlayerMode(r.INLINE_PLAYER_MODE);d&&b.player.setPlayerMode(d);b.vars.$ingressPlaceholder.find(r.OSP_LINK_SELECTOR).toggleClass("aok-hidden",
!a||b.vars.A.objectIsEmpty(a.vendorTrackingId));b.vars.$ingressPlaceholder.find(r.REMAINING_TIME_SELECTOR).addClass("aok-hidden");b.player.play(a);setTimeout(function(){b.vars.$ingressPlaceholder.find(r.REMAINING_TIME_SELECTOR).removeClass("aok-hidden")},600);b.updateAudioToggle(c)};this.changePlayerMode=function(a){b.player.setPlayerMode(a);b.vars.currentPlayerMode!==a&&b.vars.$ingressPlaceholder.find(r.PLAYER_WRAPPER_SELECTOR).removeClass(r.IVE_CSS_CLASS_PREFIX+b.vars.currentPlayerMode).addClass(r.IVE_CSS_CLASS_PREFIX+
a);b.vars.isMobile&&(b.vars.sharedUtils.vars.isVideoImmersivePlayer=a===r.IVX_PLAYER_MODE);b.vars.sharedUtils.vars.currentPlayerMode=a;b.vars.currentPlayerMode=a};this.addOrientationChangeHandler=function(){b.vars.A.on.orientationchange(function(a){b.emitMetric(b.vars.clientPrefix+":"+r.ROTATE_TO_ORIENTATION_METRIC_NAME+(90===Math.abs(a.orientation)?"Landscape":"Portrait"))})};this.emitMetric=function(a){a={eventName:a,stringPayload:"",intPayload:1,titleSessionId:b.player.getTitleSessionId().toString()};
b.vars.sharedUtils.emitMetricToNexus(a)};this.updateAudioToggle=function(a){var c=l.iveAudioPref;(c===r.MUTED_AUDIO_PREF&&!b.player.isMuted()||c===r.UNMUTED_AUDIO_PREF&&b.player.isMuted())&&a.find(r.AUDIO_TOGGLE_BUTTON_SELECTOR).click()};this.setAudioPreferences=function(){l.iveAudioPref=b.player.isMuted()?r.MUTED_AUDIO_PREF:r.UNMUTED_AUDIO_PREF};this.setCurrentIngressPlaceholder=function(a){b.vars.$ingressPlaceholder=a};this.triggerLightboxOpenEvent=function(a,c){b.vars.A.trigger("vse:"+b.vars.clientPrefix+
":page:lightBoxOpened",{lightBoxId:b.vars.popoverId,lazyLoadProductAsin:c,assetSpec:a})};this.closeLightbox=function(){b.vars.A.trigger("vse:"+b.vars.clientPrefix+":page:lightBoxClosed");setTimeout(function(){b.movePlayerToIngress(b.vars.$ingressPlaceholder);b.player.play();b.vars.$ingressPlaceholder.find(r.BLUR_WRAPPER_SELECTOR).show()},50);b.vars.callback&&b.vars.callback()};this.updateTimeDisplay=function(){var a=b.vars.$ingressPlaceholder.find(r.REMAINING_TIME_SELECTOR);if(a.length){var c=b.player.getMediaDuration();
if(!isNaN(c)){var d=Math.min(b.player.getCurrentTime(),c),f=c-d,c=Math.floor(f/3600),d=Math.floor(f/60%60),f=Math.floor(f%60);a.text((0<c?c+":":"")+(0<c&&10>d?"0"+d+":":d+":")+(10>f?"0"+f:f))}}};this.handleError=function(a,c){m.count("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":"+a,1);m.logError(r.ATTRIBUTION_NAME,"Fallback for inline player "+b.vars.clientPrefix,c);b.vars.A.trigger("vse:ns:inlinePlayer:"+b.vars.clientPrefix+":"+a)};this.vars={A:d,sharedUtils:c,clientPrefix:c.vars.clientPrefix,popoverTriggerId:a.popoverTriggerId,
popoverId:a.popoverId,isMobile:c.vars.isMobile,lightboxOpenedFirstTime:!0,clickedVideo:null,previouslyClickedVideo:null,ingressAssetSpec:null,$ingressPlaceholder:null,mediaEnded:!1,callback:null};this.player=c.vars.player}}(),G=function(){function d(c,a,b,d){var f=this;this.onIntersectionObserved=function(a,b){a.forEach(function(a){if(b){var c=a.target,d=f.getElementUniqueKey(c);if(a.isIntersecting)a=l.setTimeout(function(){var a=f.childElems.indexOf(c);f.callback(a,f.itemsToBeObserved[a]);delete f.viewTimeout[d]},
1E3),f.viewTimeout[d]=a;else if(a=f.viewTimeout[d])l.clearTimeout(a),delete f.viewTimeout[d]}else a.isIntersecting&&(a=f.childElems.indexOf(a.target),f.callback(a,f.itemsToBeObserved[a]))})};this.disconnectObserver=function(){f.intersectionObserver.disconnect()};c===u&&(c=null);this.callback=b;this.parentEle=c;if(this.itemsToBeObserved=a)this.childElems=Array.prototype.slice.call(a),this.options={root:this.parentEle,rootMargin:"0px",threshold:.5},this.viewTimeout={},this.intersectionObserver=new IntersectionObserver(function(a){return f.onIntersectionObserved(a,
d)},this.options),this.childElems.forEach(function(a){f.intersectionObserver.observe(a)})}d.prototype.getElementUniqueKey=function(c){return c.id||c.outerHTML};return d}(),f=function(){function d(){}d.PLAYER_INITIALIZED="vse-player-initialized";d.LB_OPENED="vse-lb-opened";d.PLAYER_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-player-failed-to-render-no-pagestate";d.LAZY_LOAD_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-lazyload-failed-to-render-no-pagestate";d.RV_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-rv-failed-to-render-no-pagestate";
d.INGRESS_RV_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-ingress-failed-to-render-no-pagestate";d.FEEDBACK_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-feedback-failed-to-render-no-pagestate";d.METADATA_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-metadata-failed-to-render-no-pagestate";d.SOCIAL_SHARE_STATE_NOT_FOUND_ERROR_KEY="vse-social-share-failed-to-render-no-pagestate";d.RELATED_PRODUCT_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-related-product-failed-to-render-no-pagestate";d.LB_POPOVER_NOT_FOUND_ERROR_KEY="vse-lb-failed-to-render-no-popover";
d.VISIBLE_DIV_NARROW_PREFIX="vse-pc-visible-narrow-";d.PC_HIDDEN_CACHE_DIV_PREFIX="vse-pc-hidden-cache-";d.AJAX_MAX_RETRY_COUNT=3;d.CLICK_ATTRIBUTION_INITIAL_DELAY=2;d.VAP_EW="/vap/ew/";d.RELATED_PRODUCTS_ENDPOINT="subcomponent/relatedproducts/";d.PUI_RELATED_PRODUCTS_ENDPOINT="subcomponent/puirelatedproducts/";d.WEBLAB_TRIGGER_ENDPOINT="weblabtrigger/batch/v2";d.EMPTY_STRING="";d.PORTRAIT="portrait";d.LANDSCAPE="landscape";d.SQUARE="square";d.PORTRAIT_ASPECT_RATIO="9:16";d.LANDSCAPE_ASPECT_RATIO=
"16:9";d.SQUARE_ASPECT_RATIO="1:1";d.IS_VIDEO_IMMERSIVE_PLAYER_KEY="isVideoImmersivePlayer";d.SHOW_CONTENT_CAROUSEL="showContentCarousel";d.COMMA=",";d.SEMICOLON=";";d.INGRESS_CAROUSEL_SUFFIX="-vse-related-videos";d.ENGLISH="english";d.HINDI="hindi";d.VFTP_HERO_CARD="vftphero";d.COMPLEMENTARY_ASIN="complementaryAsin";d.LANDING_ASIN="landingAsin";d.SPONSORED_ASIN="sponsored";d.videoInformationContainer=".vse-lb-video-metadata";d.videoTitle=d.videoInformationContainer+" .vse-content-title";d.vendorName=
d.videoInformationContainer+" .vse-video-author";d.videoAge=d.videoInformationContainer+" .ive-video-age";d.followButton=".vse-follow-button .amazon-follow-v3";d.vseFollowClass=".vse-follow-button";d.ccvDisclosureMessage=".ive-cross-country-disclosure-message";d.creatorAndDisclosure=".vse-creator-name-and-disclosure";d.ibVideoOspDisclosure=d.videoInformationContainer+" .vse-oap-disclosure-container";d.ibVideoAiDisclosure=d.videoInformationContainer+" .vse-aip-disclosure-container";d.verifiedPurchaseLabel=
".ive-verified-purchase-label";d.verifiedPurchaseLabelDivider=".ive-verified-label-name-divider";d.socialShareClickMetricName="vseSocialShareClickImageBlock";d.relatedEnglishVideosContainer="vse-related-english-videos-carousel-container";d.relatedHindiVideosContainer="vse-related-hindi-videos-carousel-container";d.vernacLanguageRadioBlockSelector=".vse-carousel-vernac-language-radio-button-container";d.RELATED_PRODUCTS_INNER_CONTAINER=".vse-rp-container";d.RELATED_PRODUCTS_INNER_CLASS_NAME="vse-rp-container";
d.CACHE_RP_PAYLOAD_HIDDEN_DIV_CONTAINER=".vse-related-products-cache-hidden";d.HERO_WIDGET_CONTAINER=".vse-hero-widget";d.CACHE_RP_PAYLOAD_HIDDEN_DIV_CARDS_CONTAINER="vse-placeholder-related-products-config";d.RELATED_PRODUCTS_CONTAINER_SELECTOR=".vse-related-products-narrow";d.HAS_PUI_SELECTOR=".has-pui";d.RELATED_PRODUCTS_CAROUSEL_ELEMENT=".vse-product-carousel-element";d.RELATED_PRODUCTS_ITEM_SELECTOR=".vse-product-item";d.ATTRIBUTION_NAME="vse-component-assets";d.LB_CAROUSEL_CONFIG='div[class^\x3d"div-"][class$\x3d"-vip-relatedvideos"]';
d.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME="vse-close-button-on-player";d.TABLET_LIGHTBOX_CLASS_NAME="vse-tablet-popover";d.ATTR_ORIGINAL_HREF="data-og-href";d.ActionContainerSelector=".vse-lb-actions-container";d.CRVInfoSelector=".vse-crv-info";d.MetadataWrapperSelector=".vse-active-metadata-wrapper";d.ActiveMetadataSelector=".vse-active-metadata";d.PUI_WRAPPER_ELEMENT=".pui-wrapper";d.reportDefaultMessageSelector=".vse-fb-description";d.reportIllegalMessageSelector=".vse-fb-description-eu";d.reportIllegalLinkSelector=
".vse-fb-report-illegal-content";d.SHOP_THE_VIDEO_WEBLAB="ASV_SHOP_THE_VIDEO_1149841";d.HOTSPOTS_V2_WEBLAB="ASV_IVX_PLAYER_HOTSPOTS_V2_1170947";d.NEW_LIGHTBOX_V2="ASV_NEW_LIGHTBOX_DESKTOP_1210693";d.AUI_POPOVER_INNER=".a-popover-inner";d.IVE_THEME=".ive-immersive-bounds";d.VIPSelector=".vse-vip";d.VIPLightboxSelector=".vse-vip-lightbox";d.LightboxWrapperSelector=".vse-lightbox-wrapper";d.PlayerContainerSelector=".vse-player-container";d.VIPOverlaySelector=".vse-vip-overlay";d.VIPActionOverlaySelector=
".vse-vip-actions-overlay";d.VIPLbTabsAndCarouselOverlaySelector=".vse-vip-lb-tabs-carousel-container-overlay";d.VIPLbCarouselSelector=".vse-vip-lb-carousel-container";d.VIPProductCarouselOverlaySelector=".vse-pc-container-overlay";d.VIPLbTabsAndCarouselContainerSelector=".vse-vip-lb-tabs-carousel-container";d.VIPProductCarouselOverlayContainerSelector=".vse-pc-container";d.VIPShopIconBlockSelector=".vse-vip-shop";d.VIPShopIconSelector=".vse-vip-shop-icon";d.VIPWatchIconSelector=".vse-vip-watch-icon";
d.VIPWatchIconBlockSelector=".vse-vip-watch";d.VIPShareIconBlockSelector=".vse-vip-share";d.VIPShareIconSelector=".vse-vip-share-icon";d.VIPActionIconSelector=".vse-vip-action-icon";d.VIPEmptyRelatedProductsContainerSelector=".vse-related-products-mobile-empty";d.VIPLbTabsContainerSelector=".vse-vip-lb-tabs";d.VIPLbCarouselViewportSelector=".vse-vip-lb-carousel .a-carousel-viewport";d.VerticalCarouselScrollableElement=".vse-lb-right";d.VIPSkipBackButtonSelector=".vse-vip-skip-backward-button";d.VIPSkipForwardButtonSelector=
".vse-vip-skip-forward-button";d.VIPPlayPauseToggleSelector=".vse-vip-play-pause-toggle";d.VIPProgressBarSelector=".vse-vip-scrubber-bar";d.VIPProgressBarFillSelector=".vse-vip-scrubber-bar-fill";d.VIPTimeRemainingSelector=".vse-vip-time-remaining-display";d.VIPProductCarouselViewportSelector=".vse-pc-container .a-carousel-viewport";d.VIPSeeMoreBlockSelector=".vse-vip-see-more";d.VIPSeeMoreLinkSelector=".vse-vip-see-more-link";d.VIPSeeMoreTextSelector=".vse-vip-see-more-text";d.VIPCloseButton=".vse-close-button";
d.VIPPlayPauseContainerSelector=".vse-vip-play-pause-dummy-container";d.VIPSearchButtonSelector=".ive-search-button";d.VIPSearchButtonHideText="hide-text";d.VisualSearchMetricPrefix="ive:visual:search:";d.VisualSearchOverlaySelector=".hotspots-overlay-container";d.VisualSearchPFOSheetSelector=".ive-bottom-sheet-pfo-grid";d.VisualSearchPFOArrowSelector=".ive-pfo-sheet-arrow-wrapper";d.VisualSearchPFOHandleSelector=".ive-pfo-sheet-handle";d.VisualSearchPFOFindingProductsText=".ive-pfo-bottom-sheet-finding-text";
d.VisualSearchPFOFailureMessageSection=".ive-pfo-failure-section";d.VisualSearchPFOSingleHotSpotFailureInstructionText=".ive-pfo-single-hotspot-failure-instruction-text";d.VisualSearchPFOAllHotSpotsFailureInstructionText=".ive-pfo-all-hotspots-failure-instruction-text";d.VisualSearchPFOFoundProductsText=".ive-pfo-bottom-sheet-found-text";d.VisualSearchPFOFindProductsContent=".ive-bottom-sheet-content";d.VisualSearchPFOCloseSheetArrow=".ive-pfo-sheet-arrow";d.VisualSearchAmazonLensLogo=".ive-amazon-lens-logo-container";
d.VisualSearchBackButton=".ive-back-button";d.VisualSearchBBXCanvasSelector=".bbx-canvas";d.VisualSearchTooltipText=".ive-search-tooltip-text";d.IVECustomerReviewVideosToolTipText=".ive-customer-tooltip-text";d.CUSTOMER_REVIEW_TOOLTIP_TEXT_ID="#ive-crv-tooltip";d.CUSTOMER_REVIEW_TOOLTIP_TEXT="ive_crv_timestamp";d.productAsinAttributeSelector="data-dib-asin";d.addToCartMetricSuffix="addToCart";d.seeMoreMetricSuffix="seeOptions";d.productAsinMetricSuffix="productAsin";d.addToCartClickSelector=".puis-atcb-add-container";
d.seeOptionsClickSelector=".puis-see-details-content";d.productAsinClickSelector='span[data-csa-c-func-deps\x3d"aui-da-detail-page-link-tap"]';d.colorSwatchClickSelector='span[data-component-type\x3d"s-color-swatch"]';d.detailPageLinkJsonKey="detailPageLink";d.puiRelatedProductAsinSelector='span[data-csa-c-func-deps\x3d"aui-da-puis-card-container-declarative"]';d.puiStarRatingSelector='i[data-cy\x3d"reviews-ratings-slot"]';d.pfoRelatedProductSelector="div[data-asin]";d.VIPCCButtonSelector=".vse-vip-custom-cc-button";
d.VIPCCTooltipSelector=".vse-vip-cc-tooltip";d.VIPCCTooltipTextSelector=".vse-vip-cc-tooltip-text";d.VIPCCTextTrackSelector=".vjs-text-track-display";d.defaultPlayerCCButtonTitleSelector=".vjs-subs-caps-button.vjs-menu-button \x3e button";d.LabelNameSelector=".ive-player-label-name";d.LabelTooltipSelector=".ive-player-label-tooltip";d.CCVContainerSelector=".ive-cross-country-disclosure";d.CCVCloseButton="ive-ccv-disclosure-sheet-close";d.CCVBottomSheetTrigger=".ive-ccv-bottom-sheet-trigger";d.AUISheetCloseButtonSelector=
".a-sheet-close";d.VIPMuteUnmuteSelector=".ive-vip-custom-mute_unmute-button";d.VIPVideoTitleSelector=".vse-video-title-ellipsis-wrapper";d.VIPReviewsAuthorProfileImageSelector=".vse-reviews-author-profile-image";d.VIPReviewsAuthorStarBadgesSelector=".vse-reviews-author-star-badges";d.VIPReviewsExpandableContentSelector=".vse-reviews-content-expand-container";d.VIPCRVTitle=".vse-crv-title";d.VIPReviewsMetadataSelectors=[d.VIPVideoTitleSelector,d.VIPReviewsAuthorProfileImageSelector,d.VIPReviewsAuthorStarBadgesSelector,
d.VIPReviewsExpandableContentSelector,d.CRVInfoSelector,d.VIPCRVTitle];d.VIPFeedbackContainer=".vse-fb-trigger-container";d.VIPMultiCarouselWrapper=".vse-vip-lb-multi-carousel-container-wrapper";d.VIPMultiCarouselOverlay=".vse-vip-lb-multi-carousel-container-overlay";d.VIPMultiCarouselContainer=".ive-vip-lb-carousel-container";d.VIPMultiCarouselOneContainer=".vse-vip-lb-first-carousel-container";d.VIPMultiCarouselTwoContainer=".vse-vip-lb-second-carousel-container";d.VIPMultiCarouselOneCarousel=".vse-vip-lb-first-carousel-container .a-carousel-viewport";
d.VIPMultiCarouselTwoCarousel=".vse-vip-lb-second-carousel-container .a-carousel-viewport";d.VIPMultiCarouselExpandedClass="vse-vip-multi-carousel-expanded";d.G1="G1";d.G2="G2";d.VIPPlayIconClassName="vse-vip-play-icon";d.VIPPauseIconClassName="vse-vip-pause-icon";d.VIPLbOverlayShowCssClassName="vse-lb-tabs-overlay-show";d.VIPOverlayShowClassName="vse-overlay-show";d.VIPActionOverlayShowClassName="vse-vip-ao-show";d.VIPActionOverlayBgShadowClassName="vse-carousel-bg-animation";d.VIPMetadataClassName=
"vse-lb-video-metadata";d.VIPVideoInfoClassName="vse-video-info";d.VIPVideoAgeClassName="ive-video-age";d.VIPVideoHelpfulVotesClassName="vse-helpful-votes";d.VIPVideoTitleWrapperClassName="video-title-ellipsis-wrapper";d.VIPPlayPauseClassName="vse-vip-play-pause-forward-previous-btns-container";d.VIPScrubberClassName="vse-vip-controls";d.UpNextClassName="vse-up-next";d.UpNextVideoTitleClassName="vse-up-next-video-title";d.UpNextAuthorClassName="vse-up-next-author";d.UpNextCancelClassName="vse-up-next-cancel";
d.UpNextElementClassName="vse-upn-element";d.UpNextElementShownClassName="vse-upn-element-shown";d.CarouselHeader=".vse-vc-header";d.VIPMuteIconClassName="ive-mute";d.VIPUnmuteIconClassName="ive-unmute";d.ReviewTextExpandClassName="vse-reviews-expand-full-cr";d.CRVMetadataClassName="vse-crv-metadata-show";d.VIPCCButtonUnpressedClassName="vse-cc-unpressed";d.VIPCCButtonPressedClassName="vse-cc-pressed";d.VIPVideoCarouselOpenedClassName="vse-vip-video-carousel-opened";d.VIPProductCarouselOpenedClassName=
"vse-vip-product-carousel-opened";d.VIPReviewsOverlayVisibleClassName="vse-vip-reviews-overlay-visible";d.VIPLandscapeVideoClassName="vse-vip-landscape-video";d.METRIC_WIDGET_CLICK=":widget:click";d.METRIC_LIGHTBOX_OPEN="ive-lightbox-opened";d.METRIC_VIP_CLOSE="vip:close";d.METRIC_VIP_CLOSE_WITHOUT_PLAY="vip:close:without:play";d.METRIC_PLAY="vip:play:icon:click";d.METRIC_PORTRAIT_MODE="vip:portrait:mode:render";d.METRIC_LANDSCAPE_MODE="vip:landscape:mode:render";d.METRIC_PAUSE="vip:pause:icon:click";
d.METRIC_SKIP_FORWARD="vip:skip:forward:icon:click";d.METRIC_SKIP_BACK="vip:skip:back:icon:click";d.METRIC_SHOP_ICON_CLICK="vip:shop:icon:click";d.METRIC_SHOP_ICON_UNCLICK="vip:shop:icon:unclick";d.METRIC_WEBLAB_TRIGGER_SUCCESS="weblabtrigger:request:success";d.METRIC_WEBLAB_TRIGGER_FAILURE="weblabtrigger:request:failure";d.METRIC_PFO_CLICK="shop:pfo:click";d.METRIC_PFO_RENDER="shop:pfo:render";d.METRIC_PFO_IMPRESSION="shop:pfo:impression";d.METRIC_PUI_CLICK_PREFIX="shop:pfo";d.METRIC_WATCH_ICON=
"vip:watch:icon:click";d.METRIC_WATCH_HANDLE_CLICK="vip:watch:handle:click";d.METRIC_WATCH_THUMBNAIL_CLICK="vip:watch:thumbnail:click";d.METRIC_WATCH_THUMBNAIL_RENDER="vip:watch:thumbnail:render";d.METRIC_WATCH_THUMBNAIL_IMPRESSION="vip:watch:thumbnail:impression";d.METRIC_UPNEXT_THUMBNAIL_IMPRESSION="vip:watch:upNextThumbnail:impression";d.METRIC_SHARE_ICON="share:icon:click";d.METRIC_SHARE_SELECTION_CLICK="share:selection:click";d.AUTOPLAY_FALLBACK_EXECUTED="vse:autoplay:fallback";d.METRIC_HELPFUL_VOTES_IMPRESSION=
"videovote:icon:impression";d.METRIC_MORE_MENU_CLICK="moreMenu:icon:click";d.METRIC_MORE_MENU_IMPRESSION="moreMenu:icon:impression";d.METRIC_REPORT_CLICK="report:icon:click";d.METRIC_REPORT_SUBMIT="report:icon:submit";d.METRIC_OPEN_LIGHTBOX_EVENT_EXECUTION="vse:lightbox:open:duration";d.METRIC_LB_THUMBNAIL_CLICK="ive:lb:thumbnail:click";d.METRIC_LB_THUMBNAIL_IMPRESSION="ive:lb:thumbnail:impression";d.SINGLE_VIDEO_LB_CSS_CLASS="vse-single-video-lb";d.METRIC_LB_SHOW_MORE_BUTTON_CLICK="ive:lb:showMoreButton:click";
d.METRIC_LB_SHOW_MORE_BUTTON_IMPRESSION="ive:lb:showMoreButton:impression";d.AUDIO_UNAVAILABLE_OVERLAY="audio-unavailable-overlay";d.hideAfter=4E3;return d}(),da=u&&u.__assign||Object.assign||function(d){for(var c,a=1,b=arguments.length;a<b;a++){c=arguments[a];for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(d[g]=c[g])}return d},O=u&&u.__awaiter||function(d,c,a,b){return new (a||(a=Promise))(function(g,f){function k(a){try{n(b.next(a))}catch(c){f(c)}}function h(a){try{n(b["throw"](a))}catch(c){f(c)}}
function n(b){b.done?g(b.value):(new a(function(a){a(b.value)})).then(k,h)}n((b=b.apply(d,c||[])).next())})},P=u&&u.__generator||function(d,c){function a(a){return function(c){return b([a,c])}}function b(a){if(f)throw new TypeError("Generator is already executing.");for(;g;)try{if(f=1,k&&(h=k[a[0]&2?"return":a[0]?"throw":"next"])&&!(h=h.call(k,a[1])).done)return h;if(k=0,h)a=[0,h.value];switch(a[0]){case 0:case 1:h=a;break;case 4:return g.label++,{value:a[1],done:!1};case 5:g.label++;k=a[1];a=[0];
continue;case 7:a=g.ops.pop();g.trys.pop();continue;default:if(!(h=g.trys,h=0<h.length&&h[h.length-1])&&(6===a[0]||2===a[0])){g=0;continue}if(3===a[0]&&(!h||a[1]>h[0]&&a[1]<h[3]))g.label=a[1];else if(6===a[0]&&g.label<h[1])g.label=h[1],h=a;else if(h&&g.label<h[2])g.label=h[2],g.ops.push(a);else{h[2]&&g.ops.pop();g.trys.pop();continue}}a=c.call(d,g)}catch(b){a=[6,b],k=0}finally{f=h=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var g={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},
trys:[],ops:[]},f,k,h,n;return n={next:a(0),"throw":a(1),"return":a(2)},"function"===typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n},ea=function(){function d(c,a){var b=this;this.config=a;this.currentBoundingBoxes=[];this.firstTimeInitialize=!0;this.isMshop=!1;this.BORDER_OFFSET_PX=4;this.LANDSCAPE_VIDEO_FRAME_PADDING_TOP_PX=8;this.VIDEO_FRAME_VERTICAL_PADDING_PX=36;this.VIDEO_FRAME_HORIZONTAL_PADDING_PX=20;this.hideAfter=4E3;this.IVE_HOTSPOTS_COUNTER="ive_hotspots_counter";this.IVE_HOTSPOTS_TIMESTAMP=
"ive_hotspots_timestamp";this.SEARCH_BLINKING_STAR_ANIMATION=".ive-blinking-star-animation";this.SEARCH_TOOLTIP_TEXT_ID="#ive-search-tooltip-trigger";this.firstProductFaceoutCallForTheFrame=!0;this.handleSearchButtonInteractions=function(){try{b.$ivxWrapper=b.A.$("#"+b.templateId).closest(f.VIPSelector),b.config.A.$("#"+b.templateId+" "+f.VIPSearchButtonSelector).unbind("click"),b.config.A.$("#"+b.templateId+" "+f.VIPSearchButtonSelector).click(function(a){a.stopPropagation();a.stopImmediatePropagation();
b.pauseVideoIfPlaying();b.enterVisualSearchMode();b.currentVideoContentId=b.player.getCurrent().contentId;b.enableHotspotsForPausedFrame(b.currentVideoContentId);b.emitMetric(f.VisualSearchMetricPrefix+"searchButton:click")}),b.config.A.$("#"+b.templateId+" "+f.VisualSearchBackButton).unbind("click"),b.config.A.$("#"+b.templateId+" "+f.VisualSearchBackButton).click(function(a){a.stopPropagation();a.stopImmediatePropagation();b.isHotspotDisplay()||b.emitMetric(f.VisualSearchMetricPrefix+"visualsearch:exit:before:hotspot");
b.exitVisualSearchMode();b.emitMetric(f.VisualSearchMetricPrefix+"backButton:click")}),b.canvas=document.createElement("canvas"),b.A.$("#"+b.templateId+" video").length&&b.A.$("#"+b.templateId+" video").insertBefore(b.canvas),b.$bbXCanvas=b.A.$("#"+b.templateId+" "+f.VisualSearchBBXCanvasSelector),b.addOrientationChangeHandler(),b.updateIVXWrapperProperties(),b.setupPFOClickHandlers(),b.addSwipeUpDownHandler(),b.currentVideoContentId=b.player.getCurrent().contentId,b.emitMetric(f.VisualSearchMetricPrefix+
"searchButton:rendered")}catch(a){m.logError(f.ATTRIBUTION_NAME,"Visual search has failed",a),b.emitMetric(f.VisualSearchMetricPrefix+"failure")}};this.isHotspotDisplay=function(){return 0<b.A.$("#"+b.templateId+" "+f.VisualSearchBBXCanvasSelector+' span[id^\x3d"bbx-"]').length};this.enableHotspotsForPausedFrame=function(a){var c=y.fetchLatestPageState(b.A,b.clientPrefix+"-visual-search-ps");b.$blinkingStarAnimation=b.config.A.$("#"+b.templateId+" "+b.SEARCH_BLINKING_STAR_ANIMATION).detach();b.moveBlinkingStarAnimation("#"+
b.templateId+" "+f.VisualSearchOverlaySelector);b.A.delay(function(){b.showElement(f.VisualSearchOverlaySelector+" "+b.SEARCH_BLINKING_STAR_ANIMATION)},100);b.firstProductFaceoutCallForTheFrame=!0;b.displayVideoDimensions=b.calculateVideoDimensions();var d=b.getCurrentTime(),h={contentId:a,timestamp:Math.ceil(1E3*b.player.getCurrentTime()),marketplaceId:c.marketplaceId},n=function(a,c,d){m.logError(f.ATTRIBUTION_NAME,"/getHotspots request has failed",d);b.showPFOSheetErrorMessage(!1);b.$bbXCanvas.addClass("aok-hidden");
b.removeBlinkingStarAnimation();b.emitMetric(f.VisualSearchMetricPrefix+"gethotspots:request:failure")},t=function(a){b.sendLatencyMetric(d,"gethotspots:request:latency");b.emitMetric(f.VisualSearchMetricPrefix+"gethotspots:request:success");null===a||null===a.results||0===a.results.length?(b.$bbXCanvas.addClass("aok-hidden"),b.removeBlinkingStarAnimation(),b.emitMetric(f.VisualSearchMetricPrefix+"gethotspots:response:empty"),b.showPFOSheetErrorMessage(!1)):(b.currentBoundingBoxes=[],a.results.forEach(function(a){b.currentBoundingBoxes.push({blx:a.bounding_box.bottom_left_x,
bly:a.bounding_box.bottom_left_y,brx:a.bounding_box.bottom_right_x,bry:a.bounding_box.bottom_right_y,imh:a.bounding_box.image_height,imw:a.bounding_box.image_width,tlx:a.bounding_box.top_left_x,tly:a.bounding_box.top_left_y,trx:a.bounding_box.top_right_x,try:a.bounding_box.top_right_y,asins:a.asins,pfoHtml:a.pfoHtml,$bbX:a.$bbX})}),b.hidePFOSheetErrorMessage(),b.cleanupPreviousHotspots(),b.showHotspots())};c.isV2?(b.emitMetric(f.VisualSearchMetricPrefix+"v2:request"),b.captureBase64Img().then(function(a){h.base64Img=
a;b.makeRequest(c,h,t,n);b.emitMetric(f.VisualSearchMetricPrefix+"v2:request:success:base64img")})):(b.emitMetric(f.VisualSearchMetricPrefix+"v1:request"),b.makeRequest(c,h,t,n))};this.makeRequest=function(a,c,d,f){a={url:a.hotspotsEndpoint,data:JSON.stringify(c),type:"POST",contentType:"application/json; charset\x3dutf-8",crossDomain:!0,headers:{Authorization:"allow","x-api-key":a.hotspotsEndpointKey},error:f,success:d};b.A.$.ajax(a)};this.sendLatencyMetric=function(a,c){m.count(f.VisualSearchMetricPrefix+
c,b.getCurrentTime()-a)};this.getCurrentTime=function(){return performance?performance.now():Date.now()};this.moveBlinkingStarAnimation=function(a){b.$blinkingStarAnimation&&0<b.$blinkingStarAnimation.length&&b.$blinkingStarAnimation.appendTo(a)};this.removeBlinkingStarAnimation=function(){b.hideElement(f.VisualSearchOverlaySelector+" "+b.SEARCH_BLINKING_STAR_ANIMATION);b.moveBlinkingStarAnimation("#"+b.templateId+" "+f.VIPOverlaySelector)};this.showHotspots=function(){b.displayVideoDimensions=b.calculateVideoDimensions();
if(b.getDeviceOrientation()==f.LANDSCAPE)b.$bbXCanvas.css({width:b.displayVideoDimensions.width+"px",height:b.displayVideoDimensions.height+"px",left:(b.A.$(l).width()-b.displayVideoDimensions.width)/2+"px",top:b.LANDSCAPE_VIDEO_FRAME_PADDING_TOP_PX+"px"});else{var a=b.A.$("#"+b.templateId+" "+f.VisualSearchBackButton),a=parseFloat(a.css("top"))+a.outerHeight(),c=parseFloat(b.$pfoSheet.css("max-height")),d=parseFloat(b.A.$("#"+b.templateId).closest(".vse-vip-lb-mshop.vse-ivx-ios").css("padding-top"))||
0;b.$bbXCanvas.css({width:b.displayVideoDimensions.width+"px",height:b.displayVideoDimensions.height+"px",left:(b.A.$(l).width()-b.displayVideoDimensions.width)/2+"px",top:(l.innerHeight-d-c-b.displayVideoDimensions.height+a)/2+"px"})}b.captureVideoFrame().then(function(a){var c={height:b.displayVideoDimensions.height,width:b.displayVideoDimensions.width,ratio:1};b.getBoundingBoxCoordinates(c).map(function(d,g){var f=b.$bbXCanvas.find("#placeholder-bbx"),C=f.clone();C.attr("id","bbx-"+g);0===b.$bbXCanvas.find("#"+
C.attr("id")).length&&(b.appendHotspotsToFrame(d,C),b.addHotspotClickHandler(d,C,c,a));b.currentBoundingBoxes[g].$bbX=C;f.addClass("aok-hidden")});var d=b.$currentlyClickedbbX===u||null===b.$currentlyClickedbbX?0:b.currentBoundingBoxes.map(function(a){return a.$bbX.attr("id")}).indexOf(b.$currentlyClickedbbX.attr("id"));b.currentBoundingBoxes[d].$bbX.trigger("click",["forceClick"])})};this.showPFOSheet=function(){b.firstTimeInitialize&&(b.$pfoSheet=b.A.$("#"+b.templateId+" "+f.VisualSearchPFOSheetSelector),
b.$ivxWrapper.append(b.$pfoSheet),b.$pfoSheetContainer=b.$ivxWrapper.find(f.VisualSearchPFOSheetSelector),b.$ivxWrapper.delegate(f.VisualSearchPFOSheetSelector+".open","transitionend",function(){b.toggleFixedArrowClass(!0)}));b.$pfoSheet.addClass("loading");b.$pfoSheetContainer.find(f.VisualSearchPFOFindingProductsText).removeClass("aok-hidden");b.$pfoSheetContainer.find(f.VisualSearchPFOFoundProductsText).addClass("aok-hidden");b.$pfoSheetContainer.find(f.VisualSearchPFOFindProductsContent).addClass("aok-hidden");
b.$pfoSheetContainer.removeClass("aok-hidden");b.firstTimeInitialize=!1};this.hidePFOSheet=function(){b.$pfoSheetContainer=b.$ivxWrapper.find(f.VisualSearchPFOSheetSelector);b.$pfoSheetContainer.addClass("aok-hidden");b.$ivxWrapper.find(f.VisualSearchPFOHandleSelector).addClass("aok-hidden")};this.handlePFOClickMetric=function(a,c,d,h){void 0===h&&(h=!1);b.$ivxWrapper.delegate(a,"click",function(a){(a=b.getProductAsinForPUI(a,d))&&b.emitMetric(""+f.VisualSearchMetricPrefix+c+":click",a)})};this.setupPFOClickHandlers=
function(){b.handlePFOClickMetric(f.addToCartClickSelector,f.addToCartMetricSuffix,f.productAsinAttributeSelector);b.handlePFOClickMetric(f.seeOptionsClickSelector,f.seeMoreMetricSuffix,f.productAsinAttributeSelector);b.handlePFOClickMetric(f.productAsinClickSelector,f.productAsinMetricSuffix,f.productAsinAttributeSelector,!0);b.handlePFODetailPageRedirect()};this.handlePFODetailPageRedirect=function(){var a=[f.productAsinClickSelector,f.colorSwatchClickSelector,f.seeOptionsClickSelector].join(", ");
b.$ivxWrapper.delegate(a,"click",function(a){b.isPfoSheetOpened()?b.isMshop||(a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),(a=b.A.$(a.target).closest("a").attr("href"))&&l.open(a,"_blank")):(b.openPfoSheet(),a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation())})};this.findSimilarProducts=function(a){var c=b.getCurrentTime(),d=function(d){b.sendLatencyMetric(c,"getpuirelatedproducts:request:latency");b.findSimilarProductsSuccessCallback(a,d);!0===b.firstProductFaceoutCallForTheFrame&&
b.removeBlinkingStarAnimation();b.firstProductFaceoutCallForTheFrame=!1},h={productList:a.asins,metadata:{layout:"grid"}},n=3,m=function(a){(0===a.http.status||500<=a.http.status&&599>=a.http.status)&&0<n?(z.sendRequest(b.A,""+f.VAP_EW+f.PUI_RELATED_PRODUCTS_ENDPOINT,h,d,m),n--):(b.showPFOSheetErrorMessage(!0),b.removeBlinkingStarAnimation(),b.emitMetric(f.VisualSearchMetricPrefix+"getpuirelatedproducts:request:failure"))};b.showPFOSheet();z.sendRequest(b.A,""+f.VAP_EW+f.PUI_RELATED_PRODUCTS_ENDPOINT,
h,d,m)};this.findSimilarProductsSuccessCallback=function(a,c){var d=b.$pfoSheetContainer.find(f.VisualSearchPFOFindProductsContent);d.toggleClass("aok-hidden",!1);d.animate({left:"-100%"},300,function(){d.html(c);d.css({left:"100%"});d.animate({left:"0%"},300)});a.pfoHtml=c;a.$bbX&&(b.currentBoundingBoxes.filter(function(b){return b.$bbX[0].id==a.$bbX[0].id})[0].pfoHtml=c);b.hidePFOSheetErrorMessage();b.$pfoSheetContainer.find(f.VisualSearchPFOFindingProductsText).toggleClass("aok-hidden",!0);b.$pfoSheetContainer.find(f.VisualSearchPFOFoundProductsText).removeClass("aok-hidden");
b.$pfoHandle=b.$pfoSheetContainer.find(f.VisualSearchPFOHandleSelector);b.$pfoHandle.length?b.$ivxWrapper.append(b.$pfoHandle):b.$pfoHandle=b.$ivxWrapper.find(f.VisualSearchPFOHandleSelector);b.isInVisualSearchMode()?(b.$pfoHandle.removeClass("aok-hidden"),b.$pfoHandle.unbind("click"),b.$pfoSheet.removeClass("loading"),b.$pfoHandle.click(b.openPfoSheetIfClosed),b.$pfoSheet.unbind("click"),b.$pfoSheet.click(function(a){b.A.$(a.target).closest(f.productAsinClickSelector).length||b.openPfoSheetIfClosed()})):
b.emitMetric(f.VisualSearchMetricPrefix+"visualsearch:exit:before:pfo")};this.openPfoSheetIfClosed=function(){b.isPfoSheetOpened()||b.openPfoSheet()};this.isPfoSheetOpened=function(){return b.$pfoSheetContainer.hasClass("open")};this.addSwipeUpDownHandler=function(){b.$ivxWrapper.undelegate(f.VisualSearchPFOSheetSelector,"touchend");b.$ivxWrapper.delegate(f.VisualSearchPFOSheetSelector,"touchstart",function(a){var c=a.originalEvent.touches[0].clientY;b.$ivxWrapper.delegate(f.VisualSearchPFOSheetSelector,
"touchmove",function(a){a=c-a.originalEvent.touches[0].clientY;b.$ivxWrapper.undelegate(f.VisualSearchPFOSheetSelector,"touchmove");1<Math.abs(a)&&(0<a?b.openPfoSheetIfClosed():(a=b.A.$(f.VisualSearchPFOFindProductsContent).offset().top,b.isPfoSheetOpened()&&a>(b.isMshop?100:50)&&a<(b.isMshop?200:100)&&b.closePfoSheet()))});b.$ivxWrapper.delegate(f.VisualSearchPFOSheetSelector,"touchend",function(){b.$ivxWrapper.undelegate(f.VisualSearchPFOSheetSelector,"touchmove touchend")})})};this.openPfoSheet=
function(){b.$pfoHandle.length&&b.$pfoHandle.addClass("aok-hidden");b.$pfoSheetContainer.addClass("open");var a=b.$pfoSheetContainer.find(f.VisualSearchPFOCloseSheetArrow);a.unbind("click");a.click(function(a){a.preventDefault();a.stopPropagation();b.closePfoSheet()});b.emitMetric(f.VisualSearchMetricPrefix+"pfoSheet:open")};this.closePfoSheet=function(){b.$pfoSheetContainer.removeClass("open");b.toggleFixedArrowClass(!1);b.$pfoHandle.removeClass("aok-hidden")};this.showPFOSheetErrorMessage=function(a){b.$pfoSheetContainer=
b.$ivxWrapper.find(f.VisualSearchPFOSheetSelector);var c=b.$pfoSheetContainer.find(f.VisualSearchPFOFailureMessageSection),d=b.$pfoSheetContainer.find(f.VisualSearchPFOSingleHotSpotFailureInstructionText),h=b.$pfoSheetContainer.find(f.VisualSearchPFOAllHotSpotsFailureInstructionText),n=b.$pfoSheetContainer.find(f.VisualSearchPFOFindingProductsText),m=b.$pfoSheetContainer.find(f.VisualSearchPFOFoundProductsText),e=b.$pfoSheetContainer.find(f.VisualSearchPFOFindProductsContent);c.toggleClass("aok-hidden",
!1);n.toggleClass("aok-hidden",!0);a?(d.toggleClass("aok-hidden",!1),m.toggleClass("aok-hidden",!0),e.toggleClass("aok-hidden",!0)):(b.$pfoSheetContainer.toggleClass("loading",!1),b.$pfoSheetContainer.toggleClass("no-hotspot-error",!0),h.toggleClass("aok-hidden",!1))};this.hidePFOSheetErrorMessage=function(){b.$pfoSheetContainer=b.$ivxWrapper.find(f.VisualSearchPFOSheetSelector);var a=b.$pfoSheetContainer.find(f.VisualSearchPFOFailureMessageSection),c=b.$pfoSheetContainer.find(f.VisualSearchPFOSingleHotSpotFailureInstructionText),
d=b.$pfoSheetContainer.find(f.VisualSearchPFOAllHotSpotsFailureInstructionText);a.toggleClass("aok-hidden",!0);c.toggleClass("aok-hidden",!0);d.toggleClass("aok-hidden",!0);b.$pfoSheetContainer.toggleClass("no-hotspot-error",!1)};this.cleanupPreviousHotspots=function(){if(b.$bbXCanvas){var a=b.$bbXCanvas.find('span[id^\x3d"bbx-"]');a.length&&a.remove()}};this.showCanvas=function(){b.$bbXCanvas.removeClass("aok-hidden")};this.pauseVideoIfPlaying=function(){b.player.isPlaying()&&b.config.A.$("#"+b.templateId+
" "+f.VIPPlayPauseToggleSelector).click();b.config.A.$("#"+b.templateId+" ."+f.UpNextClassName).hasClass(""+f.UpNextElementShownClassName)&&b.config.A.$("#"+b.templateId+" ."+f.UpNextCancelClassName).click()};this.enterVisualSearchMode=function(){b.config.A.$("#"+b.templateId+" ."+f.VIPPlayPauseClassName).addClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPOverlaySelector).addClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPActionOverlaySelector).addClass("aok-hidden");b.A.$("#"+b.templateId).closest(".a-popover-inner").css({"background-color":"black"});
b.A.$("#"+b.templateId+" "+f.VIPSearchButtonSelector).addClass("aok-hidden");b.config.A.$("#"+b.templateId).closest(".vse-vip-lightbox").addClass("ive-visual-search");b.A.$("#"+b.templateId+" "+f.VIPCloseButton).addClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VisualSearchBackButton).removeClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPCCTextTrackSelector).toggleClass("aok-hidden",!0);b.A.$(""+f.IVE_THEME).addClass("aok-hidden");b.$bbXCanvas.removeClass("aok-hidden");b.getDeviceOrientation()==
f.PORTRAIT&&b.A.$("#"+b.templateId+" "+f.VisualSearchAmazonLensLogo).removeClass("aok-hidden");b.showPFOSheet();b.shrinkVideoFrame()};this.exitVisualSearchMode=function(){b.config.A.$("#"+b.templateId).removeClass("ive-visual-search");b.A.$("#"+b.templateId+" "+f.VisualSearchAmazonLensLogo).toggleClass("aok-hidden",!0);b.A.$("#"+b.templateId+" "+f.VisualSearchBackButton).addClass("aok-hidden");b.config.A.$("#"+b.templateId+" ."+f.VIPPlayPauseClassName).removeClass("aok-hidden");b.A.$("#"+b.templateId+
" "+f.VIPOverlaySelector).removeClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPOverlaySelector).toggleClass(f.VIPOverlayShowClassName,!0);b.A.$("#"+b.templateId+" "+f.VIPActionOverlaySelector).removeClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPSearchButtonSelector).removeClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPSearchButtonSelector).toggleClass(f.VIPSearchButtonHideText,!1);b.config.A.$("#"+b.templateId).closest(".vse-vip-lightbox").removeClass("ive-visual-search");b.A.$("#"+
b.templateId+" "+f.VIPCloseButton).removeClass("aok-hidden");b.A.$(""+f.IVE_THEME).removeClass("aok-hidden");b.$bbXCanvas.addClass("aok-hidden");b.A.$("#"+b.templateId+" "+f.VIPCCTextTrackSelector).toggleClass("aok-hidden",!1);b.hidePFOSheet();b.restoreVideoFrame();b.cleanupPreviousHotspots();b.$pfoSheetContainer.removeClass("open");b.toggleFixedArrowClass(!1);b.removeBlinkingStarAnimation();b.$currentlyClickedbbX=null};this.shrinkVideoFrame=function(){var a=b.A.$("#"+b.templateId+" "+f.VisualSearchBackButton),
c=b.A.$("#"+b.templateId+" "+f.PlayerContainerSelector),d=parseFloat(b.$pfoSheet.css("max-height"));if(b.getDeviceOrientation()==f.LANDSCAPE)c.css({"padding-top":b.LANDSCAPE_VIDEO_FRAME_PADDING_TOP_PX+"px","padding-bottom":d+b.VIDEO_FRAME_VERTICAL_PADDING_PX+"px","padding-left":0,"padding-right":0});else{var a=a.offset().top+a.outerHeight(),h=b.A.$("#"+b.templateId+" .vse-vip-action-tray").outerHeight();c.css({"padding-top":a+b.VIDEO_FRAME_VERTICAL_PADDING_PX+"px","padding-bottom":d+b.VIDEO_FRAME_VERTICAL_PADDING_PX-
h+"px","padding-left":b.VIDEO_FRAME_HORIZONTAL_PADDING_PX+"px","padding-right":b.VIDEO_FRAME_HORIZONTAL_PADDING_PX+"px"})}};this.restoreVideoFrame=function(){var a=b.A.$("#"+b.templateId+" "+f.PlayerContainerSelector);if(b.getDeviceOrientation()==f.LANDSCAPE){var c=b.A.$("#"+b.templateId+" "+f.VIPActionIconSelector).outerWidth();a.css({"padding-top":0,"padding-bottom":0,"padding-left":0,"padding-right":c+"px"})}else a.css({padding:0})};this.appendHotspotsToFrame=function(a,c){c.removeClass("aok-hidden");
b.$bbXCanvas.append(c);c.find(".bbx-dot").css({left:a.x+"px",top:a.y+"px",display:"inline-block"})};this.addHotspotClickHandler=function(a,c,d,h){c.click(function(n,m){b.$currentlyClickedbbX=c;"none"!==c.find(".bbx-dot").css("display")&&(b.currentBoundingBoxes.map(function(a){return a.$bbX}).forEach(function(a){a.find(".bbx-dot").show()}),c.find(".bbx-dot").hide(),b.currentBoundingBoxes.map(function(a){return a.$bbX}).forEach(function(a){a.find(".bbx-canvas-image").addClass("aok-hidden");a.find(".bbx-canvas-image-border").addClass("aok-hidden")}),
n=da({},a,{top:a.top+b.BORDER_OFFSET_PX,bottom:a.bottom+b.BORDER_OFFSET_PX,left:a.left+b.BORDER_OFFSET_PX,right:a.right+b.BORDER_OFFSET_PX}),n=b.createClipStyle({bbx:n,imageDimensions:d,videoFrameUrl:h,borderRadiusPx:9}),b.applyClipPathProperties(c.find(".bbx-canvas-image"),n,!1),n=b.createClipStyle({bbx:a,imageDimensions:d,videoFrameUrl:h,borderRadiusPx:12}),b.applyClipPathProperties(c.find(".bbx-canvas-image-border"),n,!0),a.pfoHtml===u||null===a.pfoHtml?b.findSimilarProducts(a):b.findSimilarProductsSuccessCallback(a,
a.pfoHtml),m===u&&b.emitMetric(f.VisualSearchMetricPrefix+"hotspot:click"))})};this.applyClipPathProperties=function(a,b,c){a.removeClass("aok-hidden").css({left:b.left+"px",top:0,"clip-path":b.clipPath,"-webkit-clip-path":b.clipPath,height:b.height+"px",width:b.width+"px","transform-origin":b.transformOrigin,"-webkit-transform-origin":b.transformOrigin,"background-image":c?"":b.backgroundImage,"background-color":"#FFFFFF"})};this.captureVideoFrame=function(){return O(b,void 0,void 0,function(){var a;
return P(this,function(b){switch(b.label){case 0:return this.createCanvas(),[4,this.getImageUrl(this.canvas)];case 1:return a=b.sent(),[2,a]}})})};this.createCanvas=function(){b.canvas.width=b.displayVideoDimensions.width;b.canvas.height=b.displayVideoDimensions.height;var a=b.canvas.getContext("2d"),c=document.getElementById(b.A.$("#"+b.templateId+" video").attr("id"));a.drawImage(c,0,0,b.displayVideoDimensions.width,b.displayVideoDimensions.height)};this.captureBase64Img=function(){return O(b,void 0,
void 0,function(){return P(this,function(a){switch(a.label){case 0:return[4,this.getImageUrl(this.canvas,!0)];case 1:return[2,a.sent()]}})})};this.getImageUrl=function(a,c){void 0===c&&(c=!1);return O(b,void 0,void 0,function(){var b=this;return P(this,function(d){return[2,new Promise(function(d,h){try{if(c)try{b.createCanvas();var e=a.toDataURL("image/png");d(e)}catch(m){b.emitMetric(f.VisualSearchMetricPrefix+"base64:capture:frame:failure"),a.toBlob(function(a){if(a){var b=new FileReader;b.onloadend=
function(){d(b.result)};b.readAsDataURL(a)}else h("Cannot create base64 image from video frame")},"image/png")}else a.toBlob(function(a){a?(a=URL.createObjectURL(a),d(a)):(b.emitMetric(f.VisualSearchMetricPrefix+"capture:frame:failure"),h("Cannot create image url from video frame"))},"image/png")}catch(m){h(m.toString())}})]})})};this.createClipStyle=function(a){var b=a.bbx,c=a.imageDimensions;return{left:0,top:0,clipPath:"inset("+b.top+"px "+b.right+"px "+b.bottom+"px "+b.left+"px round "+a.borderRadiusPx+
"px)",height:c.height*c.ratio,width:c.width*c.ratio,backgroundImage:"url("+a.videoFrameUrl+")",transformOrigin:b.x+"px "+b.y+"px"}};this.getBoundingBoxCoordinates=function(a){var c=[],d=a.height,f=a.width,n=a.ratio;b.currentBoundingBoxes.forEach(function(a){var b=a.tlx/a.imw*f,g=a.trx/a.imw*f,q=a.tly/a.imh*d,m=a.bly/a.imh*d;a={x:n*((g-b)/2+b),y:n*((m-q)/2+q),h:n*(m-q),w:n*(g-b),sX:l.innerWidth/2-n*f/2+n*b,sY:n*q,asins:a.asins,pfoHtml:a.pfoHtml,$bbX:a.$bbX};c.push(da({},a,{top:a.sY,bottom:n*d-a.sY-
a.h,left:n*b,right:n*f-n*b-a.w}))});return c};this.calculateVideoDimensions=function(){var a=b.A.$("#"+b.templateId+" "+f.PlayerContainerSelector),c=a.width(),a=a.height(),d=b.player.player.playerInstance.videoJS,h=d.videoWidth(),d=d.videoHeight(),h=h/d;c/a>h?c=h*a:a=c/h;return{width:c,height:a,ratio:1}};this.emitMetric=function(a,c){m.count(a,1);a={eventName:b.clientPrefix+":"+a,stringPayload:c||f.EMPTY_STRING,intPayload:1,videoAsin:b.currentVideoContentId,timestamp:(new Date).toISOString()};b.emitMetricToNexus(a)};
this.addOrientationChangeHandler=function(){b.A.on.orientationchange(function(a){if(b.isInVisualSearchMode()){b.cleanupPreviousHotspots();b.A.$("#"+b.templateId+" "+f.VisualSearchAmazonLensLogo).toggleClass("aok-hidden",90===Math.abs(a.orientation));var c=function(){b.shrinkVideoFrame();b.showCanvas();b.showHotspots();b.updateIVXWrapperProperties()},d=function(){clearTimeout(h);c();b.$pfoSheet.get(0).removeEventListener("transitionend",d)},h=setTimeout(function(){c()},300);b.$pfoSheet.get(0).addEventListener("transitionend",
d)}else b.restoreVideoFrame()})};this.updateIVXWrapperProperties=function(){b.$ivxWrapper.css({"max-width":b.getDeviceOrientation()==f.LANDSCAPE?"unset":"100%",bottom:0})};this.executeTooltipForSearchButton=function(){v.now("a-tooltip").execute("ive-tooltip-registration",function(a){b.$trigger=b.A.$("#"+b.templateId+" "+b.SEARCH_TOOLTIP_TEXT_ID);b.tooltip=a;var c={name:"ive-tooltip-search-button",inlineContent:b.A.$("#"+b.templateId+" "+f.VisualSearchTooltipText).text(),dataStrategy:"preload"};b.instance=
a.create(b.$trigger,c);b.A.delay(function(){b.instance.show()},300);b.hideSearchTooltip(!1)})};this.hideSearchTooltip=function(a){b.instance&&(a?b.A.delay(function(){b.instance.hide();b.tooltip.remove(b.$trigger)},300):b.A.delay(function(){b.instance.hide();b.tooltip.remove(b.$trigger)},b.hideAfter),b.A.on("a:popover:visible:ive-tooltip-search-button",function(a){b.config.A.$(".a-tooltip-inner").addClass("ive-search-button-tooltip")}),b.A.on("a:popover:invisible:ive-tooltip-search-button",function(a){b.config.A.$(".a-tooltip-inner").removeClass("ive-search-button-tooltip")}))};
this.toggleFixedArrowClass=function(a){b.A.$(f.VisualSearchPFOArrowSelector+", "+f.VisualSearchPFOFoundProductsText).toggleClass("ive-fixed-arrow",a)};this.vipControlsShouldPause=c.vars.vipControlsShouldPause;this.templateId=a.templateId;this.player=c.vars.player;this.A=a.A;this.emitMetricToNexus=c.emitMetricToNexus;this.clientPrefix=c.vars.clientPrefix;this.getDeviceOrientation=c.getDeviceOrientation;this.getProductAsinForPUI=c.getProductAsinForPUI;this.isMshop=c.vars.isMshop;this.isDifferenceGreaterThan24Hours=
c.isDifferenceGreaterThan24Hours}d.prototype.addAnimationForHotspotsVideo=function(){var c=parseInt(localStorage.getItem(this.IVE_HOTSPOTS_COUNTER))||0,a=parseInt(localStorage.getItem(this.IVE_HOTSPOTS_TIMESTAMP))||0;this.shouldShowTooltipForSearchButton(c,a)&&this.executeTooltipForSearchButton()};d.prototype.shouldShowTooltipForSearchButton=function(c,a){return 1===c||this.isDifferenceGreaterThan24Hours(Date.now(),a)&&5>=c};d.prototype.updateEducationalRules=function(){var c=localStorage.getItem(this.IVE_HOTSPOTS_COUNTER);
if(null===c)localStorage.setItem(this.IVE_HOTSPOTS_COUNTER,"1"),localStorage.setItem(this.IVE_HOTSPOTS_TIMESTAMP,Date.now().toString()),this.executeTooltipForSearchButton();else if(5>=parseInt(c)){var a=localStorage.getItem(this.IVE_HOTSPOTS_TIMESTAMP),b=Date.now();localStorage.setItem(this.IVE_HOTSPOTS_COUNTER,(parseInt(c)+1).toString());a&&this.isDifferenceGreaterThan24Hours(b,parseInt(a))&&this.executeTooltipForSearchButton()}};d.prototype.hideElement=function(c){(c=this.config.A.$("#"+this.templateId+
" "+c))&&c.addClass("aok-hidden")};d.prototype.showElement=function(c){(c=this.config.A.$("#"+this.templateId+" "+c))&&c.removeClass("aok-hidden")};d.prototype.isInVisualSearchMode=function(){return this.config.A.$("#"+this.templateId).closest(".vse-vip-lightbox").hasClass("ive-visual-search")};return d}(),wa={BrilaFactory:W,VSEPlayer:T,BrilaShim:U,PlayerPromiseShim:V,GatedP:D,PostMetric:m,AuiUtils:y,EventEmitter:K,VideoVoteContainer:L,VideoVoteContainerFactory:M,ContentCarouselFactory:N,InvalidArgumentsException:H,
guid:I,RefTagRecorder:J,VSEDisplayStrategy:aa,VSETransitionStrategy:ba,OnSiteAttributionMetrics:Q,DelphiAttribution:R,MetricUtils:F,InlinePlayerComponent:ca,VideoItemIntersectionObserver:G,VisualSearchComponent:ea,ajaxRequestUtil:z},xa=function(){return function(d){var c=this;this.config=d;this.setOrientationConfig=function(a){c.orientationConfig=a};this.updateActiveVideoContentId=function(a){c.activeVideoContentId=a};this.triggerWatchIconInteractionOpen=function(){c.config.A.$("#"+c.templateId+" "+
f.VIPWatchIconSelector+".vse-unpressed").click()};this.triggerShopIconInteractionOpen=function(){c.config.A.$("#"+c.templateId+" "+f.VIPShopIconSelector+".vse-unpressed").click()};this.handleWatchIconInteractions=function(){c.config.A.$("#"+c.templateId+" "+f.VIPWatchIconSelector+".vse-unpressed").click(function(a){a.stopPropagation();a.stopImmediatePropagation();c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:open");a=function(){c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlaySelector).hide();
c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);c.toggleIconsState(!0,f.VIPWatchIconSelector);c.toggleIconsState(!1,f.VIPShopIconSelector);l.innerWidth>l.innerHeight&&c.config.A.$("#"+c.templateId+" "+f.VIPLbCarouselViewportSelector).height(l.innerHeight-c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsContainerSelector).outerHeight(!0));c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselOverlaySelector).addClass(f.VIPLbOverlayShowCssClassName);
c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselContainerSelector).removeClass(f.VIPActionOverlayBgShadowClassName);c.config.A.fadeIn(c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsContainerSelector),300,"linear");c.config.A.$("#"+c.templateId+" "+f.VIPLbCarouselSelector).animate(c.orientationConfig.carouselAnimationType,300,function(){c.lightboxCarousel.scrollToActiveVideo(c.lightboxCarousel.getActiveAsset())});c.config.A.$("#"+c.templateId+" .vjs-text-track-display").addClass(f.VIPVideoCarouselOpenedClassName)};
c.isDisplayed(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)?c.closeProductCarousel(a):a()})};this.handleMoreVideosIconInteractions=function(){c.config.A.$("#"+c.templateId+" "+f.VIPWatchIconSelector+".vse-unpressed").click(function(a){a.stopPropagation();a.stopImmediatePropagation();c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:open");a=function(){c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlaySelector).hide();c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);
c.toggleIconsState(!0,f.VIPWatchIconSelector);c.toggleIconsState(!1,f.VIPShopIconSelector);c.config.A.$("#"+c.templateId+" "+f.VIPOverlaySelector).addClass(f.VIPOverlayShowClassName);c.config.A.trigger("vse:ns:partialcomponents:"+c.config.clientPrefix+":ivx:overlay:show")};c.isDisplayed(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)?c.closeProductCarousel(a):a()})};this.handleShopIconInteractions=function(a){void 0===a&&(a=function(){});c.config.A.$("#"+c.templateId+" "+f.VIPShopIconSelector+".vse-unpressed").unbind("click");
c.config.A.$("#"+c.templateId+" "+f.VIPShopIconSelector+".vse-unpressed").click(function(b){b.stopPropagation();b.stopImmediatePropagation();c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:open");c.config.A.trigger("vse:"+c.templateId+":vip:shop:click");b=function(){c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselOverlaySelector).removeClass(f.VIPLbOverlayShowCssClassName);c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);
c.toggleIconsState(!0,f.VIPShopIconSelector);c.toggleIconsState(!1,f.VIPWatchIconSelector);c.config.A.$("#"+c.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).removeClass("aok-hidden");c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlaySelector).show();c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).removeClass(f.VIPActionOverlayBgShadowClassName);c.isDisplayed(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)||c.config.A.$("#"+c.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).animate(c.orientationConfig.carouselAnimationType,
300,a);c.config.A.$("#"+c.templateId+" .vjs-text-track-display").addClass(f.VIPProductCarouselOpenedClassName)};c.isDisplayed(f.VIPLbCarouselSelector)?c.closeVideoCarousel(b):c.throttleActionIcon||(c.throttleActionIcon=!0,b(),setTimeout(function(){return c.throttleActionIcon=!1},600))})};this.toggleIconsState=function(a,b){a?(c.config.A.$("#"+c.templateId+" "+b+".vse-unpressed").addClass("aok-hidden"),c.config.A.$("#"+c.templateId+" "+b+".vse-pressed").removeClass("aok-hidden")):(c.config.A.$("#"+
c.templateId+" "+b+".vse-unpressed").removeClass("aok-hidden"),c.config.A.$("#"+c.templateId+" "+b+".vse-pressed").addClass("aok-hidden"))};this.handleVIPCarouselClose=function(){[f.VIPLbCarouselSelector,f.VIPLbTabsContainerSelector,f.RELATED_PRODUCTS_CONTAINER_SELECTOR].forEach(function(a){c.config.A.$(c.config.A.$("#"+c.templateId+" "+a)).click(function(a){c.config.A.$(a.target).closest(f.RELATED_PRODUCTS_ITEM_SELECTOR).length||(a.stopPropagation(),a.stopImmediatePropagation())})});c.config.A.$("#"+
c.templateId+" "+f.VIPActionOverlaySelector).unbind("click");c.config.A.$("#"+c.templateId+" "+f.VIPActionOverlaySelector).click(function(){c.reset();c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:close")})};this.handleShareIconInteractions=function(){c.config.A.off("a:sheet:beforeShow:"+c.socialShareId+"-sheet");c.config.A.off("a:sheet:afterHide:"+c.socialShareId+"-sheet");c.config.A.on("a:sheet:beforeShow:"+c.socialShareId+"-sheet",function(){c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:open");
c.toggleIconsState(!0,f.VIPShareIconSelector)});c.config.A.on("a:sheet:afterHide:"+c.socialShareId+"-sheet",function(){c.config.A.trigger("vse:"+c.templateId+":vip:vat:component:close");c.toggleIconsState(!1,f.VIPShareIconSelector)})};this.reset=function(){c.throttleActionIcon||(c.throttleActionIcon=!0,setTimeout(function(){return c.throttleActionIcon=!1},600),c.unpressAllActionIcons(),c.isDisplayed(f.VIPLbCarouselSelector)&&c.closeVideoCarousel(function(){c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);
c.config.A.delay(function(){c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsAndCarouselOverlaySelector).removeClass(f.VIPLbOverlayShowCssClassName)},310)}),c.isDisplayed(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)&&c.closeProductCarousel(function(){c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);c.config.A.delay(function(){c.config.A.$("#"+c.templateId+" "+f.VIPProductCarouselOverlaySelector).hide()},310)}))};this.unpressAllActionIcons=
function(){c.config.A.$("#"+c.templateId+" "+f.VIPActionIconSelector+" .vse-pressed").addClass("aok-hidden");c.config.A.$("#"+c.templateId+" "+f.VIPActionIconSelector+" .vse-unpressed").removeClass("aok-hidden")};this.closeProductCarousel=function(a){c.config.A.$("#"+c.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).animate(c.orientationConfig.carouselAnimationType,300,a);c.config.A.$("#"+c.templateId+" .vjs-text-track-display").removeClass(f.VIPProductCarouselOpenedClassName)};this.closeVideoCarousel=
function(a){c.config.A.fadeOut(c.config.A.$("#"+c.templateId+" "+f.VIPLbTabsContainerSelector),300,"linear");c.config.A.$("#"+c.templateId+" "+f.VIPLbCarouselSelector).animate(c.orientationConfig.carouselAnimationType,300,a);c.config.A.$("#"+c.templateId+" .vjs-text-track-display").removeClass(f.VIPVideoCarouselOpenedClassName)};this.isDisplayed=function(a){return"block"==c.config.A.$("#"+c.templateId+" "+a).css("display")};this.lightboxCarousel=d.contentCarousel;this.socialShareId=d.socialShareId;
this.templateId=d.templateId}}(),fa=function(){function d(c){var a=this;this.A=c;this.makeApplicationNexusPayloadBuilder=function(a,c){return F.makeApplicationNexusPayloadBuilder(a,c)};this.detachExceptSkeleton=function(){return a.dom.$relatedProductContainer&&a.dom.$relatedProductContainer.children().not('[class*\x3d"skeletalPFO"], link').detach()};this.getCurrentlyPlayingVideoInCarousel=function(b){return-1===b?a.vars.currentAssetSpec:a.getCombinedPlaylist()[b]};this.getCurrentlyPlayingVideoInCarouselMarkAsPlaying=
function(b){b=a.getCurrentlyPlayingVideoInCarousel(b);a.markPlaying(b);return b};this.startPlaying=function(b){a.vars.isContinuousPlayFinished=!1;a.vars.player&&(b?a.vars.player.play(b):a.vars.player.play())};this.toggleVideoMetadataVisibilityForCRV=function(b){a.vars.isVideoImmersivePlayer?(a.dom.$lbContainer.find(""+f.ActiveMetadataSelector).toggleClass("aok-hidden",b),a.dom.$lbContainer.find("."+f.VIPVideoInfoClassName).toggleClass(f.CRVMetadataClassName,b)):a.dom.$lbLeftColumn.find(""+f.ActiveMetadataSelector).toggleClass("aok-hidden",
b)};this.updateMediaInfo=function(b){var c=a.dom.$lbVideoCarousel&&a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]').find(".vse-lb-crv-metadata");if(c){if(0<c.length){a.toggleVideoMetadataVisibilityForCRV(!0);a.dom.$activeCrvMetadataContainer.html(c.clone().removeClass("aok-hidden").html());a.vars.includeVideoInformationOverPlayer||a.dom.$activeCrvMetadataContainer.removeClass("aok-hidden");a.dom.$activeCrvMetadataContainer.find(".vse-crv-link").removeClass("aok-hidden");a.vars.showVotes&&
a.relatedVideosCarouselNotEmpty()?(a.updateActiveVideoVoteContainer(b),a.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0)):a.vars.activeVideoVoteContainer&&a.vars.activeVideoVoteContainer.showOrHide(!1,!1,!1,!1);a.vars.showUploadDate&&a.dom.$wrapper.find(f.videoAge).html(b.videoAge);a.vars.updateCRText=!0;a.vars.isVideoImmersivePlayer&&a.updateCRTextIfRequired();return}a.dom.$activeCrvMetadataContainer.addClass("aok-hidden").html("");a.toggleVideoMetadataVisibilityForCRV(!1)}a.updateBasicMediaInfo(b);
a.isCustomerReviewVideo(b)?(a.dom.$activeVideoTitlePrefix.removeClass("aok-hidden"),a.dom.$activeVideoCRLink.removeClass("aok-hidden"),a.dom.$activeVideoCRLinkWrapper.removeClass("aok-hidden")):(a.dom.$activeVideoTitlePrefix.addClass("aok-hidden"),a.dom.$activeVideoCRLink.addClass("aok-hidden"),a.dom.$activeVideoCRLinkWrapper.addClass("aok-hidden"));a.dom.$activeVideoCRLink.attr("href",b.referenceUrl||"");a.relatedVideosCarouselNotEmpty()&&(a.vars.showVotes=a.shouldShowVotes(b),a.vars.showVotes?(a.updateActiveVideoVoteContainer(b),
a.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0)):a.vars.activeVideoVoteContainer&&a.vars.activeVideoVoteContainer.showOrHide(!1,!1,!1,!1));a.isInfluencerVideo(b)?a.isOspEnabled(b)&&(a.dom.$wrapper.find(f.ibVideoOspDisclosure).addClass("aok-hidden"),a.dom.$wrapper.find(f.ibVideoAiDisclosure).removeClass("aok-hidden")):(a.isOspEnabled(b)?a.dom.$wrapper.find(f.ibVideoOspDisclosure).removeClass("aok-hidden"):a.dom.$wrapper.find(f.ibVideoOspDisclosure).addClass("aok-hidden"),a.dom.$wrapper.find(f.ibVideoAiDisclosure).addClass("aok-hidden"));
a.vars.shouldShowProfiles&&(a.isInfluencerVideo(b)?a.updateInfluencerProfile(b):a.updateCustomerProfile(b))};this.updateCustomerProfile=function(b){var c=-1==a.vars.currentIndex?a.vars.$(".vse-vdp-video-profile"):a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]').find(".vse-video-customer-profile");0<c.length?(a.dom.$activeVideoCustomerProfile.html(c.clone().removeClass("vse-hidden").html()),a.dom.$videoAuthorBlock.addClass("vse-hidden"),a.dom.$customerProfileContainer.removeClass("vse-no-cp"),
b.entityId?(a.dom.$vseOapDivider.addClass("vse-hidden"),a.dom.$creatorNameAndDisclosure.removeClass("vse-hidden")):(a.dom.$vseOapDivider.removeClass("vse-hidden"),a.dom.$creatorNameAndDisclosure.addClass("vse-hidden"))):(a.dom.$activeVideoCustomerProfile.html(""),a.dom.$customerProfileContainer.addClass("vse-no-cp"),a.dom.$wrapper.find(f.ibVideoOspDisclosure).find(f.creatorAndDisclosure).html(b.vendorName),b.entityId?(a.dom.$videoAuthorBlock.addClass("vse-hidden"),a.dom.$vseOapDivider.addClass("vse-hidden"),
a.dom.$creatorNameAndDisclosure.removeClass("vse-hidden")):(a.dom.$videoAuthorBlock.removeClass("vse-hidden"),a.dom.$vseOapDivider.removeClass("vse-hidden"),a.dom.$creatorNameAndDisclosure.addClass("vse-hidden")))};this.updateExpandWidgetOverlayText=function(b,c){try{var d=a.vars.auiTruncate.get(b),k=a.dom.$lbContainer.find(""+f.CRVInfoSelector);d&&d.getFullText()&&!k.hasClass("aok-hidden")&&(d.update(),d.getTruncatedText()===d.getFullText()?a.dom.$activeCrvMetadataContainer.find(c).hide():a.dom.$activeCrvMetadataContainer.find(c).show())}catch(h){m.logError(f.ATTRIBUTION_NAME,
"Cannot update CRV Text OverPlayer: "+a.vars.currentAssetSpec.contentId+", productAsin: "+a.vars.productAsin,h)}};this.setupExpandCollapseTextWidget=function(b){a.vars.truncateWidgetId="#"+a.vars.clientPrefix+"-truncate-widget";a.vars.expandButtonSelector="#"+a.vars.clientPrefix+"-ive-expand-button";a.vars.A.declarative(b,"click",function(){a.expandOrCollapseText(a.vars.auiTruncate.get(a.vars.truncateWidgetId))})};this.expandOrCollapseText=function(b){try{b._$cut.is(":visible")?(a.expandTruncatedText(b),
a.vars.$(a.vars.playerContainer).addClass("review-expanded"),a.pauseVideoIfNeeded()):(a.collapseToTruncateText(a.vars.auiTruncate.get(a.vars.truncateWidgetId)),a.vars.$(a.vars.playerContainer).removeClass("review-expanded"),a.vars.vipControlsShouldPause&&a.resumeVideoIfNeeded())}catch(c){m.logError(f.ATTRIBUTION_NAME,"Cannot expand/collapse: "+a.vars.currentAssetSpec.contentId+", productAsin: "+a.vars.productAsin,c)}};this.expandTruncatedText=function(b){try{b&&(a.showHideCRVTextExpandedView(!0),
b._$cut.hide(),b._$full.removeClass("a-offscreen"),b._$full.show(),b._$element.css("max-height","none"),b._$full.css("max-height",a.getMaxCRContainerHeight()+"px"),a.dom.$activeCrvMetadataContainer.find(".ive-txt-expander-btn").addClass("expanded"))}catch(c){m.logError(f.ATTRIBUTION_NAME,"Cannot expand: "+a.vars.currentAssetSpec.contentId+", productAsin: "+a.vars.productAsin,c)}};this.collapseToTruncateText=function(b){try{b&&(a.showHideCRVTextExpandedView(!1),b._$cut.show(),b._$full.hide(),b._$element.css("max-height",
b._$cut.height+"px"),a.dom.$activeCrvMetadataContainer.find(".ive-txt-expander-btn").removeClass("expanded"))}catch(c){m.logError(f.ATTRIBUTION_NAME,"Cannot collapse: "+a.vars.currentAssetSpec.contentId+", productAsin: "+a.vars.productAsin,c)}};this.showHideCRVTextExpandedView=function(b){a.vars.isVideoImmersivePlayer&&(a.dom.$lbContainer.find(""+f.VIPOverlaySelector).toggleClass(f.ReviewTextExpandClassName,b),a.dom.$lbContainer.find(""+f.MetadataWrapperSelector).toggleClass("aok-hidden",b),a.dom.$lbContainer.find("."+
f.UpNextClassName).toggleClass("aok-hidden",b),a.dom.$lbContainer.find(""+f.ActionContainerSelector).toggleClass("aok-hidden",b),a.dom.$lbContainer.find("."+f.VIPScrubberClassName).toggleClass("aok-hidden",b),a.dom.$lbContainer.find(""+f.VIPCCTextTrackSelector).toggleClass("aok-hidden",b),a.dom.$lbContainer.find(""+f.VIPPlayPauseContainerSelector).toggleClass("aok-hidden",b),a.dom.$lbContainer.find(""+f.VIPMultiCarouselWrapper).toggleClass("aok-hidden",b))};this.getMaxCRContainerHeight=function(){var b=
document.getElementById(a.vars.clientPrefix+"-truncate-widget");if(!b)return 0;b=b.getBoundingClientRect();if(a.vars.isVideoImmersivePlayer){var c=a.A.$("#"+a.vars.templateId+" "+f.VIPMultiCarouselWrapper),d=a.dom.$lbContainer[0].getBoundingClientRect(),c=c?c[0].getBoundingClientRect().height:0;return d.height-(b.top-d.top)-c-a.vars.CRV_TEXT_VERTICAL_PADDING_PX}if(d=document.getElementById(a.vars.containerId+"-container"))return d=d.getBoundingClientRect(),d.height-(b.top-d.top)-50};this.updateInfluencerProfile=
function(b){var c=-1==a.vars.currentIndex?a.vars.$(".vse-vdp-video-profile"):a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]').find(".vse-video-influencer-profile");0<c.length&&(c=c.clone(),a.dom.$activeVideoCustomerProfile.html(c.removeClass("vse-hidden").html()),a.dom.$activeVideoCustomerProfile.addClass("vse-active-profile-container"),a.dom.$videoAuthorBlock.addClass("vse-hidden"),a.dom.$wrapper.find(f.ibVideoOspDisclosure).addClass("aok-hidden"),a.dom.$wrapper.find(f.ibVideoAiDisclosure).removeClass("aok-hidden"),
b.entityId&&a.dom.$customerProfileContainer.append(a.dom.$vseFollowClassSelector),b.vendorName?(c=a.dom.$wrapper.find(f.ibVideoAiDisclosure),c.find(f.creatorAndDisclosure).html(b.vendorName),b=a.dom.$activeVideoCustomerProfile.find(".vse-profile").attr("href"),c.find(f.creatorAndDisclosure).attr("href",b),a.dom.$vseOapDivider.addClass("vse-hidden"),a.dom.$creatorNameAndDisclosure.removeClass("vse-hidden")):(a.dom.$vseOapDivider.removeClass("vse-hidden"),a.dom.$creatorNameAndDisclosure.addClass("vse-hidden")),
a.dom.$customerProfileContainer.removeClass("vse-no-cp"),a.handleInfluencerProfileNameClick(),a.handleInfluencerAvatarClick())};this.removeAudioOverlay=function(){var b=a.vars.$("#"+a.vars.popoverId);b.length&&(b=b.find("."+f.AUDIO_UNAVAILABLE_OVERLAY),b.length&&b.remove())};this.createAudioOverlay=function(b){var c=a.vars.$("#"+a.vars.popoverId);if(c.length){var d=a.vars.isMobile?c.find(".vse-vip-controls"):c.find(".brila-video-js").find(".vjs-control-bar");c.find("."+f.AUDIO_UNAVAILABLE_OVERLAY).remove();
b=a.vars.$("\x3cdiv\x3e",{class:""+f.AUDIO_UNAVAILABLE_OVERLAY,text:b.audioNote});d.length&&d.first().before(b)}};this.needToUpdateVideoInfoLater=function(){return a.isImageBlockVIP()&&!a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)&&a.vars.A.objectIsEmpty(a.vars.currentAssetSpec.title)};this.updateVideoMetadataIfNeeded=function(b){a.needToUpdateVideoInfoLater()&&(a.updateBasicMediaInfo(b),a.resetUserActivityTimer(),a.showVideoImmersivePlayerOverlay(),!a.vars.A.objectIsEmpty(b.closedCaptions)&&0<
b.closedCaptions.length&&(a.vars.player.removeCurrentTextTracks(),a.vars.player.updateTextTrack(b.closedCaptions)))};this.clearCurrentVideoInfo=function(){a.updateBasicMediaInfo({title:"",vendorName:"",entityId:"",entityType:""})};this.updateCCVDisclosure=function(b){b=b.ccvDisclosure?b.ccvDisclosure:"";0<b.length?(a.dom.$wrapper.find(f.ccvDisclosureMessage).html(b),a.dom.$wrapper.find(f.CCVContainerSelector).toggleClass("aok-hidden",!1)):a.dom.$wrapper.find(f.CCVContainerSelector).toggleClass("aok-hidden",
!0)};this.updateBasicMediaInfo=function(b){a.dom.$wrapper.find(f.videoTitle).html(b.title);a.dom.$wrapper.find(f.vendorName).html(b.vendorName);a.vars.showUploadDate&&a.dom.$wrapper.find(f.videoAge).html(b.videoAge);a.updateFollowCreatorButton(b);a.updateCCVDisclosure(b)};this.setUpSingleLBOverlayIfRequired=function(){a.vars.showSingleLBOverlay&&(a.moveMetadataOverPlayer(a.dom.$activeCrvMetadataContainer),a.moveMetadataOverPlayer(a.dom.$activeMetadataContainer),a.setupPlayerHoverHandler(),a.showPlayerOverlayFeaturesForAFewMS(3E3),
a.setupExpandCollapseTextWidget(a.vars.clientPrefix+"-toggle-full-text"))};this.updateFollowCreatorButton=function(b){try{a.dom.$followButtonSelector.length?a.isValidEntityToFollow(b)?(a.updateFollowButtonAttributes(b),a.handleFollowButtonInitialization()):a.hideFollowElements():a.hideFollowEligibleCreator()}catch(c){a.logFollowButtonError(b,c)}};this.isImageBlockVIP=function(){return a.vars.isVideoImmersivePlayer&&-1!==a.vars.clientPrefix.indexOf("imageblock")};this.createContinuousPlayPlaylist=
function(b){a.vars.playlist=a.getCombinedPlaylist();for(var c=0;c<a.vars.playlist.length&&a.vars.playlist[0].contentId!==b.contentId;c++)a.vars.playlist.push(a.vars.playlist.shift())};this.updateFeedback=function(b){a.vars.A.objectIsEmpty(a.vars.feedback)||a.vars.A.objectIsEmpty(b)||(a.vars.feedback.setActiveVideoAndSource(b.contentId,b.vendorCode,b.aciContentId,b.reportUrl),a.handleReportIllegalContentUpdate(b.disableReportIllegalLink))};this.handleReportIllegalContentUpdate=function(b){0<a.vars.A.$(""+
f.reportIllegalLinkSelector).length&&(a.vars.A.$(""+f.reportIllegalMessageSelector).toggleClass("aok-hidden",b),a.vars.A.$(""+f.reportIllegalLinkSelector).toggleClass("aok-hidden",b),a.vars.A.$(""+f.reportDefaultMessageSelector).toggleClass("aok-hidden",!b),b||a.vars.feedback.updateReportIllegalContentLink())};this.initializeHelpfulVotes=function(){if(a.vars.showVotes){var b=a.getActiveAsset();a.updateActiveVideoVoteContainer(b);a.vars.A.on(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+
"-hide-votes",function(){a.vars.activeVideoVoteContainer.showOrHide(!1,!1,!1,!1);a.vars.videoVoteFailure=!0});a.vars.A.off("a:declarative:"+(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-positive")+":click");a.vars.A.declarative(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-positive","click",function(){a.castVote(p.POSITIVE_VOTE)});a.vars.A.off(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-cast");a.vars.A.on(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+
"-vote-cast",function(b){var c=b===p.POSITIVE_VOTE?p.NEGATIVE_VOTE:p.POSITIVE_VOTE,d=a.getActiveAsset(),h=p.EMPTY_STRING;d&&d.videoVoteContainer&&(h=d.videoVoteContainer.getPreviousVote()===b?"cancel:"+b:d.videoVoteContainer.getPreviousVote()===p.POSITIVE_VOTE||d.videoVoteContainer.getPreviousVote()===p.NEGATIVE_VOTE?"switch-"+c+"-to-"+b:b,d.videoVoteContainer.updateWithNewVote(b));a.emitMetricToNexus({eventName:a.vars.clientPrefix+"ibiv.videovote.castvote:"+h,stringPayload:f.EMPTY_STRING,intPayload:1,
videoAsin:d.contentId})})}};this.emitMetricToNexus=function(b){a.vars.emitMetricsToNexus&&(b.customerId=a.vars.customerId||"",b=a.vars.buildNexusPayload(b),m.emitNexusMetric(b,a.vars.nexusMetricsConfig.producerId,a.vars.nexusMetricsConfig.widgetMetricsSchemaId,a.vars.nexusMetricsConfig.isInternal))};this.shouldShowVotes=function(b){return a.vars.videoVoteContainerFactory&&a.vars.videoVoteContainerFactory.videoVoteConfig&&b&&b.videoVoteContainer&&!a.vars.A.objectIsEmpty(b.videoVoteContainer)&&!a.vars.videoVoteFailure};
this.show=function(b){a.updateMediaInfo(b);a.updateFeedback(b);a.vars.includeVideoInformationOverPlayer&&a.showPlayerOverlayFeaturesForAFewMS(3E3,b);a.vars.skipRelatedVideosWait&&a.showRelatedProducts(b);a.refreshSocialSharePageState(b);a.showLabel(b);a.rotateTo(b);a.vars.isVideoImmersivePlayer&&(a.updateClosedCaptions(b),a.showOrHideSearchButton(b))};this.triggerAUIResize=function(){a.vars.A.trigger("resize",{},{width:l.innerWidth,height:l.innerHeight})};this.showPlayerOverlayFeaturesForAFewMS=function(b,
c){setTimeout(function(){a.showPlayerOverlayFeatures(c);a.vars.showActiveMetadataTimeoutId=setTimeout(function(){a.hidePlayerOverlayFeatures()},b)},500)};this.hasHiddenAndShowMoreClasses=function(b){if(!a.dom.$lbVideoCarousel)return!1;b=a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]');return b.hasClass("vse-hidden")&&b.hasClass("vse-show-more")};this.showOrHideSearchButton=function(b){b.hasHotspots&&!a.vars.isHotspotsWeblabTriggered&&(a.triggerWeblab(f.HOTSPOTS_V2_WEBLAB),a.vars.isHotspotsWeblabTriggered=
!0);b.showHotspots?(a.vars.showHotspots=!0,null==a.vars.visualSearchComponent&&(b=a.initializeVisualSearchComponent(),a.vars.visualSearchComponent=new ea(a,b),a.vars.visualSearchComponent.handleSearchButtonInteractions()),a.vars.visualSearchComponent.updateEducationalRules(),a.vars.A.$("#"+a.vars.templateId+" "+f.VIPSearchButtonSelector).show(),a.vars.visualSearchComponent.emitMetric(f.VisualSearchMetricPrefix+"searchButton:shown")):(a.vars.showHotspots=!1,a.vars.A.$("#"+a.vars.templateId+" "+f.VIPSearchButtonSelector).hide());
!a.vars.A.objectIsEmpty(a.vars.visualSearchComponent)&&a.vars.visualSearchComponent.isInVisualSearchMode()&&a.vars.visualSearchComponent.exitVisualSearchMode()};this.showLabel=function(b){if(b.labelDetails&&b.labelDetails.showLabel){if("videoType"===b.labelDetails.labelType){a.vars.isVideoTypeLabelPresent=!0;a.vars.isTimeoutComplete=!1;var c=a.vars.A.$("#"+a.vars.templateId+" "+f.LabelNameSelector);c.text(b.labelDetails.labelName);c.removeClass("aok-hidden");setTimeout(function(){c.addClass("aok-hidden");
a.vars.isTimeoutComplete=!0;a.vars.cursorOnVideoPlayerDiv&&c.removeClass("aok-hidden")},3E3);c.removeAttr("title");a.vars.A.off("a:popover:afterShow:ive-"+a.vars.clientPrefix+"-label-type-tooltip");a.vars.A.on("a:popover:afterShow:ive-"+a.vars.clientPrefix+"-label-type-tooltip",function(b){b.popover.$popover.bind("mouseenter touchstart focus",function(){a.vars.isFeedbackClosed&&a.showFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer)})});a.vars.A.off("a:popover:show:ive-"+a.vars.clientPrefix+
"-label-type-tooltip");a.vars.A.on("a:popover:show:ive-"+a.vars.clientPrefix+"-label-type-tooltip",function(a){var c=a.popover.$popover;a=c.find(""+f.LabelTooltipSelector);c=c.find(""+b.labelDetails.tooltipSelector);a.addClass("aok-hidden");c.removeClass("aok-hidden")})}"verifiedType"===b.labelDetails.labelType&&(a.vars.isVideoTypeLabelPresent=!1,a.dom.$wrapper.find(f.verifiedPurchaseLabel).removeClass("aok-hidden"),a.dom.$wrapper.find(f.verifiedPurchaseLabelDivider).removeClass("aok-hidden"))}else a.vars.isVideoTypeLabelPresent=
!1,a.vars.A.$("#"+a.vars.templateId+" "+f.LabelNameSelector).addClass("aok-hidden"),a.dom.$wrapper.find(f.verifiedPurchaseLabel).addClass("aok-hidden"),a.dom.$wrapper.find(f.verifiedPurchaseLabelDivider).addClass("aok-hidden")};this.getSegmentTypeIfMoreVideosToExpand=function(b){b=a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]');return a.vars.relatedVideosCarousel.getSegmentTypeFromElement(b)};this.getDefaultLangFromClosedCaptions=function(a){return a&&0<a.length?a[0].locale:null};
this.updateClosedCaptions=function(b){a.vars.currentClosedCaptionsLang=a.getDefaultLangFromClosedCaptions(b.closedCaptions);a.showOrHideClosedCaptions(b);a.vars.shouldHandleCCForLandscapeVideo=b.videoWidth!==u&&b.videoHeight!==u?b.videoWidth>b.videoHeight:!1};this.showOrHideClosedCaptions=function(b){b.closedCaptions&&0<b.closedCaptions.length?a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCButtonSelector).show():a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCButtonSelector).hide()};this.updateActiveVideoVoteContainer=
function(b){a.emitButtonImpressionMetric(a.vars.clientPrefix+"."+f.METRIC_HELPFUL_VOTES_IMPRESSION);a.vars.activeVideoVoteContainer.setPreviousVote(p.NONE_VOTE);a.vars.activeVideoVoteContainer.setContentId(b.contentId);b.videoVoteContainer&&(a.vars.activeVideoVoteContainer.setVoteCount(p.POSITIVE_VOTE,b.videoVoteContainer.getVoteCount(p.POSITIVE_VOTE)),a.vars.activeVideoVoteContainer.setVoteCount(p.NEGATIVE_VOTE,b.videoVoteContainer.getVoteCount(p.NEGATIVE_VOTE)));a.fetchAndUpdateVoteCountAndStatus(b)};
this.castVote=function(b){if(a.vars.videoVoteContainerFactory&&a.vars.videoVoteContainerFactory.videoVoteConfig){var c=a.vars.activeVideoVoteContainer.getPreviousVote(),d=b===p.POSITIVE_VOTE&&c!=p.POSITIVE_VOTE,c=b===p.NEGATIVE_VOTE&&c!=p.NEGATIVE_VOTE;a.vars.activeVideoVoteContainer.updateWithNewVote(b);a.vars.videoVoteContainerFactory.sendVoteToRemote(d,c,a.vars.activeVideoVoteContainer.getContentId()).then(function(c){a.vars.videoVoteContainerFactory&&a.vars.videoVoteContainerFactory.videoVoteConfig&&
a.vars.A.trigger(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-cast",b)},function(c){m.count(a.vars.clientPrefix+".videovote.votecastfailure",1);a.vars.activeVideoVoteContainer.updateWithNewVote(b)})}};this.fetchAndUpdateVoteCountAndStatus=function(b){b.videoVoteContainer&&b.videoVoteContainer.getPreviousVote()!==p.EMPTY_STRING&&a.vars.activeVideoVoteContainer.setPreviousVote(b.videoVoteContainer.getPreviousVote());b.videoVoteContainer&&!b.videoVoteContainer.countsFetched&&
a.vars.videoVoteContainerFactory.fetchVoteCountAndStatus(b.contentId).then(function(c){a.relatedVideosCarouselNotEmpty()&&-1!=a.vars.currentIndex&&a.updateVotingElementsForCountAndStatus(b,c,!1);b.videoVoteContainer.setVoteCount(p.POSITIVE_VOTE,c.positiveVoteCount);b.videoVoteContainer.countsFetched=!0;a.vars.activeVideoVoteContainer.setVoteCount(p.POSITIVE_VOTE,c.positiveVoteCount);a.vars.activeVideoVoteContainer.countsFetched=!0;c=1===c.voteStatus?p.POSITIVE_VOTE:p.NONE_VOTE;a.vars.activeVideoVoteContainer.setPreviousVote(c);
b.videoVoteContainer.setPreviousVote(c);a.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0)},function(b){m.count(a.vars.clientPrefix+".videovote.votecountandstatusfailure",1);a.vars.A.trigger(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-hide-votes")})};this.showRelatedProducts=function(b){a.fadeOutRelatedProductsContainer();var c=a.setRelatedProducts(b),d=b.productAsin;a.setRelatedProductsContainer();if(c!==u||b.relatedProductsWithSubstitute)a.vars.showLightboxV2Experience?
a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR).css({visibility:""}):a.vars.A.show(a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)),a.detachCurrentCarousel(b.contentId),a.attachCachedCarousel(b.contentId)?(a.hideCurrentlyVisibleProductContainer(),a.showRelatedProductCarousel(b.contentId,d),a.fadeInRelatedProductsContainer(b.contentId,d),setTimeout(a.resizeLB,500)):a.getRelatedProducts(1,c,b)};this.setRelatedProductsContainer=function(){a.vars.showHeroExperience?(a.vars.$relatedProductsParentEl=a.vars.$("#"+
a.vars.templateId),a.vars.relatedProductsContainer=f.HERO_WIDGET_CONTAINER+" #"+f.CACHE_RP_PAYLOAD_HIDDEN_DIV_CARDS_CONTAINER,a.dom.$relatedProductContainer=a.vars.$(""+a.vars.relatedProductsContainer)):(a.vars.$relatedProductsParentEl=a.vars.$(a.dom.$wrapper),a.vars.relatedProductsContainer="#"+a.vars.popoverId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR)};this.setRelatedProducts=function(b){var c;c=a.vars.A.objectIsEmpty(a.vars.firstRelatedProductOverride)?b.relatedProducts&&""!==b.relatedProducts?
b.relatedProducts:b.productAsin:a.vars.A.objectIsEmpty(b.relatedProducts)?a.vars.firstRelatedProductOverride:a.vars.firstRelatedProductOverride+","+b.relatedProducts;b=a.vars.complementaryAsins[b.contentId]||[];0<b.length&&c&&(c+=","+b.join(","));return c};this.handleClickPFOEvent=function(b){a.vars.isMobile&&a.vars.isMshop&&b.preventDefault();b.stopPropagation();b.stopImmediatePropagation();var c=a.vars.$(b.target).closest("li").find(f.RELATED_PRODUCTS_ITEM_SELECTOR),d=c.attr("data-asin"),c=c.hasClass("vse-sponsor-product").toString();
a.emitPFOClickMetric(f.METRIC_PFO_CLICK,d,c);d=a.vars.$(b.target).closest("li").find(".vse-carousel-item").attr("href");a.vars.enableClickBasedAttribution&&a.vars.player.getCurrentTime()<=f.CLICK_ATTRIBUTION_INITIAL_DELAY&&a.isOspEnabled(a.vars.currentAssetSpec)&&(b.preventDefault(),b=a.vars.$(b.target).closest("li").find(f.RELATED_PRODUCTS_ITEM_SELECTOR+" a").attr(f.ATTR_ORIGINAL_HREF),a.vars.isMshop||l.open(b,"_blank"),d=b,m.count("pfo:osp:tag:emitted:success:"+a.vars.linkCode,1));a.openExternalLinkFromLightBox(d)};
this.preserveCssLink=function(){var b=a.dom.$relatedProductContainer.find('link[rel\x3d"stylesheet"]').first();b.length&&a.dom.$relatedProductContainer.append(b.clone())};this.detachCurrentCarousel=function(b){a.preserveCssLink();var c=a.detachExceptSkeleton();c&&c.length&&a.vars.currentCarouselContentId&&(a.vars.detachedCarousels[a.vars.currentCarouselContentId]=c);a.vars.currentCarouselContentId=b};this.attachCachedCarousel=function(b){return(b=a.vars.detachedCarousels[b])?(a.dom.$relatedProductContainer.append(b),
!0):!1};this.getRelatedProducts=function(b,c,d){var k=!0;0<a.vars.relatedProductsNilgiriRequestCount&&(k=!1);var h=y.fetchLatestPageState(a.vars.A,a.vars.clientPrefix+"-related-products-request-ps");if(h){var n=h.componentConfiguration,l=h.pageContext;a.vars.showPFOOnOverlay=h.showPFOOnOverlay;a.vars.showPFOOnOverlay&&(a.A.$("#"+a.vars.templateId+" "+f.VIPProductCarouselOverlaySelector).hide(),a.A.$("#"+a.vars.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).hide());a.vars.cacheOnProductAsin=
h.cacheOnProductAsin;n&&l&&n.features&&n.features.features&&(l.metadata?l.metadata.relatedProductsAsins=c:l.metadata={relatedProductsAsins:c},a.vars.productAsin=a.vars.A.objectIsEmpty(a.vars.productAsin)?a.vars.A.objectIsEmpty(d.productAsin)?a.vars.A.objectIsEmpty(l.product)?"":l.product.contentID:d.productAsin:a.vars.productAsin,d.relatedProductsWithSubstitute&&(l.metadata.relatedProductsWithSubstitute=d.relatedProductsWithSubstitute),d.refTag&&(l.metadata.refTag=d.refTag),k={pageContext:{page:l.page,
placement:l.placement,marketplaceID:l.marketplaceID,locale:l.locale,customerId:l.customerId,requestId:l.requestId,product:{contentID:a.vars.productAsin,contentIDType:"ASIN"},metadata:l.metadata,device:l.device,clientPrefix:l.clientPrefix},configuration:{id:n.id,type:n.type,binder:n.binder,assets:k?["ProductCarousel"]:[],features:{features:n.features.features}}},a.vars.relatedProductsRequest=k,a.vars.relatedProductsCarouselName=n.features.features.carouselName,a.vars.keepProductCarouselOpenOnClick=
null!=n.features.features.keepProductCarouselOpenOnClick?n.features.features.keepProductCarouselOpenOnClick:!1,a.vars.showHeroExperience&&a.showSkeletalLoaderClassForHeroWidget(),z.sendRequest(a.vars.A,""+f.VAP_EW+f.RELATED_PRODUCTS_ENDPOINT,k,function(b){a.vars.showHeroExperience&&(a.dropSkeletalLoaderClassForHeroWidget(),setTimeout(a.triggerAUIResize,500));if(-1!==b.indexOf(f.RELATED_PRODUCTS_INNER_CLASS_NAME)){a.dom.$relatedProductContainer.append(b);a.handleGetRelatedProductsSuccess(d.contentId,
d.productAsin);a.vars.$relatedProductsParentEl.delegate(f.RELATED_PRODUCTS_ITEM_SELECTOR+" a","click",function(b){a.handleClickPFOEvent(b)});b=y.fetchLatestPageState(a.vars.A,a.vars.clientPrefix+"-related-products-ps");var c=document.querySelectorAll("#"+a.vars.popoverId+" "+f.HAS_PUI_SELECTOR+" "+f.RELATED_PRODUCTS_CAROUSEL_ELEMENT);0<c.length&&(a.addTagForSponsoredElements(c),a.appendUrParamsForProductAsins(c,b.getUrlParamsForAsins),b=a.vars.$(a.dom.$wrapper).find("[id^\x3d"+a.vars.relatedProductsCarouselName+
"]:visible").attr("id"),a.emitClickMetricForPUI(f.addToCartClickSelector,f.addToCartMetricSuffix,b),a.emitClickMetricForPUI(f.puiRelatedProductAsinSelector+" a",f.EMPTY_STRING,b),a.navigateToNewPageOnPuiClick(b),a.vars.$("#"+b+" "+f.puiRelatedProductAsinSelector+" "+f.puiStarRatingSelector).closest("span.a-declarative").removeClass("a-declarative"));a.vars.enableClickBasedAttribution&&(b=a.vars.$(a.dom.$wrapper).find(""+f.RELATED_PRODUCTS_ITEM_SELECTOR),a.disableRightClickOnPFOUntilRefParamsAreBound(b));
a.vars.isVideoImmersivePlayer&&a.vars.showPFOOnOverlay&&(a.A.$("#"+a.vars.templateId+" "+f.VIPProductCarouselOverlaySelector).fadeIn(1E3),a.A.$("#"+a.vars.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).fadeIn(1E3),a.handleCCStylesOnCarouselVisibility(!0));a.vars.A.objectIsEmpty(a.vars.A.$(f.LB_CAROUSEL_CONFIG).attr("data-configuration"))&&a.emitPFORenderMetric(f.METRIC_PFO_RENDER);m.count(a.vars.clientPrefix+":relatedproducts:load:success",1);a.vars.A.trigger(a.vars.clientPrefix+":relatedproducts:load:success");
a.vars.relatedProductsNilgiriRequestCount+=1}else a.handleGetRelatedProductsFailure()},function(e){(!e.http.status||500<=e.http.status&&600>e.http.status)&&b<f.AJAX_MAX_RETRY_COUNT?(b+=1,a.getRelatedProducts(b,c,d)):a.handleGetRelatedProductsFailure()}))}else m.count(f.RELATED_PRODUCT_PAGE_STATE_NOT_FOUND_ERROR_KEY,1)};this.disableRightClickOnPFOUntilRefParamsAreBound=function(b){if(!b)return!1;a.vars.$(b).bind("contextmenu",function(b){return a.vars.player.getCurrentTime()<f.CLICK_ATTRIBUTION_INITIAL_DELAY?
(b.preventDefault(),!1):!0})};this.appendUrParamsForProductAsins=function(a,c){Array.prototype.forEach.call(a,function(a){if(a=a.querySelector(".pui-wrapper")){var b=a.getAttribute("data-dib-asin");b&&c[b]&&(a=a.querySelectorAll("a"),Array.prototype.forEach.call(a,function(a){a.href&&(a.href=c[b])}))}})};this.addTagForSponsoredElements=function(a){Array.prototype.forEach.call(a,function(a){var b=a.querySelector(".pui-wrapper .vse-product-sponsored-disclosure");a=a.querySelector('[data-cy\x3d"title-recipe"]');
b&&a&&(b.remove(),a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b))})};this.bindClickAttributionToPFOs=function(b){return a.isOspEnabled(a.vars.currentAssetSpec)?b&&0<b.length?(b.each(function(c){c=a.A.$(b[c]);var d=c.closest(f.pfoRelatedProductSelector).attr("data-asin"),k=c.attr("href");c.attr(f.ATTR_ORIGINAL_HREF,k);d={href:k,asin:d||a.vars.currentAssetSpec.productAsin||a.vars.productAsin,linkCode:a.vars.linkCode,aciContentId:a.vars.currentAssetSpec.aciContentId||a.vars.aciContentId||
a.getAciContentIdFromPlayerInstance(),vendorTrackingId:a.vars.currentAssetSpec.vendorTrackingId};d=(new R(a.vars.A)).buildTag(d);c.attr("href",d)}),!0):!1:!1};this.getVideoToRelatedProductsDivId=function(b,c,d){b=a.vars.popoverId+"-"+d+a.sanitizeForCssSelector(b);a.vars.cacheOnProductAsin&&!a.vars.A.objectIsEmpty(c)&&(b+="-"+c);return b};this.sanitizeForCssSelector=function(a){return a.split(".").join("")};this.dropSkeletalLoaderClassForHeroWidget=function(){var b=a.vars.$(""+a.vars.relatedProductsContainer).children().first();
b.length&&b.addClass("aok-hidden")};this.showSkeletalLoaderClassForHeroWidget=function(){var b=a.vars.$(""+a.vars.relatedProductsContainer).children().first();b.length&&b.removeClass("aok-hidden")};this.handleGetRelatedProductsSuccess=function(b,c){a.hideCurrentlyVisibleProductContainer();var d=a.getVideoToRelatedProductsDivId(b,c,f.VISIBLE_DIV_NARROW_PREFIX),k=a.detachExceptSkeleton();a.vars.$(a.vars.relatedProductsContainer).append('\x3cdiv class\x3d"vse-pc-visible'+(a.vars.showHeroExperience?" vse-hero-rp-container":
"")+" aok-hidden\" id\x3d'"+d+"'\x3e\x3c/div\x3e");a.vars.$("#"+d).append(k);a.vars.$(a.vars.relatedProductsContainer+" #"+d+" .a-carousel-left").attr("data-element-id",a.vars.clientPrefix+"-pc-left-button");a.vars.$(a.vars.relatedProductsContainer+" #"+d+" .a-carousel-right").attr("data-element-id",a.vars.clientPrefix+"-pc-right-button");a.showRelatedProductCarousel(b,c);a.fadeInRelatedProductsContainer(b,c);a.vars.enableClickBasedAttribution&&(b=a.vars.$("#"+d).find(f.RELATED_PRODUCTS_ITEM_SELECTOR+
" a"),a.bindClickAttributionToPFOs(b));d=document.querySelectorAll(a.vars.relatedProductsContainer+" #"+d+" "+f.RELATED_PRODUCTS_ITEM_SELECTOR);b=a.vars.$(a.dom.$wrapper).find("[id^\x3d"+a.vars.relatedProductsCarouselName+"]:visible "+f.RELATED_PRODUCTS_CAROUSEL_ELEMENT);(d=0<d.length?d:b)&&l.IntersectionObserver&&new G(null,d,a.onProductItemIntersectionObserved,a.vars.enableWidgetMetricsAfterOneSecond);a.setupKeyPressEventHandlerForRelatedProductsCarousel();setTimeout(a.resizeLB,500)};this.hideCurrentlyVisibleProductContainer=
function(){a.vars.$(""+a.vars.relatedProductsContainer).find(".vse-pc-visible").addClass("aok-hidden");a.hideVIPProductCarouselEmptyViewContainer()};this.hideVIPProductCarouselEmptyViewContainer=function(){a.vars.isVideoImmersivePlayer&&a.vars.A.$(f.VIPEmptyRelatedProductsContainerSelector).addClass("aok-hidden")};this.showVIPProductCarouselEmptyViewContainer=function(){a.vars.isVideoImmersivePlayer&&a.vars.A.$(f.VIPEmptyRelatedProductsContainerSelector).removeClass("aok-hidden")};this.showRelatedProductCarousel=
function(b,c){a.vars.A.show(a.vars.$(""+a.vars.relatedProductsContainer));b=a.getVideoToRelatedProductsDivId(b,c,f.VISIBLE_DIV_NARROW_PREFIX);a.vars.$("#"+b).removeClass("aok-hidden")};this.handleGetRelatedProductsFailure=function(){m.count(a.vars.clientPrefix+":relatedproducts:load:failed",1);a.vars.showLightboxV2Experience?a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR).css({visibility:"hidden"}):a.vars.A.hide(a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR));a.vars.isVideoImmersivePlayer&&(a.hideCurrentlyVisibleProductContainer(),
a.showVIPProductCarouselEmptyViewContainer());setTimeout(a.resizeLB,500)};this.fadeOutRelatedProductsContainer=function(){a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR+" "+f.RELATED_PRODUCTS_INNER_CONTAINER).fadeOut(0)};this.fadeInRelatedProductsContainer=function(b,c){b=a.getVideoToRelatedProductsDivId(b,c,f.VISIBLE_DIV_NARROW_PREFIX);a.vars.$("#"+b+" "+f.RELATED_PRODUCTS_INNER_CONTAINER).animate({opacity:1},0);a.vars.$(a.vars.relatedProductsContainer+" "+f.RELATED_PRODUCTS_INNER_CONTAINER).fadeIn(200)};
this.showFeedbackLink=function(b,c){a.vars.includeVideoInformationOverPlayer?a.vars.$(b).fadeIn(500):a.vars.$(b).css({display:"inline-block"});b=a.vars.A.$("#"+a.vars.templateId+" "+f.LabelNameSelector);b.length&&a.vars.isVideoTypeLabelPresent&&b.removeClass("aok-hidden");a.vars.includeVideoInformationOverPlayer||a.toggleDimVideoPlayer(c,!0)};this.showActiveMetadataOverPlayer=function(b){b=b||a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex);clearTimeout(a.vars.showActiveMetadataTimeoutId);
a.vars.includeVideoInformationOverPlayer&&b&&!a.shouldDisablePlayerOverlayInteractions()&&(a.toggleDimVideoPlayer(a.vars.playerContainer,!0),a.isCustomerReviewVideo(b)&&a.dom.$activeCrvMetadataContainer&&0<a.dom.$activeCrvMetadataContainer.length?(a.dom.$activeMetadataContainer&&a.dom.$activeMetadataContainer.hide(),a.fadeInContainer(a.dom.$activeCrvMetadataContainer),a.updateCRTextIfRequired()):(a.dom.$activeCrvMetadataContainer&&a.dom.$activeCrvMetadataContainer.hide(),a.fadeInContainer(a.dom.$activeMetadataContainer)))};
this.fadeInContainer=function(a){a&&0!==a.length&&(a.removeClass("aok-hidden"),a.fadeIn(500))};this.fadeOutContainer=function(a){a.fadeOut(500)};this.hideActiveMetadataOverPlayer=function(){if(a.vars.includeVideoInformationOverPlayer&&a.vars.currentAssetSpec&&!a.shouldDisablePlayerOverlayInteractions())if(a.toggleDimVideoPlayer(a.vars.playerContainer,!1),a.isCustomerReviewVideo(a.vars.currentAssetSpec)&&a.dom.$activeCrvMetadataContainer&&0<a.dom.$activeCrvMetadataContainer.length){var b=a.vars.auiTruncate&&
a.vars.auiTruncate.get(a.vars.truncateWidgetId);a.collapseToTruncateText(b);a.fadeOutContainer(a.dom.$activeCrvMetadataContainer)}else a.fadeOutContainer(a.dom.$activeMetadataContainer)};this.shouldDisablePlayerOverlayInteractions=function(){return a.vars.player&&!a.vars.player.isPlaying()};this.setupPlayerHoverHandler=function(){var b=!0;a.vars.A.declarative.create(a.vars.$(a.vars.playerContainer),"player-overlay-features",{});a.vars.A.declarative("player-overlay-features","mouseenter touchstart focus",
function(){b&&(setTimeout(function(){b=!0},700),a.showPlayerOverlayFeatures(),a.vars.cursorOnVideoPlayerDiv=!0,a.vars.A.capabilities.touch&&a.vars.A.delay(a.hidePlayerOverlayFeatures(),3E3),b=!1)});a.vars.A.declarative("player-overlay-features","mouseleave",a.hidePlayerOverlayFeatures)};this.executeTooltip=function(b){v.now("a-tooltip").execute("ive-tooltip-registration",function(c){a.$trigger=a.A.$("#"+a.vars.templateId+" "+b.triggerSelector);a.tooltip=c;var d=a.A.$("#"+a.vars.templateId+" "+b.tooltipTextSelector).text();
a.instance=c.create(a.$trigger,{name:b.tooltipName,inlineContent:d,dataStrategy:"preload"});a.A.delay(function(){a.instance.show()},300);a.hideCustomerTooltip(!1)})};this.hideCustomerTooltip=function(b){a.instance&&(b?a.A.delay(function(){a.instance.hide();a.tooltip.remove(a.$trigger)},300):a.A.delay(function(){a.instance.hide();a.tooltip.remove(a.$trigger)},f.hideAfter-500))};this.handleTooltipDisplayToShowCustomerReview=function(){if(null===a.getLocalStorage(f.CUSTOMER_REVIEW_TOOLTIP_TEXT))a.setLocalStorage(f.CUSTOMER_REVIEW_TOOLTIP_TEXT,
Date.now().toString()),a.executeTooltip({triggerSelector:f.CUSTOMER_REVIEW_TOOLTIP_TEXT_ID,tooltipTextSelector:f.IVECustomerReviewVideosToolTipText,tooltipName:"ive-tooltip-customer-review"});else{var b=a.getLocalStorage(f.CUSTOMER_REVIEW_TOOLTIP_TEXT),c=Date.now();b&&a.isDifferenceGreaterThan24Hours(c,parseInt(b))&&(a.setLocalStorage(f.CUSTOMER_REVIEW_TOOLTIP_TEXT,Date.now().toString()),a.executeTooltip({triggerSelector:f.CUSTOMER_REVIEW_TOOLTIP_TEXT_ID,tooltipTextSelector:f.IVECustomerReviewVideosToolTipText,
tooltipName:"ive-tooltip-customer-review"}))}};this.hideFeedbackLink=function(b,c){a.hideFeedbackLinkWithoutDimmingThePlayer(b,c);a.toggleDimVideoPlayer(c,!1)};this.hideFeedbackLinkWithoutDimmingThePlayer=function(b,c){a.vars.includeVideoInformationOverPlayer?a.vars.$(b).fadeOut(500):a.vars.$(b).css({display:"none"});b=a.vars.A.$("#"+a.vars.templateId+" "+f.LabelNameSelector);b.length&&a.vars.isVideoTypeLabelPresent&&a.vars.isTimeoutComplete&&b.addClass("aok-hidden")};this.toggleDimVideoPlayer=function(b,
c){a.vars.includeVideoInformationOverPlayer?(a.vars.$(b).toggleClass("player-overlay-gradient",c),a.vars.$(b).removeClass("review-expanded"),a.vars.$(b+" video").removeClass("dim-video-player")):a.vars.$(b+" video").toggleClass("dim-video-player",c)};this.deRegisterFeedback=function(b){a.vars.A.off("vse:"+b+":feedback:shown");a.vars.A.off("vse:"+b+":feedback:hidden");a.vars.A.off("vse:ns:feedback:"+b+":init:client")};this.setVideoDetails=function(b,c){a.vars.initialVideo={index:0,segmentNumber:0,
title:c.videoTitle,altText:c.altText,vendorName:c.vendorName,contentId:b,vendorCode:c.vendorCode,videoUrl:c.videoUrl,imageUrl:c.imageUrl,productAsin:c.productAsin,videoReferenceId:c.videoReferenceId,videoWidth:c.videoWidth,videoHeight:c.videoHeight,seekTime:c.seekTime,aciContentId:c.aciContentId,showHotspots:c.showHotspots,labelDetails:c.labelDetails,ccvDisclosure:c.ccvDisclosure,reportUrl:c.reportUrl}};this.setFollowEntities=function(b,c){a.vars.A.objectIsEmpty(a.vars.initialVideo)||(a.vars.initialVideo.entityId=
b,a.vars.initialVideo.entityType=c)};this.attachPlayerEventListeners=function(){a.vars.player&&(a.vars.player.on("playbackComplete",a._playbackCompleteHandler),a.vars.player.on("playbackStart",a._firstFrameHandler))};this.attachReviewsPlayerEventListeners=function(){if(a.vars.player)a.vars.player.on("playbackComplete",a._reviewsPlaybackCompleteHandler)};this.removeUpNextComponent=function(){a.vars.upNextTimeoutHandle&&clearTimeout(a.vars.upNextTimeoutHandle);a.vars.intervalUserActivityHandlerId=a.userActivityCountDown();
a.vars.A.show(a.vars.$("#"+a.vars.templateId+" "+f.videoInformationContainer));a.dom.$wrapper.find("."+f.UpNextElementClassName).addClass("vse-hidden");a.dom.$wrapper.find("."+f.UpNextClassName).removeClass(""+f.UpNextElementShownClassName);a.dom.$wrapper.find(f.VIPSkipBackButtonSelector).removeClass("aok-hidden");a.dom.$wrapper.find(f.VIPSkipForwardButtonSelector).removeClass("aok-hidden");a.vars.$("#"+a.vars.templateId+" ."+f.UpNextCancelClassName).unbind("click");a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,
a.vars.vipControlsShouldPause);a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,!a.vars.vipControlsShouldPause);a.vars.isUpNextComponentActive=!1};this._playUpNextHandler=function(){if(a.relatedVideosCarouselNotEmpty()){var b=a.getActiveAsset(),c=a._getNextAsset(b);c&&(a.vars.vipControlsShouldPause=!1,a.vars.lightBoxPausedVideo=!1,a.removeUpNextComponent(),b.eventTimestamp&&(c.eventTimestamp=b.eventTimestamp),a.vars.player.play(c),a.emitThumbnailMetric(f.METRIC_UPNEXT_THUMBNAIL_IMPRESSION,
c,a.vars.currentIndex),a.show(c),a.vars.currentAssetSpec=c,-1===a.vars.currentIndex&&(a.vars.currentIndex=0))}};this._cancelContinuousPlayHandler=function(){if(a.relatedVideosCarouselNotEmpty()){var b=a.getActiveAsset();a.vars.player.loadNextVideoPoster(b.imageUrl);a.vars.vipControlsShouldPause=!0;a.removeUpNextComponent();a.vars.vipControlsShouldPause=!1;a.vars.lightBoxPausedVideo=!0}};this.continuousPlay=function(b,c){b.eventTimestamp&&(c.eventTimestamp=b.eventTimestamp);a.refTagRecorder.emitRefTag(c.continuousPlayRefTag);
null!=a.vars.onSiteAttributionMetrics&&a.vars.A.trigger("vse:"+a.vars.clientPrefix+":player:continuous:play");a.vars.currentIndex=a.findIndex(c);a.vars.player.play(c);a.vars.isVideoImmersivePlayer&&a.emitThumbnailMetric(f.METRIC_UPNEXT_THUMBNAIL_IMPRESSION,c,a.vars.currentIndex);!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)&&a.hasHiddenAndShowMoreClasses(c)&&a.vars.relatedVideosCarousel.loadMoreVideos(a.getSegmentTypeIfMoreVideosToExpand(c));a.show(c)};this._playbackCompleteHandler=function(){if(a.relatedVideosCarouselNotEmpty()&&
"inline"!=a.vars.currentPlayerMode){var b=a.getActiveAsset(),c=a._getNextAsset(b);c?a.vars.useUpNextComponent?(a.vars.isUpNextComponentActive=!0,a.vars.vipControlsShouldPause=!0,a.vars.lightBoxPausedVideo=!0,a.clearIntervalUserActivityHandler(),a.dom.$wrapper.find(f.VIPSkipBackButtonSelector).addClass("aok-hidden"),a.dom.$wrapper.find(f.VIPSkipForwardButtonSelector).addClass("aok-hidden"),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,
!a.vars.vipControlsShouldPause),a.vars.A.hide(a.vars.$("#"+a.vars.templateId+" "+f.videoInformationContainer)),a.vars.vipControlsShouldPause=!1,a.vars.lightBoxPausedVideo=!1,a.vars.player.loadNextVideoPoster(c.imageUrl),a.dom.$wrapper.find("."+f.UpNextVideoTitleClassName).html(c.title),a.dom.$wrapper.find("."+f.UpNextAuthorClassName).html(c.vendorName),a.dom.$wrapper.find("."+f.UpNextElementClassName).removeClass("vse-hidden"),a.dom.$wrapper.find("."+f.UpNextClassName).addClass(""+f.UpNextElementShownClassName),
a.vars.$("#"+a.vars.templateId+" ."+f.UpNextCancelClassName).click(a._cancelContinuousPlayHandler),a.showVideoImmersivePlayerOverlay(),a.resetUserActivityTimer(-2),a.vars.upNextTimeoutHandle=a.vars.A.delay(function(){a.removeUpNextComponent();a.continuousPlay(b,c);a.vars.currentAssetSpec=c;-1===a.vars.currentIndex&&(a.vars.currentIndex=0)},5E3)):a.continuousPlay(b,c):a.noNextVideoHandler()}else a.noNextVideoHandler()};this._reviewsPlaybackCompleteHandler=function(){a.dom.$wrapper.find(f.VIPTimeRemainingSelector).text("-0:00")};
this._firstFrameHandler=function(){!a.vars.showMoreMenuExperience&&a.vars.isMobile&&a.hideFeedbackLink("#vse-"+a.vars.clientPrefix+"-feedback-container","#"+a.vars.containerId+"-container");a.vars.isVideoImmersivePlayer&&(a.vars.player.getMediaDuration()!==a.vars.vipVideoDuration&&(a.vars.vipVideoDuration=a.vars.player.getMediaDuration()),a.vars.vipControlsShouldPause=!0,a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,
!a.vars.vipControlsShouldPause))};this._getNextAsset=function(b){for(var c=0;c<a.vars.playlist.length&&a.vars.playlist[c].contentId!=b.contentId;c++);if(c!=a.vars.playlist.length)return a.vars.playlist[c+1];if(-1===a.vars.currentIndex)return a.vars.playlist[0]};this._playerFailedAutoplayHandler=function(){a.vars.vipControlsShouldPause=!1;a.toggleVipPlayPauseClass();a.vars.vipVideoDuration=a.vars.player.getMediaDuration();a.updateProgressBarAndTimeDisplay();a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&
(a.handleUserActivity(),a.handleCCStylesOnReviewsOverlayVisibility(!0));m.count(f.AUTOPLAY_FALLBACK_EXECUTED,1)};this._playerSucceededAutoplayHandler=function(){a.clearIntervalUserActivityHandler();a.vars.intervalUserActivityHandlerId=a.userActivityCountDown();a.vars.vipPlayIconClicked=!0;a.vars.useAutoplayFallback=!1;a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&a.handleCCStylesOnReviewsOverlayVisibility(!0)};this.handleCCStylesOnCarouselVisibility=function(b){a.A.$("#"+
a.vars.templateId+" .vjs-text-track-display").toggleClass(f.VIPProductCarouselOpenedClassName,b)};this.handleCCStylesOnReviewsOverlayVisibility=function(b){a.A.$("#"+a.vars.templateId+" .vjs-text-track-display").toggleClass(f.VIPReviewsOverlayVisibleClassName,b)};this.onPlayerTapHandler=function(){"inline"!==a.vars.currentPlayerMode&&(a.vars.showPFOOnOverlay&&a.handleCCStylesOnCarouselVisibility(!0),a.showVideoImmersivePlayerOverlay(),a.resetUserActivityTimer())};this.pauseVideoIfNeeded=function(b){void 0===
b&&(b=!1);a.vars.player&&a.vars.player.isPlaying()&&(a.vars.player.pause(a.vars.isVideoImmersivePlayer&&!b?"ivx-pause":u),a.vars.lightBoxPausedVideo=!0,a.vars.isVideoImmersivePlayer&&a.vars.isVIPOverlayTimerSet&&a.clearIntervalUserActivityHandler())};this.muteUnMuteVideo=function(){a.vars.player&&!a.vars.player.isMuted()?a.vars.player.mute():a.vars.player.unmute();a.updateAudioToggleStatus()};this.updateAudioToggleStatus=function(){a.vars.player&&a.vars.vipMuteUnmuteToggle&&(a.vars.vipMuteUnmuteToggle.toggleClass(f.VIPMuteIconClassName,
a.vars.player.isMuted()),a.vars.vipMuteUnmuteToggle.toggleClass(f.VIPUnmuteIconClassName,!a.vars.player.isMuted()))};this.resumeVideoIfNeeded=function(b,c){if(!a.vars.lightboxOpened&&!0!==b)return!1;a.vars.player&&a.vars.player.isPlaying()&&(a.vars.player.pause(a.vars.isVideoImmersivePlayer&&!c?"ivx-pause":u),a.vars.lightBoxPausedVideo=!0);a.vars.player&&!a.vars.player.isPlaying()&&!a.vars.isContinuousPlayFinished&&a.vars.lightBoxPausedVideo?(a.vars.player.resume(Date.now()),a.vars.isVideoImmersivePlayer&&
!a.vars.isVIPOverlayTimerSet&&(a.resetUserActivityTimer(),a.showVideoImmersivePlayerOverlay(),a.vars.intervalUserActivityHandlerId=a.userActivityCountDown())):a.vars.useAutoplayFallback&&(a.startPlaying(a.vars.currentAssetSpec),a.vars.intervalUserActivityHandlerId=a.userActivityCountDown(),a.vars.vipPlayIconClicked=!0,a.vars.isClosedCaptionEnabled&&a.vars.player.enableCurrentTextTrack(a.vars.currentClosedCaptionsLang),a.vars.useAutoplayFallback=!1);a.vars.isVideoImmersivePlayer&&a.vars.isContinuousPlayFinished&&
(a.relatedVideosCarouselNotEmpty()&&a.vars.initialVideo?(a.startPlaying(a.vars.initialVideo),a.show(a.vars.initialVideo)):a.vars.currentAssetSpec&&(a.startPlaying(a.vars.currentAssetSpec),a.resetUserActivityTimer(),a.showVideoImmersivePlayerOverlay(),a.vars.intervalUserActivityHandlerId=a.userActivityCountDown()));a.vars.lightBoxPausedVideo=!1};this.noNextVideoHandler=function(){a.vars.isVideoImmersivePlayer&&(a.clearIntervalUserActivityHandler(),a.vars.lightBoxPausedVideo=!0,a.vars.vipControlsShouldPause=
!1,a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause),a.showVideoImmersivePlayerOverlay());a.vars.isContinuousPlayFinished=!0};this.initializeVisualSearchComponent=function(){return{A:a.A,templateId:a.vars.templateId}};this.setInitialClosedCaptions=function(b,c){c=ja.getClosedCaptions(a.vars.A,c);b.closedCaptions=c;a.vars.initialVideo.closedCaptions=c;a.vars.currentClosedCaptionsLang=
a.getDefaultLangFromClosedCaptions(c)};this.setupVIPClosedCaptions=function(b,c){if("inline"!==a.vars.currentPlayerMode){a.vars.closedCaptionsConfig=b;var d="#"+a.vars.templateId+" "+f.VIPCCButtonSelector;a.vars.A.$(d+"."+f.VIPCCButtonUnpressedClassName).live("click",function(){a.vars.isClosedCaptionEnabled=!0;a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&a.A.$("#"+a.vars.templateId+" .vjs-text-track-display").toggleClass(f.VIPLandscapeVideoClassName,a.vars.shouldHandleCCForLandscapeVideo);
a.vars.A.$(""+d).removeClass(f.VIPCCButtonUnpressedClassName).addClass(f.VIPCCButtonPressedClassName);a.vars.player.enableCurrentTextTrack(a.vars.currentClosedCaptionsLang);a.showTempCCPopup(a.getCurrentCaptionsOnText())});a.vars.A.$(d+"."+f.VIPCCButtonPressedClassName).live("click",function(){a.vars.isClosedCaptionEnabled=!1;a.vars.A.$(""+d).removeClass(f.VIPCCButtonPressedClassName).addClass(f.VIPCCButtonUnpressedClassName);a.vars.player.disableCurrentTextTrack(a.vars.currentClosedCaptionsLang);
a.showTempCCPopup(b.captionsOffText)});a.vars.A.objectIsEmpty(c)&&a.vars.A.$(""+d).hide()}};this.getCurrentCaptionsOnText=function(){var b=a.vars.closedCaptionsConfig.captionsOnTexts,c=a.vars.currentClosedCaptionsLang;return a.vars.A.objectIsEmpty(b)||a.vars.A.objectIsEmpty(b[c])?f.EMPTY_STRING:b[c]};this.showTempCCPopup=function(b){a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCTooltipTextSelector).text(b);a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCTooltipSelector).removeClass("aok-hidden");clearTimeout(a.vars.closedCaptionsTooltipTimerId);
a.vars.closedCaptionsTooltipTimerId=setTimeout(function(){return a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCTooltipSelector).addClass("aok-hidden")},3E3)};this.setupDefaultClosedCaptions=function(){a.vars.A.$("#"+a.vars.templateId+" "+f.defaultPlayerCCButtonTitleSelector).removeAttr("title")};this.onTextTrackEnable=function(b){if("inline"!==a.vars.currentPlayerMode){var c="#"+a.vars.templateId+" "+f.VIPCCButtonSelector;"showing"===b.mode&&a.vars.A.$(""+c).hasClass(f.VIPCCButtonUnpressedClassName)&&
(a.vars.isClosedCaptionEnabled=!0,a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&a.A.$("#"+a.vars.templateId+" .vjs-text-track-display").toggleClass(f.VIPLandscapeVideoClassName,a.vars.shouldHandleCCForLandscapeVideo),a.vars.A.$(""+c).removeClass(f.VIPCCButtonUnpressedClassName).addClass(f.VIPCCButtonPressedClassName))}};this.getDomain=function(){return a.vars.A.objectIsEmpty(l.location.origin)?"https://www.amazon.com":l.location.origin};this.buildShareUrl=
function(b){return b.redirectUrl?a.getDomain()+b.redirectUrl:a.getDomain()+"/vdp/"+b.contentId};this.refreshSocialSharePageState=function(b){var c=a.buildShareUrl(b);a.vars.A.objectIsEmpty(a.vars.productAsin)||(c+="?product\x3d"+a.vars.productAsin);a.vars.A.state.replace(a.vars.socialSharePageState,{pageLevelData:{clientRef:"ib",deviceTypeRef:a.vars.isMobile?"mb":"dt"},url:c,image:b.imageUrl,title:b.title,description:b.title,shareCopyLinkSuccessText:a.vars.shareCopyLinkSuccessText,socialShareId:a.vars.socialShareId})};
this.getMshopShareParams=function(b){var c=a.buildShareUrl(b)+"?ref\x3dive_share_mshop_"+a.vars.clientPrefix;b=b.title+" "+c;var d="\x3cdiv\x3e \x3cp\x3e"+b+"\x3c/p\x3e \x3c/div\x3e";return{subject:b,messagePlain160:b.substring(0,160),messagePlain140:b.substring(0,140),messageHTML:d,messagePlain:b,url:c}};this.getDomElements=function(b,c){a.dom.$wrapper=a.vars.$(b===c?"#"+c:"#"+b+" #"+c);a.dom.$lbContainer=a.dom.$wrapper.find(".vse-lb-container");a.dom.$lbLeftColumn=a.dom.$wrapper.find(".vse-lb-left");
a.dom.$lbLeftColumnPlaceholder=a.vars.$("#"+b).find('div[class*\x3d"vsePlaceholder"] .a-col-left');a.dom.$lbRightColumn=a.dom.$wrapper.find(".vse-lb-right");a.dom.$lbCCHeader=a.dom.$wrapper.find(".vse-cc-header");a.dom.$lbTabContainer=a.dom.$wrapper.find(".vse-lightbox-tab");a.dom.$videoAuthor=a.dom.$wrapper.find(".vse-video-author span");a.dom.$mobileFixedContainer=a.dom.$wrapper.find(".vse-common-mobile-fixed-container");a.dom.$mobileMovableContainer=a.dom.$wrapper.find(".vse-vb-movable-container");
a.dom.$relatedProductContainer=a.dom.$wrapper.find(".vse-related-products-narrow");a.dom.$activeVideoOspLink=a.dom.$wrapper.find(".vse-oap-link");a.dom.$activeVideoTitlePrefix=a.dom.$wrapper.find(".vse-title-prefix");a.dom.$activeVideoCRLink=a.dom.$wrapper.find(".vse-cr-link");a.dom.$activeVideoCRLinkWrapper=a.dom.$wrapper.find(".video-title-container-right");a.dom.$followButtonSelector=a.dom.$wrapper.find(f.followButton);a.dom.$vseFollowClassSelector=a.dom.$wrapper.find(f.vseFollowClass);a.dom.$followEligibleCreator=
a.dom.$wrapper.find(f.creatorAndDisclosure);a.dom.$activeMetadataContainer=a.dom.$wrapper.find(".vse-active-metadata")};this.getCustomerProfileDomElements=function(){a.dom.$lbVideoCarousel=a.vars.isVideoImmersivePlayer?a.dom.$wrapper.find(".vse-vip-lb-carousel"):a.dom.$wrapper.find(".vse-related-videos-container");a.dom.$activeVideoCustomerProfile=a.dom.$wrapper.find("#vse-active-video-customer-profile");a.dom.$activeCrvMetadataContainer=a.dom.$wrapper.find(".vse-active-crv-metadata");a.dom.$videoAuthorBlock=
a.dom.$wrapper.find(".vse-video-author");a.dom.$customerProfileContainer=a.dom.$wrapper.find(".vse-cp-container");a.dom.$profileLinkSelector=a.dom.$wrapper.find(".vse-profile");a.dom.$vseOapDivider=a.dom.$wrapper.find(".vse-oap-divider");a.dom.$creatorNameAndDisclosure=a.dom.$wrapper.find(".vse-creator-name-and-disclosure")};this.initializeCustomerProfile=function(b){a.getCustomerProfileDomElements();a.isCustomerReviewVideo(b)&&a.updateCustomerProfile(b);a.isInfluencerVideo(b)&&a.updateInfluencerProfile(b);
a.dom.$activeVideoCustomerProfile.undelegate(".vse-profile","click");a.dom.$activeVideoCustomerProfile.delegate(".vse-profile","click",function(b){a.handleExternalLinkClick(b,"."+f.VIPVideoInfoClassName,".vse-profile",!0)});a.dom.$activeCrvMetadataContainer.undelegate(".vse-profile","click");a.dom.$activeCrvMetadataContainer.delegate(".vse-profile","click",function(b){a.handleExternalLinkClick(b,""+f.CRVInfoSelector,".vse-profile-link",!0)});a.dom.$activeVideoCustomerProfile.undelegate(".vse-link",
"click");a.dom.$activeVideoCustomerProfile.delegate(".vse-link","click",function(b){a.handleExternalLinkClick(b,"."+f.VIPVideoInfoClassName,".vse-link",!1)});a.vars.A.trigger("resize",{},{width:l.innerWidth,height:l.innerHeight})};this.handleExternalLinkClick=function(b,c,d,f){void 0===f&&(f=!1);f&&a.vars.disableCreatorClicksOnMshop?a.preventExternalLinkClick(b):(b=a.vars.$(b.target).closest(c).find(d).attr("href"))&&a.openExternalLinkFromLightBox(b)};this.shouldSetProductCarouselWidth=function(b){var c=
a.dom.$wrapper.find(".vse-lb-right .vse-related-videos-container .a-carousel-row").height();return a.vars.A.isFiniteNumber(c)?c<b?!0:!1:!1};this.resizeDesktopLB=function(){if(a.vars.showLightboxV2Experience){var b=a.dom.$lbLeftColumn.outerHeight(!0),c=a.dom.$lbRightColumn.outerHeight(!0);c?a.isDesktopVerticalLightBox()?c!==b&&(a.toggleLightboxCloseButton(!1),a.hideFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer),a.dom.$lbRightColumn.css({height:b}),a.vars.$("#"+a.vars.popoverId).css({height:2*
b}),a.vars.$("#"+a.vars.popoverId).css("overflow","").get(0).style.setProperty("overflow","hidden","important")):(a.toggleLightboxCloseButton(!0),a.dom.$lbRightColumn.css({height:"100%"}),a.dom.$lbLeftColumnPlaceholder.length&&(b=a.dom.$lbLeftColumnPlaceholder.outerHeight(!0)),a.vars.$("#"+a.vars.popoverId).css({height:b})):a.toggleLightboxCloseButton(!0)}!a.vars.A.capabilities.mobile&&a.vars.A.capabilities.touch&&(b=a.dom.$wrapper.closest(f.LightboxWrapperSelector),b.hasClass(f.TABLET_LIGHTBOX_CLASS_NAME)||
(a.toggleLightboxCloseButton(!0),b.addClass(f.TABLET_LIGHTBOX_CLASS_NAME),b.find(f.AUI_POPOVER_INNER).addClass(f.TABLET_LIGHTBOX_CLASS_NAME)))};this.resizeMobileLB=function(){a.dom.$lbContainer.height(l.innerHeight);var b=a.vars.$(a.dom.$mobileFixedContainer).outerHeight(!0),b=a.vars.$(l).height()-b;a.vars.$(a.dom.$mobileMovableContainer).animate({"max-height":b})};this.resizeLB=function(){a.vars.isMobile?a.resizeMobileLB():a.resizeDesktopLB()};this.resetCarouselWithSeeMore=function(){a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||
a.vars.relatedVideosCarousel.resetVideosStateOnLightboxReopen()};this.isOspEnabled=function(b){return!a.vars.A.objectIsEmpty(b.vendorTrackingId)&&""!==b.vendorTrackingId};this.showVideoImmersivePlayerOverlay=function(){a.dom.$wrapper.find(f.VIPOverlaySelector).addClass(f.VIPOverlayShowClassName);a.dom.$wrapper.find(f.VIPSearchButtonSelector).removeClass(f.VIPSearchButtonHideText);a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&a.handleCCStylesOnReviewsOverlayVisibility(!0)};
this.hideVideoImmersivePlayerOverlay=function(){a.vars.useMultiCarousel&&a.vars.multiCarouselExpanded&&a.openCloseMultiCarousel();a.vars.showPFOOnOverlay&&a.handleCCStylesOnCarouselVisibility(!1);a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&a.handleCCStylesOnReviewsOverlayVisibility(!1);a.dom.$wrapper.find(f.VIPSearchButtonSelector).addClass(f.VIPSearchButtonHideText);a.dom.$wrapper.find(f.VIPOverlaySelector).removeClass(f.VIPOverlayShowClassName)};this.enableIVXOverlayOnTab=
function(){document.addEventListener("keydown",a.handleIVXOverlayOnTab)};this.disableIVXOverlayOnTab=function(){document.removeEventListener("keydown",a.handleIVXOverlayOnTab)};this.handleIVXOverlayOnTab=function(b){if(9==b.keyCode){a.resetUserActivityTimer();a.showVideoImmersivePlayerOverlay();var c=document.querySelector("#"+a.vars.popoverId+" "+f.VIPMultiCarouselWrapper);setTimeout(function(){return a.openCloseMultiCarouselOnFocus(c)},250)}};this.openCloseMultiCarouselOnFocus=function(b){b&&b.contains(document.activeElement)?
a.vars.useMultiCarousel&&!a.vars.multiCarouselExpanded&&a.openCloseMultiCarousel():a.vars.useMultiCarousel&&a.vars.multiCarouselExpanded&&a.openCloseMultiCarousel()};this.setUserActivityTimer=function(b){a.vars.$(b.target).hasClass(f.VIPOverlayShowClassName)||a.vars.$(b.target).hasClass(f.UpNextClassName)||a.vars.$(b.target).hasClass(f.VIPMetadataClassName)||a.vars.$(b.target).hasClass(f.VIPVideoInfoClassName)||a.vars.$(b.target).hasClass(f.VIPVideoAgeClassName)||a.vars.$(b.target).hasClass(f.VIPVideoTitleWrapperClassName)||
a.vars.$(b.target).hasClass(f.VIPVideoHelpfulVotesClassName)||a.vars.$(b.target).hasClass(f.VIPPlayPauseClassName)||a.vars.$(b.target).hasClass(f.VIPScrubberClassName)||a.isTargetReviewsMetadataWhenCarouselExpand(b)?(a.hideVideoImmersivePlayerOverlay(),a.vars.isMultiCarouselClosedForFirstTime&&a.vars.showHotspots&&a.vars.visualSearchComponent.addAnimationForHotspotsVideo()):a.resetUserActivityTimer()};this.isTargetReviewsMetadataWhenCarouselExpand=function(b){return a.vars.multiCarouselExpanded&&
!a.isTargetOutsideExpandedReviewsMetadata(b)};this.resetUserActivityTimer=function(b){void 0===b&&(b=0);a.vars.useAllIVXComponents&&(a.vars.secondsFromLastActivity=b)};this.handleUserActivityForReviewsUsecase=function(b){a.isReviewTextExpanded()?a.isTargetOutsideExpandedReviewsMetadata(b)&&(a.A.$(f.VIPOverlaySelector).removeClass("vse-reviews-expand-full-cr"),a.A.$(".vse-reviews-content-ellipsis-wrapper").scrollTop(0),a.resetReviewTextStyle(),a.A.animationFrameDelay(function(){a.compactReviewIfNeeded();
a.updateReviewsExpandButtonVisibility()}),a.vars.vipControlsShouldPause&&a.resumeVideoIfNeeded()):a.vars.useAutoplayFallback||a.vars.vipControlsShouldPause&&a.setUserActivityTimer(b)};this.handleUserActivityForMultiChannelReviewIVX=function(b){a.isReviewTextExpanded()&&a.isTargetOutsideExpandedReviewsMetadata(b)?a.expandOrCollapseText(a.vars.auiTruncate.get(a.vars.truncateWidgetId)):a.setUserActivityTimer(b)};this.handleUserActivity=function(){!a.vars.isVIPOverlayOnTapEventRegistered&&a.vars.$(""+
a.vars.popoverId)&&(a.dom.$lbContainer.click(function(b){a.vars.useChannelCarousel&&a.isCustomerReviewVideo(a.vars.currentAssetSpec)?a.handleUserActivityForMultiChannelReviewIVX(b):a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata?a.handleUserActivityForReviewsUsecase(b):a.setUserActivityTimer(b)}),a.vars.isVIPOverlayOnTapEventRegistered=!0)};this.userActivityCountDown=function(){if(a.vars.useAllIVXComponents)return a.vars.intervalUserActivityHandlerId=a.vars.A.interval(function(){a.vars.multiCarouselExpanded||
(a.vars.secondsFromLastActivity++,3<a.vars.secondsFromLastActivity&&a.hideVideoImmersivePlayerOverlay())},1E3),a.vars.isVIPOverlayTimerSet=!0,a.handleUserActivity(),a.vars.intervalUserActivityHandlerId};this.clearIntervalUserActivityHandler=function(){a.vars.isVIPOverlayTimerSet=!1;clearInterval(a.vars.intervalUserActivityHandlerId)};this.emitMetric=function(b){a.emitMetricToNexus({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:1})};this.emitClickMetric=function(b,c){void 0===c&&(c="");b={eventName:b,
stringPayload:f.EMPTY_STRING,intPayload:1,videoAsin:a.getVideoAsin(),rankingStrategy:a.getRankingStrategy(),groupType:""!==c?c:a.getGroupType(),channel:a.getChannelNumber()};a.emitMetricToNexus(b)};this.emitEventDurationMetric=function(b,c){b={eventName:b,stringPayload:f.EMPTY_STRING,intPayload:c,videoAsin:a.getVideoAsin(),rankingStrategy:a.getRankingStrategy()};a.emitMetricToNexus(b)};this.emitRelatedVideosRenderMetric=function(b,c,d){a.vars.A.objectIsEmpty(c)||(b={eventName:b,stringPayload:f.EMPTY_STRING,
intPayload:1,channel:a.getChannelNumber(d),videoAsinList:c.getplaylist().map(function(a){return a.contentId+f.COMMA+a.groupType}).join(f.SEMICOLON),rankingStrategy:c.getplaylist().map(function(a){return a.rankingStrategy}).join(f.SEMICOLON)},a.emitMetricToNexus(b))};this.emitPFOClickMetric=function(b,c,d){a.vars.emitMetricsToNexus&&(b=a.vars.buildNexusPayload({eventName:b,stringPayload:d,intPayload:1,productAsin:c,videoAsin:a.getVideoAsin(),rankingStrategy:a.getRankingStrategy(),customerId:a.vars.customerId||
""}),m.emitNexusMetric(b,a.vars.nexusMetricsConfig.producerId,a.vars.nexusMetricsConfig.widgetMetricsSchemaId,a.vars.nexusMetricsConfig.isInternal))};this.emitPFORenderMetric=function(b){a.A.off(" "+a.vars.clientPrefix+":relatedproducts:load:success");a.A.on(" "+a.vars.clientPrefix+":relatedproducts:load:success",function(){for(var c=a.A.$("#"+a.vars.templateId+" .vse-pc-visible").not(".aok-hidden").find(".vse-product-item"),d="",k=a.getVideoAsin(),h=[],n=0;n<c.length;n++)h.push([c[n].getAttribute("data-asin"),
c[n].classList.contains("vse-sponsor-product").toString(),!1]),d+=c[n].getAttribute("data-asin")+","+c[n].classList.contains("vse-sponsor-product").toString(),n!==c.length-1&&(d+=f.SEMICOLON);a.vars.contentIdProductAsinMap[k]=h;a.vars.emitMetricsToNexus&&(c={eventName:b,stringPayload:d.toString(),intPayload:1,videoAsin:k,rankingStrategy:a.getRankingStrategy(),groupType:a.getGroupType()},a.emitMetricToNexus(c))})};this.getVideoAsin=function(){return a.vars.currentAssetSpec&&a.vars.currentAssetSpec.contentId?
a.vars.currentAssetSpec.contentId:a.relatedVideosCarouselNotEmpty()?a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).contentId:f.EMPTY_STRING};this.getRankingStrategy=function(){return a.vars.currentAssetSpec&&a.vars.currentAssetSpec.rankingStrategy?a.vars.currentAssetSpec.rankingStrategy:a.relatedVideosCarouselNotEmpty()?a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).rankingStrategy:a.vars.rankingStrategy};this.getGroupType=function(){return a.vars.currentAssetSpec&&a.vars.currentAssetSpec.groupType?
a.vars.currentAssetSpec.groupType:a.relatedVideosCarouselNotEmpty()?a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).groupType:f.EMPTY_STRING};this.getChannelNumber=function(b){return a.vars.useChannelCarousel?null!=b?b+"":a.vars.currentAssetSpec&&a.vars.currentAssetSpec.segmentNumber?a.vars.currentAssetSpec.segmentNumber+"":a.relatedVideosCarouselNotEmpty()?a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).segmentNumber+"":f.EMPTY_STRING:f.EMPTY_STRING};this.emitPFOImpressionMetric=
function(b,c,d,f){a.vars.emitMetricsToNexus&&(b={eventName:b,stringPayload:d.toString(),intPayload:f,productAsin:c,videoAsin:a.getVideoAsin(),rankingStrategy:a.getRankingStrategy()},a.emitMetricToNexus(b))};this.emitThumbnailMetric=function(b,c,d){void 0===d&&(d=1);a.vars.emitMetricsToNexus&&(c=a.vars.buildNexusPayload({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:d,productAsin:c.productAsin,videoAsin:c.contentId,rankingStrategy:c.rankingStrategy,groupType:c.groupType,customerId:a.vars.customerId||
"",channel:a.getChannelNumber(c.segmentNumber)}),m.emitNexusMetric(c,a.vars.nexusMetricsConfig.producerId,a.vars.nexusMetricsConfig.widgetMetricsSchemaId,a.vars.nexusMetricsConfig.isInternal),m.count(a.vars.clientPrefix+":"+b,1))};this.emitButtonImpressionMetric=function(b,c,d){void 0===c&&(c=f.EMPTY_STRING);void 0===d&&(d=1);a.vars.emitMetricsToNexus&&(b=a.vars.buildNexusPayload({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:d,rankingStrategy:a.getRankingStrategy(),groupType:c,customerId:a.vars.customerId||
"",videoAsin:a.getVideoAsin()}),m.emitNexusMetric(b,a.vars.nexusMetricsConfig.producerId,a.vars.nexusMetricsConfig.widgetMetricsSchemaId,a.vars.nexusMetricsConfig.isInternal))};this.emitPFOImpressionMetricHandler=function(b,c,d){var f=a.getVideoAsin(),h=a.vars.contentIdProductAsinMap[f];if(h){for(;b<Math.min(c,h.length);b++)h[b][2]||(a.emitPFOImpressionMetric(d,h[b][0],h[b][1],b),h[b][2]=!0);a.vars.contentIdProductAsinMap[f]=h}};this.emitPFOImpressionMetricVIPHandler=function(){var b=a.A.$("#"+a.vars.templateId+
" .vse-pc-visible .a-carousel-viewport").not(".aok-hidden"),c=b.find(".vse-product-item").first(),b=l.innerWidth>l.innerHeight?Math.floor((b.scrollTop()+l.innerHeight)/c.height()):Math.floor((b.scrollLeft()+l.innerWidth)/c.width());a.emitPFOImpressionMetricHandler(0,b,f.METRIC_PFO_IMPRESSION)};this.emitPFOImpressionMetricDefaultHandler=function(b){var c=b.carousel.getAttr("pageNumber");b=b.carousel.getAttr("pageSize");a.emitPFOImpressionMetricHandler((c-1)*b,c*b,f.METRIC_PFO_IMPRESSION)};this.emitPFOImpressionMetricInitHandler=
function(b){a.vars.A.off("a:carousel:"+a.vars.relatedProductsCarouselName+":change:pageNumber",a.emitPFOImpressionMetricDefaultHandler);a.vars.A.on("a:carousel:"+a.vars.relatedProductsCarouselName+":change:pageNumber",a.emitPFOImpressionMetricDefaultHandler);a.emitPFOImpressionMetricDefaultHandler(b)};this.handleWatchIconMetric=function(){var b=function(b){a.vars.manualTriggerWatchIcon||a.emitClickMetric(f.METRIC_WATCH_ICON);a.vars.useMultiCarousel&&!a.vars.multiCarouselExpanded&&(a.resetUserActivityTimer(-2),
setTimeout(function(){return a.openCloseMultiCarousel()},750))};a.A.$("#"+a.vars.templateId+" "+f.VIPWatchIconSelector+".vse-unpressed").click(b);a.A.$("#"+a.vars.templateId+" "+f.VIPWatchIconSelector+".vse-pressed").click(b)};this.handleShopIconMetric=function(){a.A.on("vse:"+a.vars.templateId+":vip:shop:click",function(){a.emitClickMetric(f.METRIC_SHOP_ICON_CLICK)});var b=function(b){a.vars.manualTriggerShopIcon||a.emitClickMetric(f.METRIC_SHOP_ICON_UNCLICK)};a.A.$("#"+a.vars.templateId+" "+f.VIPShopIconSelector+
".vse-unpressed").click(b);a.A.$("#"+a.vars.templateId+" "+f.VIPShopIconSelector+".vse-pressed").click(b)};this.handleShareIconMetric=function(){a.A.on("a:sheet:beforeShow:"+a.vars.socialShareId+"-sheet",function(){a.emitClickMetric(f.METRIC_SHARE_ICON)})};this.handleMoreMenuMetric=function(){a.emitButtonImpressionMetric(f.METRIC_MORE_MENU_IMPRESSION);a.A.on("a:sheet:beforeShow:"+a.vars.feedbackId+"-sheet",function(){a.emitClickMetric(f.METRIC_MORE_MENU_CLICK)})};this.handleInfluencerProfileNameClick=
function(){a.dom.$activeVideoCustomerProfile.find(".a-profile-name").unbind("click");a.dom.$activeVideoCustomerProfile.find(".a-profile-name").click(function(){m.count(a.vars.clientPrefix+".influencerProfileNameClickCount",1)})};this.handleInfluencerAvatarClick=function(){a.dom.$activeVideoCustomerProfile.find(".a-profile-avatar").unbind("click");a.dom.$activeVideoCustomerProfile.find(".a-profile-avatar").click(function(){m.count(a.vars.clientPrefix+".influencerAvatarClick",1)})};this.getDeviceOrientation=
function(){return l.innerHeight>l.innerWidth?f.PORTRAIT:l.innerWidth>l.innerHeight?f.LANDSCAPE:f.SQUARE};this.getAspectRatio=function(a){if(a===f.PORTRAIT)return f.PORTRAIT_ASPECT_RATIO;if(a===f.LANDSCAPE)return f.LANDSCAPE_ASPECT_RATIO;if(a===f.SQUARE)return f.SQUARE_ASPECT_RATIO};this.isDesktopVerticalLightBox=function(){return!a.vars.isMobile&&l.innerWidth<a.vars.verticalLightBoxMaxWidth};this.initializeVideoActionTray=function(b){a.vars.videoActionTrayComponents=new xa({A:a.A,contentCarousel:a.vars.relatedVideosCarousel,
socialShareId:a.vars.socialShareId,templateId:a.vars.templateId,clientPrefix:a.vars.clientPrefix});a.handleShopIconMetric();a.vars.videoActionTrayComponents.handleShopIconInteractions();a.vars.videoActionTrayComponents.handleShareIconInteractions();a.handleShareIconMetric();a.handleWatchIconMetric();a.vars.videoActionTrayComponents.handleVIPCarouselClose();a.initializeWatchComponents(b);a.A.on("vse:"+a.vars.templateId+":vip:vat:component:open",function(){a.A.$("#"+a.vars.templateId+" "+f.VIPActionOverlaySelector).addClass(f.VIPActionOverlayShowClassName)});
a.A.on("vse:"+a.vars.templateId+":vip:vat:component:close",function(){a.A.$("#"+a.vars.templateId+" "+f.VIPActionOverlaySelector).removeClass(f.VIPActionOverlayShowClassName)})};this.updateProgressBarAndTimeDisplay=function(b,c,d){if(0===a.vars.vipVideoDuration)a.vars.vipVideoDuration=a.vars.player.getMediaDuration();else{b=a.vars.A.$(c);d=a.vars.A.$(d);c=0<d.length?d:a.dom.$wrapper.find(f.VIPProgressBarFillSelector);d=0<b.length?b:a.dom.$wrapper.find(f.VIPTimeRemainingSelector);var k=Math.min(a.vars.player.getCurrentTime(),
a.vars.vipVideoDuration);c.width(k/a.vars.vipVideoDuration*100+"%");var h;b=0;c=!1;3600<=a.vars.vipVideoDuration&&(b=Math.floor(k/3600),c=!0);var n=a.vars.vipVideoDuration-k,k=Math.floor(n%60);h=Math.floor(n/60%60);c&&(b=Math.floor(n/3600));d.text("-"+(c?b+":":"")+(c&&10>h?"0"+h+":":h+":")+(10>k?"0"+k:k))}};this.initializeVIPControls=function(){var b=a.dom.$wrapper.find(f.VIPSkipBackButtonSelector);b.unbind("click");b.click(function(b){b.stopPropagation();b=a.vars.player.getCurrentTime();a.vars.player.setCurrentTime(b-
10);a.resetUserActivityTimer(2);a.vars.isContinuousPlayFinished=!1;a.emitClickMetric(f.METRIC_SKIP_BACK);a.vars.player.emitSkipBackwardClick()});b=a.dom.$wrapper.find(f.VIPSkipForwardButtonSelector);b.unbind("click");b.click(function(b){b.stopPropagation();0===a.vars.vipVideoDuration&&(a.vars.vipVideoDuration=a.vars.player.getMediaDuration());b=a.vars.player.getCurrentTime();a.vars.player.setCurrentTime(Math.min(b+10,a.vars.vipVideoDuration-1));a.resetUserActivityTimer(2);a.emitClickMetric(f.METRIC_SKIP_FORWARD);
a.vars.player.emitSkipForwardClick()});a.initializeMuteButton();a.vars.vipPlayPauseToggle=a.dom.$wrapper.find(f.VIPPlayPauseToggleSelector);a.vars.vipPlayPauseToggle.unbind("click");a.vars.vipPlayPauseToggle.click(function(b){b.stopPropagation();a.vars.vipControlsShouldPause?(a.pauseVideoIfNeeded(),a.vars.vipControlsShouldPause=!1,a.emitClickMetric(f.METRIC_PAUSE)):(a.vars.useUpNextComponent&&a.vars.isUpNextComponentActive?a._playUpNextHandler():a.resumeVideoIfNeeded(),a.resetUserActivityTimer(2),
a.vars.vipControlsShouldPause=!0,a.emitClickMetric(f.METRIC_PLAY));a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause);a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause)});a.vars.player.on("timeupdate",a.updateProgressBarAndTimeDisplay);a.initializeProgressBarTouchEvents();a.initializeCrossCountryDisclosureBottomSheet()};this.initializeProgressBarTouchEvents=function(b,c,d){b=0<a.vars.A.$(b).length?a.vars.A.$(b):a.dom.$wrapper;
c=c||f.VIPProgressBarSelector;var k=b.find(c);b.undelegate(c,"touchstart touchmove touchend click");b.delegate(c,"touchstart",function(b){b.stopPropagation();a.vars.isScrubbing=!0;a.pauseVideoIfNeeded(!0)});b.delegate(c,"touchmove",function(b){if(a.vars.isScrubbing){b.stopPropagation();a.resetUserActivityTimer();var c=k.width(),d=k.get(0)&&(k.get(0).getBoundingClientRect().x||k.get(0).getBoundingClientRect().left)||0;b=Math.max(0,Math.min(1,(b.originalEvent.touches[0].clientX-d)/c));c=a.vars.vipVideoDuration*
b;1===b&&(c-=.1);a.vars.player.setCurrentTime(c)}});b.delegate(c,"touchend",function(b){b.stopPropagation();a.vars.isScrubbing=!1;a.vars.isContinuousPlayFinished=!1;a.vars.vipControlsShouldPause&&a.resumeVideoIfNeeded(d,!0)});b.delegate(c,"click",function(b){b.stopPropagation();a.vars.isContinuousPlayFinished=!1;a.resetUserActivityTimer();var c=k.width();b=Math.max(0,Math.min(1,b.offsetX/c));c=a.vars.vipVideoDuration*b;1===b&&(c-=.1);a.vars.player.setCurrentTime(c);a.vars.player.emitScrubberClick()})};
this.initializeCrossCountryDisclosureBottomSheet=function(){var b=a.A.$("#"+a.vars.templateId+" "+f.CCVBottomSheetTrigger);b.length&&(b.unbind("click"),b.click(function(b){a.pauseVideoIfNeeded()}));a.vars.ccvDisclosureConfig&&a.vars.ccvDisclosureConfig.id&&(b=a.vars.ccvDisclosureConfig.id+"-sheet",a.A.off("a:sheet:beforeShow:"+b),a.A.on("a:sheet:beforeShow:"+b,function(a){a=a.sheet.$contentContainer.siblings(f.AUISheetCloseButtonSelector);a.length&&a.addClass(f.CCVCloseButton)}),a.A.off("a:sheet:afterHide:"+
b),a.A.on("a:sheet:afterHide:"+b,function(b){b=b.sheet.$contentContainer.siblings(f.AUISheetCloseButtonSelector);b.length&&b.removeClass(f.CCVCloseButton);a.vars.vipControlsShouldPause&&a.resumeVideoIfNeeded()}))};this.initializeMuteButton=function(){a.vars.vipMuteUnmuteToggle=a.dom.$wrapper.find(f.VIPMuteUnmuteSelector);a.vars.vipMuteUnmuteToggle.unbind("click");a.vars.vipMuteUnmuteToggle.click(function(b){b.stopPropagation();a.muteUnMuteVideo()})};this.updateSegmentTab=function(b){a.vars.relatedVideosCarousel&&
a.vars.relatedVideosCarousel.updateSegmentTabForActiveVideo(b)};this.vseCsmWidgetLoadedMetrics=function(){var b=a.vars.A.$("#"+a.vars.clientPrefix+"-vse-related-videos");a.vars.isMetricRecorded||a.vars.A.objectIsEmpty(b.offset())?a.vars.A.off("scroll",a.vseCsmWidgetLoadedMetrics):a.vars.A.onScreen(b)&&(a.postWidgetInitializationMetrics(),a.vars.isMetricRecorded=!0)};this.triggerWeblabOnObjectImpressed=function(b,c,d,f){b&&l.IntersectionObserver&&(a.vars.objectIntersectionObserver=new G(null,b,function(b,
n){a.handleWeblabTriggerIntersection(b,n,c,d,f)},a.vars.enableWidgetMetricsAfterOneSecond))};this.handleWeblabTriggerIntersection=function(b,c,d,k,h){if(c&&c.dataset&&!a.vars.isWeblabTriggeredMap[d])try{if(k=a.triggerWeblab(d))a.vars.isWeblabTriggeredMap[d]=!0,h&&h(!0),a.vars.objectIntersectionObserver&&a.vars.objectIntersectionObserver.disconnectObserver()}catch(n){m.logError(f.ATTRIBUTION_NAME,"Failed to trigger weblab: "+d,n)}};this.isClickInExcludedContainer=function(b){return 0<a.vars.$(b.target).closest(".puis-atcb-container").length||
0<a.vars.$(b.target).closest(".s-energy-efficiency-container").length};this.navigateToNewPageOnPuiClick=function(b){a.vars.$(a.dom.$wrapper).delegate("#"+b+" "+f.puiRelatedProductAsinSelector,"click",function(b){if(!a.isClickInExcludedContainer(b)){var c=a.vars.$(b.target).closest("a").attr("href");b.preventDefault();b.stopPropagation();b.stopImmediatePropagation();a.pauseVideoIfNeeded();c&&l.open(c,"_blank")}})};this.emitClickMetricForPUI=function(b,c,d){a.vars.$(a.dom.$wrapper).find("#"+d).delegate(f.RELATED_PRODUCTS_CAROUSEL_ELEMENT+
" "+b,"click",function(d){if(b!==f.puiRelatedProductAsinSelector||!a.isClickInExcludedContainer(d)){var h=a.getProductAsinForPUI(d,f.productAsinAttributeSelector);d=0!==a.vars.$(d.target).closest(".vse-product-carousel-element").find(".vse-product-sponsored-disclosure").length;if(h){var n=a.vars.productAsin===h?f.LANDING_ASIN:f.COMPLEMENTARY_ASIN;d?n+=" "+f.SPONSORED_ASIN:"";a.emitPFOClickMetric(""+f.METRIC_PUI_CLICK_PREFIX+c+":click",h,n)}}})};this.getProductAsinForPUI=function(b,c){return a.vars.$(b.target).closest("["+
c+"]").attr(c)||null};this.postWidgetInitializationMetrics=function(){var b=a.vars.A.now()-a.vars.widgetStartTime;a.vars.A.$("#vse-spinner").hasClass("aok-hidden")?(m.count(a.vars.clientPrefix+".widgetViewedAndLoadedCount",1),m.count(a.vars.clientPrefix+".widgetViewedAndLoadedDuration",b)):(m.count(a.vars.clientPrefix+".widgetViewedNotLoadedCount",1),m.count(a.vars.clientPrefix+".widgetViewedNotLoadedDuration",b));m.count(a.vars.clientPrefix+".pageLoadToWidgetViewedDuration",b)};this.emitMultipleThumbnailImpressionMetricHandler=
function(b){try{if(b===u||null===b)return!1;var c=a.vars.isVideoImmersivePlayer?a.getCombinedPlaylist():a.vars.playlist;a.emitThumbnailMetric(a.vars.isVideoImmersivePlayer?f.METRIC_WATCH_THUMBNAIL_IMPRESSION:f.METRIC_LB_THUMBNAIL_IMPRESSION,c[b],b)}catch(d){m.logError(f.ATTRIBUTION_NAME,"Failed to emit thumbnail impression",d)}};this.emitButtonImpressionMetricHandler=function(b,c){try{if(c===u||null===c)return!1;var d=a.A.$(c).attr("data-segment-id");a.emitButtonImpressionMetric(f.METRIC_LB_SHOW_MORE_BUTTON_IMPRESSION,
d,b)}catch(k){m.logError(f.ATTRIBUTION_NAME,"Failed to emit show more button impression",k)}};this.triggerWeblabHandler=function(b){try{var c=a.vars.isVideoImmersivePlayer?a.getCombinedPlaylist():a.vars.playlist,d=c[b].labelDetails?c[b].labelDetails.labelWeblabName:"";d&&!a.vars.hasWeblabTriggered&&(a.vars.hasWeblabTriggered=a.triggerWeblab(d))}catch(k){m.logError(f.ATTRIBUTION_NAME,"Failed to trigger weblab",k)}};this.triggerWeblab=function(b){if(!b||a.vars.isWeblabTriggeredMap[b])return!1;z.sendRequest(a.vars.A,
""+f.VAP_EW+f.WEBLAB_TRIGGER_ENDPOINT,{weblabNames:[b],requestId:l.ue?l.ue.id:""},function(c){a.vars.isWeblabTriggeredMap[b]=!0;m.count(f.METRIC_WEBLAB_TRIGGER_SUCCESS,1);a.emitMetric(b+f.METRIC_WEBLAB_TRIGGER_SUCCESS)},function(c){m.count(f.METRIC_WEBLAB_TRIGGER_FAILURE,1);a.emitMetric(b+f.METRIC_WEBLAB_TRIGGER_FAILURE)});return!0};this.onIntersectionObserved=function(b){a.emitMultipleThumbnailImpressionMetricHandler(b);a.triggerWeblabHandler(b)};this.onIntersectionObservedForShowMoreButton=function(b,
c){a.emitButtonImpressionMetricHandler(b,c)};this.onProductItemIntersectionObserved=function(b,c){if(c&&c.dataset){var d=c.dataset.asin||(c.querySelector(".pui-wrapper")?c.querySelector(".pui-wrapper").getAttribute("data-dib-asin"):null);c=[c.dataset.isSponsored||null!==c.querySelector(".puis-card-container .vse-product-sponsored-disclosure")||!1,a.vars.productAsin===d?f.LANDING_ASIN:f.COMPLEMENTARY_ASIN].join(" ");a.emitPFOImpressionMetric(f.METRIC_PFO_IMPRESSION,d,c,b)}};this.getEligibleIndicesForEmission=
function(a,c){return c=a=a.filter(function(a){return 0>c.indexOf(a)}).slice()};this.getModalFactory=function(){var b=null;a.vars.isMobile?v.now("a-secondary-view").execute("vw-dp-secondary-view",function(a){b=a}):v.now("a-modal").execute("vw-dp-modal",function(a){b=a});return b};this.resetVIPControls=function(){a.vars.vipControlsShouldPause||(a.vars.vipControlsShouldPause=!0,a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,
a.vars.vipControlsShouldPause))};this.setMshopPageOrientation=function(b){a.vars.A.capabilities.ios&&"function"===typeof a.vars.mShopFactory.setPageOrientation&&a.vars.mShopFactory.setPageOrientation({behavior:b})};this.requestMshopFullscreen=function(){a.vars.isVideoImmersivePlayer&&!a.vars.A.objectIsEmpty(a.vars.mShopFactory)&&(a.vars.A.capabilities.ios&&a.vars.viewportMetaTag.attr("content",a.vars.viewportMetaTagContent+",  viewport-fit\x3dcover"),a.vars.mShopFactory.requestFullscreen({successCallback:function(){document.addEventListener("touchmove",
a.mShopScrollLock,!0);document.addEventListener("touch",a.mShopScrollLock,!0);a.vars.A.delay(function(){a.vars.A.trigger("resize",{},{width:l.innerWidth,height:document.documentElement.clientHeight});a.dom.$lbContainer&&a.dom.$lbContainer.height(document.documentElement.clientHeight)},200);a.setMshopPageOrientation(a.vars.mShopFactory.AUTO_ROTATE_ENABLED)},failCallback:function(){a.vars.A.trigger("resize",{},{width:l.innerWidth,height:document.documentElement.clientHeight});a.dom.$lbContainer&&a.dom.$lbContainer.height(document.documentElement.clientHeight)}}))};
this.cancelMshopFullscreen=function(b){void 0===b&&(b=function(){});a.vars.isVideoImmersivePlayer&&!a.vars.A.objectIsEmpty(a.vars.mShopFactory)&&(a.vars.A.capabilities.ios&&a.vars.viewportMetaTag.attr("content",a.vars.viewportMetaTagContent),a.vars.mShopFactory.cancelFullscreen({successCallback:function(){document.removeEventListener("touchmove",a.mShopScrollLock,!0);document.removeEventListener("touch",a.mShopScrollLock,!0);b();a.setMshopPageOrientation(a.vars.mShopFactory.AUTO_ROTATE_DISABLED)},
failCallback:function(){a.requestMshopFullscreen()}}))};this.cancelMshopFullscreenAndNavigate=function(b){var c;"string"===typeof b?c=function(){a.vars.A.delay(function(){a.closeIVXComponents();a.vars.mShopFactory.navigate({url:b,transition:"slide"})},600)}:(b&&b.preventDefault(),c=function(){if(b.target){var c=b.target.getAttribute("href");a.closeIVXComponents();a.vars.mShopFactory.navigate({url:c,transition:"slide"})}});a.vars.disableFullScreenOnMshop?c():a.cancelMshopFullscreen(c)};this.openExternalLinkFromLightBox=
function(b){a.pauseVideoIfNeeded();a.vars.isVideoImmersivePlayer&&(a.setIVXPauseState(),a.vars.isMshop&&a.cancelMshopFullscreenAndNavigate(b))};this.setIVXPauseState=function(){a.vars.vipControlsShouldPause=!1;a.toggleVipPlayPauseClass()};this.closeIVXComponents=function(){a.vars.$(".vse-close-button").click();a.A.trigger("vse:ns:partialcomponents:"+a.vars.clientPrefix+":ivx:close")};this.closeIXVAndTriggerDisclosureEvent=function(b){a.vars.isVideoImmersivePlayer&&b&&(a.preventExternalLinkClick(b),
b.srcElement&&(b=b.srcElement.getAttribute("href"),a.closeIVXComponents(),a.vars.A.trigger(a.vars.clientPrefix+":vse:disclosure:click",b)))};this.preventExternalLinkClick=function(a){a&&a.preventDefault()};this.mShopScrollLock=function(b){0<a.vars.$(b.target).closest(f.VIPActionOverlaySelector).length||0<a.vars.$(b.target).closest(".vse-profile").length||0<a.vars.$(b.target).closest(".vse-fb-sheet").length||a.vars.$(b.target).hasClass("vse-fb-copyright")||a.vars.$(b.target).hasClass("vse-oap-link")||
a.vars.$(b.target).hasClass("vse-profile")||a.vars.$(b.target).hasClass("vse-cr-link")||a.vars.$(b.target).hasClass("vse-fb-report-illegal-content")?b.stopPropagation():b.preventDefault()};this.initializeWatchComponents=function(b){b={A:a.A,segmentTabs:b,segmentTabCssClassSelectorName:"#"+a.vars.popoverId+" "+f.VIPLbTabsContainerSelector+" .vse-vip-lb-tab"};a.vars.useMultiCarousel||a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)?a.vars.useMultiCarousel&&!a.vars.hideWatchIcon&&a.vars.videoActionTrayComponents.handleMoreVideosIconInteractions():
(a.vars.relatedVideosCarousel.initializeSegmentTabs(b),a.vars.videoActionTrayComponents.handleWatchIconInteractions())};this.setVIPOrientationProperties=function(b){var c={carouselAnimationType:{width:"toggle"},getCardInViewOffset:function(a){return a.offset().left},getOffsetPointForTabUpdate:function(){return l.innerWidth/2},animatedCarouselDimensionValue:function(){return b},getCarouselPropertyToAnimate:function(a){return{scrollLeft:a}}},d={carouselAnimationType:{height:"toggle"},getCardInViewOffset:function(a){return a.offset().top},
getOffsetPointForTabUpdate:function(){return a.A.$("#"+a.vars.templateId+" "+f.VIPLbTabsContainerSelector).outerHeight(!0)+parseInt(a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselSelector+" .vse-video-card:first").css("margin-top"))},animatedCarouselDimensionValue:function(){return{carouselCardWidth:a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselSelector+" .vse-video-card:last").outerHeight(!0)+3}},getCarouselPropertyToAnimate:function(a){return{scrollTop:a}}},k={carouselAnimationType:{height:"toggle"},
getCardInViewOffset:function(a){return a.offset().top},getOffsetPointForTabUpdate:function(){return a.A.$("#"+a.vars.templateId+" "+f.VIPLbTabsContainerSelector).outerHeight(!0)+parseInt(a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselSelector+" .vse-video-card:first").css("margin-top"))},animatedCarouselDimensionValue:function(){return b},getCarouselPropertyToAnimate:function(a){return{scrollLeft:a}}};l.innerHeight>l.innerWidth&&a.setOrintationConfig(c);l.innerWidth>l.innerHeight&&(a.vars.useMultiCarousel?
a.setOrintationConfig(k):a.setOrintationConfig(d),a.updateLbViewportHeight());a.A.on.orientationchange(function(b){0===b.orientation?(a.setOrintationConfig(c),a.resetLbViewportHeight(),a.emitMetric(f.METRIC_PORTRAIT_MODE)):(a.vars.useMultiCarousel?a.setOrintationConfig(k):a.setOrintationConfig(d),a.updateLbViewportHeight(),a.emitMetric(f.METRIC_LANDSCAPE_MODE))})};this.setOrintationConfig=function(b){a.vars.videoActionTrayComponents.setOrientationConfig(b);a.setOrientationConfig(b)};this.resetLbViewportHeight=
function(){a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselViewportSelector).css("height","initial")};this.updateLbViewportHeight=function(){a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselViewportSelector).height(l.innerHeight-a.A.$("#"+a.vars.templateId+" "+f.VIPLbTabsContainerSelector).outerHeight(!0))};this.isReviewTextOverflow=function(){var b=a.A.$("#"+a.vars.templateId+" .vse-reviews-content-ellipsis-wrapper").prop("scrollHeight"),c=a.A.$("#"+a.vars.templateId+" .vse-reviews-content-ellipsis-wrapper").prop("clientHeight");
return b>c};this.isReviewTextExpanded=function(){return a.A.$("#"+a.vars.templateId+" "+f.VIPOverlaySelector).hasClass("vse-reviews-expand-full-cr")};this.updateReviewsExpandButtonVisibility=function(){a.A.$("#"+a.vars.templateId+" .vse-reviews-expand-container").toggleClass("vse-reviews-expand-show-toggle",a.isReviewTextOverflow())};this.styleExpandedReviewText=function(){var b=a.A.$("#"+a.vars.templateId+" .vse-reviews-content-expand-container"),c=a.isReviewTextOverflow()?"vse-reviews-content-expand-container-long":
"vse-reviews-content-expand-container-short";b.addClass(c)};this.resetReviewTextStyle=function(){a.A.$("#"+a.vars.templateId+" .vse-reviews-content-expand-container").removeClass("vse-reviews-content-expand-container-short vse-reviews-content-expand-container-long")};this.compactReviewIfNeeded=function(){var b=a.A.$("#"+a.vars.templateId+" .vse-reviews-content-ellipsis-wrapper"),c=a.A.$("#"+a.vars.templateId+" .vse-vip-play-pause-forward-previous-btns-container"),d=b.hasClass("vse-reviews-content-ellipsis-single-line"),
d=b.height()*(d?2:1),c=b.offset().top+d>c.offset().top-10;b.toggleClass("vse-reviews-content-ellipsis-single-line",c)};this.handleReviewsOnResize=function(){a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&a.vars.lightboxOpened&&(a.isReviewTextExpanded()?(a.resetReviewTextStyle(),a.styleExpandedReviewText()):(a.compactReviewIfNeeded(),a.updateReviewsExpandButtonVisibility()))};this.isLandscapeView=function(){return a.getDeviceOrientation()==f.LANDSCAPE};this.handleMultiChannelReviewIVXOnResize=
function(){if(a.vars.currentAssetSpec&&a.isCustomerReviewVideo(a.vars.currentAssetSpec))if(a.vars.updateCRText=!0,a.resetCRVInfo(a.vars.currentAssetSpec),a.updateCRTextIfRequired(),a.isReviewTextExpanded())a.resetCRVTextExpandView();else if(a.vars.multiCarouselExpanded){var b=a.isLandscapeView();a.dom.$lbContainer.find(""+f.CRVInfoSelector).toggleClass("aok-hidden",b)}};this.resetCRVInfo=function(b){(b=a.dom.$lbVideoCarousel&&a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]').find(".vse-lb-crv-metadata .vse-crv-info"))&&
0<b.length&&a.dom.$activeCrvMetadataContainer.find(".vse-crv-info").html(b.clone().html())};this.resetCRVTextExpandView=function(){var b=a.vars.auiTruncate&&a.vars.auiTruncate.get(a.vars.truncateWidgetId);b&&(b.getTruncatedText()!==b.getFullText()?a.expandTruncatedText(b):(a.collapseToTruncateText(b),a.setIVXPauseState()))};this.isTargetOutsideExpandedReviewsMetadata=function(b){return f.VIPReviewsMetadataSelectors.every(function(c){return 0===a.A.$(b.target).closest(c).length})};this.toggleVipPlayPauseClass=
function(){a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause);a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause)};this.handleKeepVideoCarouselOpen=function(){a.vars.lightboxOpened&&a.vars.keepCarouselOpenOnLinkClick&&(a.handleIVXOverlay(),a.vars.manualTriggerWatchIcon=!0,a.vars.videoActionTrayComponents.triggerWatchIconInteractionOpen(),a.vars.watchAllClicked=!1,a.vars.manualTriggerWatchIcon=!1)};this.handleKeepProductCarouselOpen=
function(){a.vars.lightboxOpened&&a.vars.keepProductCarouselOpenOnClick&&(a.handleIVXOverlay(),a.vars.manualTriggerShopIcon=!0,a.vars.videoActionTrayComponents&&a.vars.videoActionTrayComponents.triggerShopIconInteractionOpen(),a.vars.manualTriggerShopIcon=!1)};this.handleIVXOverlay=function(){a.vars.useAutoplayFallback||!a.vars.lightboxOpenedFirstTime?a.showVideoImmersivePlayerOverlay():a.hideVideoImmersivePlayerOverlay()};this.showPoster=function(b){a.vars.player.showPoster(b)};this.addPlayerHoverHandler=
function(){var b=a.vars.A.$("#"+a.vars.containerId),c=a.vars.A.$("#"+a.vars.templateId),d=a.vars.$("#"+a.vars.templateId+"-close-button");if(d){d=d.clone();d.removeClass("vse-close-button").addClass(f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME);b.append(d);var k=function(){!a.isDesktopVerticalLightBox()&&!a.isSingleVideoLightbox()||a.shouldDisablePlayerOverlayInteractions()||a.toggleLightboxCloseButton(!0)};a.vars.playerUnHoverHandler=function(){!a.isDesktopVerticalLightBox()&&!a.isSingleVideoLightbox()||
a.shouldDisablePlayerOverlayInteractions()||a.toggleLightboxCloseButton(!1)};b.hover(function(){return k()},function(){return a.vars.playerUnHoverHandler()});a.dom.$wrapper.find("."+f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME).hover(function(){k();a.vars.isFeedbackClosed&&a.showFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer)});b.keyup(function(b){clearTimeout(void 0);if(9==b.keyCode||16==b.keyCode)a.vars.includeVideoInformationOverPlayer?a.showPlayerOverlayFeatures():null!==a.vars.feedbackContainer&&
a.showFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer),a.toggleLightboxCloseButton(!0)});c.keyup(function(b){9!=b.keyCode&&16!=b.keyCode||b.target.closest("#"+a.vars.containerId)||(a.vars.includeVideoInformationOverPlayer?a.hidePlayerOverlayFeatures():a.hideFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer),(a.isDesktopVerticalLightBox()||a.isSingleVideoLightbox())&&a.toggleLightboxCloseButton(!1))})}};this.showPlayerOverlayFeatures=function(b){a.showActiveMetadataOverPlayer(b);
a.showFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer)};this.hidePlayerOverlayFeatures=function(){a.hideActiveMetadataOverPlayer();a.shouldDisablePlayerOverlayInteractions()||a.hideFeedbackLinkWithoutDimmingThePlayer(a.vars.feedbackContainer,a.vars.playerContainer)};this.setupKeyPressEventHandlerForRelatedProductsCarousel=function(){a.dom.$relatedProductContainer.keyup(function(b){9===b.keyCode&&(a.dom.$relatedProductContainer.find(".a-carousel-col").css("display","block"),a.dom.$relatedProductContainer.mouseout(function(){a.dom.$relatedProductContainer.find(".a-carousel-col").css("display",
"")}))})};this.toggleLightboxCloseButton=function(b){0<a.dom.$wrapper.find("."+f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME).length&&a.dom.$wrapper.find("."+f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME).toggleClass("vse-show",b)};this.feedBackMouseLeaveHandler=function(){a.vars.isFeedbackClosed?a.vars.includeVideoInformationOverPlayer?a.hidePlayerOverlayFeatures():a.hideFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer):a.toggleLightboxCloseButton(!0);a.vars.cursorOnVideoPlayerDiv=!1};this.isSingleVideoLightbox=
function(){return 0<a.vars.A.$("#"+a.vars.popoverName+"-wrapper").length?0<=a.vars.A.$("#"+a.vars.popoverName+"-wrapper").attr("data-css-class").indexOf("vse-single-video-lb"):!1};this.showHideElementsForMultiCarousel=function(){setTimeout(function(){a.toggleElementsForMultiCarouselIfRequired(a.vars.multiCarouselExpanded)},a.vars.multiCarouselExpanded?250:0)};this.toggleElementsForMultiCarouselIfRequired=function(b){a.A.$("#"+a.vars.templateId+" ."+f.VIPScrubberClassName).toggleClass("aok-hidden",
b);a.A.$("#"+a.vars.templateId+" ."+f.VIPPlayPauseClassName).toggleClass("aok-hidden",b);a.A.$("#"+a.vars.templateId+" "+f.VIPFeedbackContainer).toggleClass("aok-hidden",b);a.A.$("#"+a.vars.templateId+" ."+f.VIPVideoHelpfulVotesClassName).toggleClass("aok-hidden",b);a.showHideCRVMetadataForChannelCarousel(b)};this.showHideCRVMetadataForChannelCarousel=function(b){a.vars.useChannelCarousel&&a.isCustomerReviewVideo(a.vars.currentAssetSpec)&&(a.A.$("#"+a.vars.templateId+" "+a.vars.expandButtonSelector).toggleClass("hideExpandButton",
b),a.isLandscapeView()&&(a.A.$("#"+a.vars.templateId+" "+f.CRVInfoSelector).toggleClass("aok-hidden",b),a.vars.updateCRText=!b,a.updateCRTextIfRequired()))};this.openCloseMultiCarousel=function(){a.vars.multiCarouselExpanded?(a.vars.hideWatchIcon||a.vars.videoActionTrayComponents.reset(),a.A.$("#"+a.vars.templateId+" "+f.VIPMultiCarouselWrapper).removeClass(f.VIPMultiCarouselExpandedClass),a.showHideElementsForMultiCarousel(),a.A.$("#"+a.vars.templateId+" "+f.VIPSearchButtonSelector).removeClass("aok-hidden"),
a.resetUserActivityTimer(),a.vars.multiCarouselExpanded=!1,a.vars.keepMultiCarouselOpen=!1):(a.resetUserActivityTimer(-2),a.A.$("#"+a.vars.templateId+" "+f.VIPMultiCarouselWrapper).addClass(f.VIPMultiCarouselExpandedClass),a.showHideElementsForMultiCarousel(),a.A.$("#"+a.vars.templateId+" "+f.VIPSearchButtonSelector).addClass("aok-hidden"),a.vars.multiCarouselExpanded=!0)};this.removeAriaHiddenFromCarouselCards=function(){var b=document.querySelectorAll("#"+a.vars.popoverId+" li.vse-video-card"),
c=Array.prototype.slice.call(b);c&&a.vars.A.delay(function(){c.forEach(function(a){a.setAttribute("aria-hidden","false")})},300)};this.isGroupOne=function(b){if(b.groupType)return-1!==b.groupType.indexOf(f.G1);if(!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1))for(var c=a.vars.multiCarouselS1.getplaylist(),d=0;d<c.length;d++)if(c[d].contentId===b.contentId)return!0;return!1};this.isGroupTwo=function(b){if(b.groupType)return-1!==b.groupType.indexOf(f.G2);if(!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2))for(var c=
a.vars.multiCarouselS2.getplaylist(),d=0;d<c.length;d++)if(c[d].contentId===b.contentId)return!0;return!1};this.isInPlayList=function(b){if(!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)&&b)for(var c=a.vars.relatedVideosCarousel.getplaylist(),d=0;d<c.length;d++)if(c[d].contentId===b.contentId)return!0;return!1};this.getActiveAsset=function(){var b=a.vars.currentAssetSpec;if(a.vars.useChannelCarousel)return null==b.segmentNumber||a.vars.A.objectIsEmpty(a.vars.channelCarousels[b.segmentNumber])||
(b=a.vars.channelCarousels[b.segmentNumber].getActiveAsset()),b;if(a.vars.useMultiCarousel){var c=a.isGroupOne(b),d=a.isGroupTwo(b),c=a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)?!1:c,d=a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)?!1:d;c&&!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)?b=a.vars.multiCarouselS1.getActiveAsset():d&&!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)&&(b=a.vars.multiCarouselS2.getActiveAsset());return b}return a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)?a.vars.currentAssetSpec:
a.vars.relatedVideosCarousel.getActiveAsset()!==u?a.vars.relatedVideosCarousel.getActiveAsset():a.vars.currentAssetSpec};this.getCombinedPlaylist=function(){var b=[];if(a.vars.useChannelCarousel){if(!a.vars.A.objectIsEmpty(a.vars.channelCarousels))for(var c=0,d=a.vars.channelCarousels;c<d.length;c++)b=b.concat(d[c].getplaylist());return b}return a.vars.useMultiCarousel?(a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||(b=b.concat(a.vars.multiCarouselS1.getplaylist())),a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||
(b=b.concat(a.vars.multiCarouselS2.getplaylist())),b):a.vars.showSingleLBOverlay?[a.vars.currentAssetSpec]:a.vars.relatedVideosCarousel.getplaylist()};this.setOrientationConfig=function(b){if(a.vars.useChannelCarousel){if(!a.vars.A.objectIsEmpty(a.vars.channelCarousels))for(var c=0,d=a.vars.channelCarousels;c<d.length;c++)d[c].setOrientationConfig(b)}else a.vars.useMultiCarousel?(a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||a.vars.multiCarouselS1.setOrientationConfig(b),a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||
a.vars.multiCarouselS2.setOrientationConfig(b)):a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.setOrientationConfig(b)};this.findIndex=function(b){var c=0;if(a.vars.useChannelCarousel){for(var d=0,f=a.vars.channelCarousels;d<f.length;d++){var h=f[d],n=h.findIndex(b);if(-1!=n)return c+n;c+=h.getplaylist().length}return-1}if(a.vars.useMultiCarousel){c=a.isGroupOne(b);d=a.isGroupTwo(b);if(!c&&!d)return-1;if(!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&c)return a.vars.multiCarouselS1.findIndex(b);
if(!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)&&!c)return c=a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)?0:a.vars.multiCarouselS1.getplaylist().length,c+a.vars.multiCarouselS2.findIndex(b)}else return a.isInPlayList(b)?a.vars.relatedVideosCarousel.findIndex(b):-1};this.markPlaying=function(b){if(b!==u)if(a.vars.useChannelCarousel)null==b.segmentNumber||a.vars.A.objectIsEmpty(a.vars.channelCarousels[b.segmentNumber])||(a.dom.$wrapper.find(f.VIPMultiCarouselContainer).find(".vse-video-card").removeClass("active"),
a.vars.channelCarousels[b.segmentNumber].markPlaying(b));else if(a.vars.useMultiCarousel){var c=a.isGroupOne(b),d=a.isGroupTwo(b),k=a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)?!1:c;!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&c?(a.vars.multiCarouselS1.markPlaying(b),a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||k||a.dom.$wrapper.find(f.VIPMultiCarouselTwoContainer).find(".vse-video-card").removeClass("active")):!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)&&d&&(a.vars.multiCarouselS2.markPlaying(b),
!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&k&&a.dom.$wrapper.find(f.VIPMultiCarouselOneContainer).find(".vse-video-card").removeClass("active"))}else a.isInPlayList(b)&&a.vars.relatedVideosCarousel.markPlaying(b)};this.rotateTo=function(b){if(a.vars.useChannelCarousel){for(var c=0,d=a.vars.channelCarousels;c<d.length;c++){var f=d[c];a.vars.A.objectIsEmpty(f)||f.removeActive()}null==b.segmentNumber||a.vars.A.objectIsEmpty(a.vars.channelCarousels[b.segmentNumber])||a.vars.channelCarousels[b.segmentNumber].rotateTo(b)}a.vars.useMultiCarousel?
(a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||a.vars.multiCarouselS1.removeActive(),a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||a.vars.multiCarouselS2.removeActive(),c=a.isGroupOne(b),!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&c?a.vars.multiCarouselS1.rotateTo(b):a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||a.vars.multiCarouselS2.rotateTo(b)):a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.rotateTo(b)};this.updateVotingElements=function(b,c,d){a.vars.useChannelCarousel?
null==b.segmentNumber||a.vars.A.objectIsEmpty(a.vars.channelCarousels[b.segmentNumber])||a.vars.channelCarousels[b.segmentNumber].updateVotingElements(c,d):a.vars.useMultiCarousel?(b=a.isGroupOne(b),!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&b?a.vars.multiCarouselS1.updateVotingElements(c,d):a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||a.vars.multiCarouselS2.updateVotingElements(c,d)):a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.updateVotingElements(c,
d)};this.updateVotingElementsForCountAndStatus=function(b,c,d){a.vars.useChannelCarousel?null==b.segmentNumber||a.vars.A.objectIsEmpty(a.vars.channelCarousels[b.segmentNumber])||a.vars.channelCarousels[b.segmentNumber].updateVotingElementsForCountAndStatus(c,d):a.vars.useMultiCarousel?(b=a.isGroupOne(b),!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&b?a.vars.multiCarouselS1.updateVotingElementsForCountAndStatus(c,d):a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||a.vars.multiCarouselS2.updateVotingElementsForCountAndStatus(c,
d)):a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.updateVotingElementsForCountAndStatus(c,d)};this.initializeMultiCarousel=function(b,c,d){a.emitRelatedVideosRenderMetric(f.METRIC_WATCH_THUMBNAIL_RENDER,c,d);b=a.vars.useChannelCarousel&&null!==d?f.VIPMultiCarouselContainer+"-"+d:b?f.VIPMultiCarouselOneContainer:f.VIPMultiCarouselTwoContainer;a.dom.$wrapper.delegate(b,"touchstart",function(b){a.vars.multiCarouselExpanded&&(a.vars.keepMultiCarouselOpen=!0,a.resetUserActivityTimer(-2),
b.stopPropagation())});a.dom.$wrapper.delegate(b,"touchend",function(b){a.vars.multiCarouselExpanded&&(a.vars.keepMultiCarouselOpen=!1,a.resetUserActivityTimer(-2),b.stopPropagation())})};this.relatedVideosCarouselNotEmpty=function(){return!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||!a.vars.A.objectIsEmpty(a.vars.channelCarousels)||!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)};this.toggleSingleLbCssClass=function(b){!a.vars.isMobile&&
a.dom.$wrapper&&a.dom.$wrapper.closest(f.LightboxWrapperSelector)&&a.dom.$wrapper.closest(f.LightboxWrapperSelector).toggleClass(f.SINGLE_VIDEO_LB_CSS_CLASS,b)&&setTimeout(function(){return a.vars.A.trigger("resize",{},{width:l.innerWidth,height:l.innerHeight})},200)};this.multiCarouselHandler=function(){a.vars.handleMultiCarousel&&(a.dom.$wrapper.delegate(f.VIPMultiCarouselWrapper,"click touchstart",function(b){if(a.vars.$(b.target).closest("a").length)return!0;if(!a.vars.keepMultiCarouselOpen){if(a.vars.multiCarouselExpanded&&
a.vars.$(f.vernacLanguageRadioBlockSelector).length)return!0;b.stopPropagation();b.preventDefault();a.vars.multiCarouselExpanded||a.emitClickMetric(f.METRIC_WATCH_HANDLE_CLICK);a.openCloseMultiCarousel()}a.vars.$(b.target).closest(".vse-video-card").length&&null!=a.vars.visualSearchComponent&&(a.vars.visualSearchComponent.hideSearchTooltip(!0),a.vars.isMultiCarouselClosedForFirstTime=!0)}),a.vars.handleMultiCarousel=!1)};this.vars={A:c,$:c.$,isMobile:!1,player:null,feedback:null,clientPrefix:null,
placement:null,containerId:null,contentId:null,productAsin:null,playerFactory:null,ingressRelatedVideosCarousel:null,relatedVideosCarousel:null,keepCarouselOpenOnLinkClick:!1,watchAllClicked:!1,keepProductCarouselOpenOnClick:!1,videoVoteContainerFactory:null,activeVideoVoteContainer:null,isMshop:!1,isContinuousPlayFinished:!1,isFeedbackClosed:!0,showVotes:!1,defaultEntityId:f.EMPTY_STRING,videoVoteFailure:!1,videoVoteConfig:null,ccvDisclosureConfig:null,currentAssetSpec:null,initialVideo:null,relatedProductsNilgiriRequestCount:0,
popoverId:null,relatedProductsRequest:null,cursorOnVideoPlayerDiv:!1,lightBoxPausedVideo:!1,verticalLightBoxMaxWidth:1024,relatedProductsContainerFixedHeight:115,currentIndex:0,socialSharePageState:null,mShopFactory:null,lightboxOpened:!1,lightboxCarouselRegistered:!1,playFullScreenVideo:!1,ingressHasInitialAssetSpec:!0,playlist:null,isVideoImmersivePlayer:!1,secondsFromLastActivity:0,intervalUserActivityHandlerId:0,isVIPOverlayTimerSet:!1,isVIPOverlayOnTapEventRegistered:!1,lightboxOpenedFirstTime:!0,
skipRelatedVideosWait:!1,videoActionTrayComponents:null,socialShareId:null,shareCopyLinkSuccessText:"",ingressCarousel:null,ingressPlaylist:null,widgetStartTime:0,isMetricRecorded:!1,carouselPageSize:0,nextPage:0,previousPage:0,vipVideoDuration:0,isScrubbing:!1,vipControlsShouldPause:!0,vipPlayPauseToggle:null,shouldShowProfiles:!1,popoverName:null,isUpNextComponentActive:!1,upNextTimeoutHandle:null,useUpNextComponent:!1,upNextString:f.EMPTY_STRING,cancelString:f.EMPTY_STRING,watchIconFirstOpen:!0,
shopIconFirstOpen:!0,manualTriggerWatchIcon:!1,manualTriggerShopIcon:!1,customerReviewsConfig:null,useAutoplayFallback:!1,vipPlayIconClicked:!1,contentIdProductAsinMap:{},showLightboxV2Experience:!1,playerContainer:null,feedbackId:null,feedbackContainer:null,showContentCarousel:!0,useMultiCarousel:!1,useChannelCarousel:!1,hideWatchIcon:!1,multiCarouselExpanded:!1,handleMultiCarousel:!0,keepMultiCarouselOpen:!1,multiCarouselS1:null,multiCarouselS2:null,channelCarousels:[],isSwipingMultiCarousel:!1,
showPFOOnOverlay:!1,cacheOnProductAsin:!1,onSiteAttributionMetrics:null,useAllIVXComponents:!0,viewportMetaTag:null,viewportMetaTagContent:null,isClosedCaptionEnabled:!1,currentClosedCaptionsLang:null,closedCaptionsConfig:{},closedCaptionsTooltipTimerId:0,shouldHandleCCForLandscapeVideo:!1,playerUnHoverHandler:function(){},setMaxHeightToLBLeftColumn:!1,seekTime:0,rankingStrategy:f.EMPTY_STRING,videoUrlInlineVideoKey:f.EMPTY_STRING,showMoreMenuExperience:!1,disableFullScreenOnMshop:!1,disableCreatorClicksOnMshop:!1,
vipControlsShouldMute:!0,vipMuteUnmuteToggle:null,currentPlayerMode:"",inlinePlayerInitialized:!1,firstRelatedProductOverride:null,isMultiCarouselClosedForFirstTime:!1,showHotspots:!1,isHotspotsWeblabTriggered:!1,isVideoTypeLabelPresent:!1,isTimeoutComplete:!1,showHeroExperience:!1,relatedProductsContainer:f.EMPTY_STRING,includeVideoInformationOverPlayer:!1,showSingleLBOverlay:!1,auiTruncate:null,updateCRText:!0,truncateWidgetId:"",expandButtonSelector:"",complementaryAsins:{},CRV_TEXT_VERTICAL_PADDING_PX:44,
isWeblabTriggeredMap:{},detachedCarousels:{},currentCarouselContentId:null};this.dom={$wrapper:null,$lbContainer:null,$lbLeftColumn:null,$lbLeftColumnPlaceholder:null,$lbRightColumn:null,$lbCCHeader:null,$lbTabContainer:null,$videoAuthor:null,$playerContainer:null,$mobileFixedContainer:null,$mobileMovableContainer:null,$relatedProductContainer:null,relatedProductsParentEl:null,$activeVideoOspLink:null,$activeVideoTitlePrefix:null,$activeVideoCRLink:null,$lbVideoCarousel:null,$activeVideoCustomerProfile:null,
$customerProfileContainer:null,$videoAuthorBlock:null,$activeVideoCRLinkWrapper:null,$profileLinkSelector:null,$followButtonSelector:null,$followEligibleCreator:null,$activeMetadataContainer:null};this.refTagRecorder=new J(c)}d.prototype.moveMetadataOverPlayer=function(c){c&&0<c.length&&this.vars.$(this.vars.playerContainer).prepend(c)};d.prototype.updateCRTextIfRequired=function(){this.vars.updateCRText&&(this.updateExpandWidgetOverlayText(this.vars.truncateWidgetId,this.vars.expandButtonSelector),
this.vars.updateCRText=!1)};d.prototype.isValidEntityToFollow=function(c){return!this.vars.A.objectIsEmpty(c.entityId)&&!this.vars.A.objectIsEmpty(c.entityType)&&c.entityId!==this.vars.defaultEntityId};d.prototype.hideFollowElements=function(){this.dom.$followEligibleCreator.length&&this.dom.$followEligibleCreator.addClass("vse-hidden");this.dom.$vseFollowClassSelector.addClass("vse-hidden")};d.prototype.hideFollowEligibleCreator=function(){this.dom.$followEligibleCreator.length&&this.dom.$followEligibleCreator.addClass("vse-hidden")};
d.prototype.updateFollowButtonAttributes=function(c){this.dom.$followButtonSelector.attr("data-type",c.entityType);this.dom.$followButtonSelector.attr("data-entity-id",c.entityId)};d.prototype.handleFollowButtonInitialization=function(){var c=this.dom.$followButtonSelector.attr("data-initialize"),a=this.dom.$followButtonSelector.attr("data-entity-id"),b=this.dom.$followButtonSelector.attr("data-type"),d=this.dom.$followButtonSelector.get(0);this.dom.$vseFollowClassSelector.removeClass("vse-hidden");
"false"===c?this.initializeNewFollowButton(b,a,d):this.reinitializeExistingButton(b,a,d)};d.prototype.initializeNewFollowButton=function(c,a,b){this.dom.$followButtonSelector.attr("data-initialize","true");v.now("follow-button-v3").execute(function(d){d?d.all().some(function(a){return"vsefollow"===a.element.id})?d.reInitializeButton(c,a,b):d.initializeButton(b):v.trigger("vsefollow")})};d.prototype.reinitializeExistingButton=function(c,a,b){v.now("follow-button-v3").execute(function(d){b&&d.reInitializeButton(c,
a,b)})};d.prototype.logFollowButtonError=function(c,a){m.logError(f.ATTRIBUTION_NAME,"Cannot update follow button. Video: "+c.contentId+", entityId: "+c.entityId,a)};d.prototype.getAciContentIdFromPlayerInstance=function(){try{return this.vars.player.player.playerInstance.config.aciContentId}catch(c){m.logError(f.ATTRIBUTION_NAME,"Failed to get aciContentId for the asset: "+this.vars.currentAssetSpec.contentId+" ",c)}};d.prototype.isDifferenceGreaterThan24Hours=function(c,a){return 24<(c-a)/36E5};
d.prototype.isCustomerReviewVideo=function(c){return c.vendorCode?"AOD60"==c.vendorCode:!1};d.prototype.isInfluencerVideo=function(c){return c.creatorType?"influencer"===c.creatorType.toLowerCase():!1};d.prototype.getLocalStorage=function(c){try{return localStorage.getItem(c)}catch(a){return null}};d.prototype.setLocalStorage=function(c,a){try{localStorage.setItem(c,a)}catch(b){}};return d}(),ya=f.VAP_EW+"subcomponent/",ga=function(){function d(){}d.getLazyLoadComponents=function(c,a,b,f,m){c.$("#"+
a+" div[data-configuration]").each(function(){d.callSubComponentBuilder({A:c,context:b,handleFailure:m,handleSuccess:f},c.$(this),3)})};d.callSubComponentBuilder=function(c,a,b){var f=c.A,l=c.context,k=c.handleFailure,h=c.handleSuccess,n=atob(a.attr("data-configuration")),p=JSON.parse(n),n=b,e={pageContext:l,configuration:p},x=f.now();b--;var q=n-b-1;z.sendRequest(f,ya+p.type,e,function(b){var c=f.now()-x;m.count("vse_component_lazyLoaderHook:success:",c);m.count("vse_component_lazyLoaderHook:success:"+
l.page+":"+l.placement+":"+p.type+":"+q,1);a.html(b);h(f,e)},function(h){(0===h.http.status||500<=h.http.status&&599>=h.http.status)&&0<b?(m.count("vse_component_lazyLoaderHook:error:"+l.page+":"+l.placement+":"+p.type+":"+q,1),d.callSubComponentBuilder(c,a,b)):(m.count("vse_component_lazyLoaderHook:failure",1),k(f,e))})};return d}();try{var za=function(d){return new d(function(c,a){v.when("A","a-carousel-framework","a-carousel-constants","3p-promise","a-button","ready").register("VSEComponentAssets",
function(a,d,p,k,h){return{setClientPrefix:function(c,t){var e=new fa(a);e.vars.clientPrefix=c;e.vars.setMaxHeightToLBLeftColumn=t.setMaxHeightToLBLeftColumn||!1;e.vars.templateId=t.templateId;e.vars.showLightboxV2Experience=t.showLightboxV2Experience||!1;e.vars.isMobile=a.capabilities.mobile;e.vars.disableFullScreenOnMshop=t.disableFullScreenOnMshop||!1;e.vars.skipRelatedVideosWait=t.callRelatedProductsWithoutRelatedVideos||!1;e.vars.A.objectIsEmpty(t)||(t.hasOwnProperty(f.IS_VIDEO_IMMERSIVE_PLAYER_KEY)&&
(e.vars.isVideoImmersivePlayer=t.isVideoImmersivePlayer),t.hasOwnProperty(f.SHOW_CONTENT_CAROUSEL)&&(e.vars.showContentCarousel=t.showContentCarousel));a.off("vse:ns:player:"+e.vars.clientPrefix+":init");a.off("vse:ns:metadata:"+e.vars.clientPrefix+":init");a.off("vse:ns:socialShare:"+e.vars.clientPrefix+":init");a.off("vse:ns:feedback:"+e.vars.clientPrefix+":init");a.off("vse:ns:relatedProducts:"+e.vars.clientPrefix+":init");a.off("vse:ns:relatedVideos:"+e.vars.clientPrefix+":init");a.off("vse:ns:relatedVideosVernacularExperience:"+
e.vars.clientPrefix+"init");a.off("vse:ns:ingressCarousel:"+e.vars.clientPrefix+":init");a.off("vse:"+e.vars.clientPrefix+":page:lightBoxOpened");a.off("vse:"+e.vars.clientPrefix+":page:lightBoxClosed");a.off("vse:"+e.vars.clientPrefix+":lazyload:relatedvideos:succeeded");a.off("vse:"+e.vars.clientPrefix+":page:watchAllClicked");a.off("vse:ns:"+e.vars.clientPrefix+":hideAdditionalUXFeatures");a.off("vse:ns:inlinePlayer:"+e.vars.clientPrefix+":init");v.when("mash").execute("VSEComponentAsset-Mash-Detection",
function(a){e.vars.isMshop=!0;e.vars.mShopFactory=a});v.when("A","a-truncate").execute("ive-expand-component",function(a,b){e.vars.auiTruncate=b});a.on("vse:ns:player:"+e.vars.clientPrefix+":init",function(d){try{var g=y.fetchLatestPageState(a,d);if(g){m.count(f.PLAYER_INITIALIZED+":"+e.vars.clientPrefix,1);var h=g.awaConfig;e.vars.isMobile=g.isMobile;e.vars.productAsin=g.productAsin;e.vars.playFullScreenVideo=g.enableFullScreenByDefault;e.vars.contentId=h.initialVideo;e.vars.shouldLoop=h.shouldLoop;
e.vars.containerId=h.containerId;e.vars.playerContainer="#"+e.vars.containerId+"-container";e.vars.placement=h.nexusMetricsConfig.placementContext;e.vars.nexusMetricsConfig=h.nexusMetricsConfig;e.vars.useUpNextComponent=h.useUpNextComponent;e.vars.enableClickBasedAttribution=h.enableClickBasedAttribution;e.vars.aciContentId=h.aciContentId;e.vars.linkCode=h.ospLinkCode;e.vars.customerId=h.customerId;e.vars.useAutoplayFallback=h.useAutoplayFallback;e.vars.useUpNextComponent&&(e.vars.upNextString=g.upNextString?
g.upNextString:"UP NEXT",e.vars.cancelString=g.cancelString?g.cancelString:"CANCEL");d={gatedP:D,EventEmitter:K,promise:k};var l={videoUrl:g.videoUrl,contentId:e.vars.contentId,vendorCode:g.vendorCode,vendorTrackingId:g.vendorTrackingId,productAsin:g.productAsin,videoReferenceId:g.videoReferenceId,eventTimestamp:e.vars.A.now(),imageUrl:g.imageUrl,duration:0,refTag:f.EMPTY_STRING,rankingStrategy:f.EMPTY_STRING,aciContentId:g.aciContentId,mimeType:g.mimeType,videoTitle:g.videoTitle,altText:g.altText,
creatorType:g.creatorType};e.setVideoDetails(e.vars.contentId,g);var p=g.initialClosedCaptions;e.vars.A.objectIsEmpty(p)||e.setInitialClosedCaptions(l,p);e.vars.isVideoImmersivePlayer&&e.setupVIPClosedCaptions(g.closedCaptionsConfig,p);h.initialVideo=l;e.vars.playerFactory=new W(d);if(e.vars.A.objectIsEmpty(g.inlinePlayerConfig)||!0!==g.needPlayerFactory){e.vars.player=e.vars.playerFactory.create(h);!e.vars.isVideoImmersivePlayer&&e.vars.playFullScreenVideo&&(e.vars.player.aspectRatio(e.getAspectRatio(e.getDeviceOrientation())),
e.vars.player.fluid(!1));e.vars.isVideoImmersivePlayer&&(e.vars.player.on("playerClick",e.onPlayerTapHandler),e.vars.player.on("texttrackenable",e.onTextTrackEnable),e.vars.useAutoplayFallback&&(e.vars.player.on("autoplayFailed",e._playerFailedAutoplayHandler),e.vars.player.on("autoplaySucceeded",e._playerSucceededAutoplayHandler)));e.attachPlayerEventListeners();if(e.vars.A.objectIsEmpty(h.osaInstrumentationConfig))m.count(e.vars.clientPrefix+".noOsaInstrumentationConfig",1);else{var t={$container:e.vars.A.$("#"+
e.vars.containerId),schemaId:h.osaInstrumentationConfig.schemaId,producerId:h.osaInstrumentationConfig.producerId};e.vars.onSiteAttributionMetrics=new Q(t,e.vars.player,e.vars.A,e.vars.isVideoImmersivePlayer,e.vars.clientPrefix)}"nexus"===h.metricsEmissionMethod&&e.vars.nexusMetricsConfig&&(e.vars.buildNexusPayload=F.makeApplicationNexusPayloadBuilder(e.vars.A,e.vars.nexusMetricsConfig),e.vars.emitMetricsToNexus=!0);var r=e.vars.A.$("#ive-"+e.vars.clientPrefix+"-player-label-container");r.length&&
e.vars.A.$(e.vars.playerContainer).append(r);e.vars.A.trigger("vsePlayer-"+e.vars.clientPrefix,{player:e.vars.player,containerId:e.vars.containerId});e.vars.A.trigger(e.vars.clientPrefix+":vse:player:registered")}else e.vars.A.trigger("ivePlayerFactory-"+e.vars.clientPrefix,{playerFactory:e.vars.playerFactory})}else m.count(f.PLAYER_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-player-"+d+"-initialization-failed")}catch(u){m.logFatal(f.ATTRIBUTION_NAME+
":"+e.vars.clientPrefix,"Fatal during player initialization.",u),m.count(c+".playerInitializationFatal",1)}});a.on("vse:ns:metadata:"+e.vars.clientPrefix+":init",function(d){try{var g=y.fetchLatestPageState(a,d);if(g){e.vars.defaultEntityId=g.defaultEntityId;g.entityId&&g.entityType&&e.setFollowEntities(g.entityId,g.entityType);g.showSingleLBOverlay&&(e.vars.showSingleLBOverlay=!0,e.vars.includeVideoInformationOverPlayer=!0);e.vars.showUploadDate=g.showUploadDate;e.vars.videoVoteConfig=g.videoVoteConfig;
e.vars.ccvDisclosureConfig=g.ccvDisclosureConfig;e.vars.videoVoteConfig=a.$.extend({},e.vars.videoVoteConfig);e.vars.isRedesignLBEligibleToTrigger=g.isRedesignLBEligibleToTrigger;d={gatedP:D,promise:k};if(e.vars.videoVoteConfig.hasOwnProperty("placementContext")){e.vars.videoVoteConfig.dependencies=d;e.vars.videoVoteContainerFactory=new M(a,e.vars.videoVoteConfig);var h="#vse-video-votes-lb-details-"+e.vars.videoVoteConfig.placementContext,l=0<e.vars.A.$("#"+e.vars.templateId+" "+h).length?"#"+e.vars.templateId+
" "+h:h;e.vars.activeVideoVoteContainer=e.vars.videoVoteContainerFactory.createFromSelector(l)}g.nexusMetricsConfig&&(e.vars.nexusMetricsConfig=g.nexusMetricsConfig,e.vars.buildNexusPayload=F.makeApplicationNexusPayloadBuilder(e.vars.A,e.vars.nexusMetricsConfig),e.vars.emitMetricsToNexus=!0,e.vars.customerId=e.vars.customerId||g.nexusMetricsConfig.customerId);g.customerReviewConfig&&(e.vars.customerReviewsConfig=g.customerReviewConfig,e.vars.customerReviewsConfig.showCustomerReviewMetadata&&(e.vars.A.delay(function(){e.compactReviewIfNeeded();
e.updateReviewsExpandButtonVisibility()},250),e.attachReviewsPlayerEventListeners(),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-expand-review-content:click"),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-expand-review-content:touch"),e.vars.A.declarative(e.vars.clientPrefix+"-expand-review-content","click touch",function(a){e.isReviewTextOverflow()&&!e.isReviewTextExpanded()&&(e.vars.$(f.VIPOverlaySelector).addClass("vse-reviews-expand-full-cr"),e.resetReviewTextStyle(),e.styleExpandedReviewText(),
e.pauseVideoIfNeeded())}),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-collapse-review-content:click"),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-collapse-review-content:touch"),e.vars.A.declarative(e.vars.clientPrefix+"-collapse-review-content","click touch",function(a){e.vars.$(f.VIPOverlaySelector).removeClass("vse-reviews-expand-full-cr");e.vars.$(".vse-reviews-content-ellipsis-wrapper").scrollTop(0);e.resetReviewTextStyle();e.vars.A.animationFrameDelay(function(){e.compactReviewIfNeeded();
e.updateReviewsExpandButtonVisibility()});e.vars.vipControlsShouldPause&&e.resumeVideoIfNeeded()}),e.vars.A.on("resize",e.handleReviewsOnResize)));e.vars.A.trigger(e.vars.clientPrefix+":vse:metadata:registered")}else m.count(f.METADATA_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-metadata-"+d+"-initialization-failed")}catch(p){m.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during metadata initialization.",p),m.count(c+".metadataInitializationFatal",
1)}});a.on("vse:ns:socialShare:"+e.vars.clientPrefix+":init",function(d){try{var g=y.fetchLatestPageState(a,d);if(g){e.vars.socialSharePageState=d;e.vars.socialShareId=g.id;e.vars.shareCopyLinkSuccessText=g.copySuccessText;e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-social-share-mshop-action:click");e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-social-share-mshop-action:touch");e.vars.A.declarative(e.vars.clientPrefix+"-social-share-mshop-action","click touch",function(a){e.vars.isMshop&&
!e.vars.A.objectIsEmpty(e.vars.mShopFactory)&&(a=e.getActiveAsset(),a=e.getMshopShareParams(a),e.vars.mShopFactory.share(a))});if(!e.vars.isMobile){var h=e.vars.A.$("#"+e.vars.socialShareId+"-trigger [aria-expanded]");a.off("a:popover:afterShow:"+e.vars.socialShareId+"-popover");a.on("a:popover:afterShow:"+e.vars.socialShareId+"-popover",function(){var a={eventName:f.METRIC_SHARE_ICON,stringPayload:f.EMPTY_STRING,intPayload:1,videoAsin:e.getVideoAsin(),rankingStrategy:e.getRankingStrategy(),groupType:e.getGroupType(),
titleSessionId:e.vars.player?e.vars.player.getTitleSessionId().toString():""};e.emitMetricToNexus(a);h.attr("aria-expanded","true")});a.off("a:popover:beforeHide:"+e.vars.socialShareId+"-popover");a.on("a:popover:beforeHide:"+e.vars.socialShareId+"-popover",function(){h.attr("aria-expanded","false")});l.isSecureContext&&navigator.clipboard||e.vars.A.$("#"+e.vars.socialShareId+"-copy").addClass("aok-hidden")}e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-swf-share-network:click");e.vars.A.declarative(e.vars.clientPrefix+
"-swf-share-network","click",function(a){a=a.data;var b=e.vars.A.state(e.vars.socialSharePageState);ha.share(b,a.network);m.count(f.socialShareClickMetricName,1);e.emitClickMetric(f.METRIC_SHARE_SELECTION_CLICK)});e.vars.A.trigger(e.vars.clientPrefix+":vse:socialShare:registered")}else m.count(f.SOCIAL_SHARE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-social-share-"+d+"-initialization-failed")}catch(k){m.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,
"Fatal during socialShare initialization.",k),m.count(c+".socialShareInitializationFatal",1)}});a.on("vse:ns:feedback:"+e.vars.clientPrefix+":init",function(a,b){try{var d=y.fetchLatestPageState(e.vars.A,a);if(d){var g=d.id;e.vars.feedbackId=g;e.vars.feedbackContainer="#vse-"+e.vars.clientPrefix+"-feedback-container";e.vars.cursorOnVideoPlayerDiv=!1;e.deRegisterFeedback(g);b="true"===b;e.vars.showMoreMenuExperience=b;e.vars.showMoreMenuExperience&&(e.vars.$(e.vars.feedbackContainer).css({display:"inline-block"}),
e.handleMoreMenuMetric());e.vars.A.on("vse:"+g+":feedback:shown",function(){e.pauseVideoIfNeeded();e.vars.isFeedbackClosed=!1;e.vars.$(".vse-fb-copyright").click(function(a){e.vars.isMshop&&e.vars.isVideoImmersivePlayer&&(a.preventDefault(),e.vars.feedback.showInfringementNotSupport())});e.vars.$(".vse-fb-report-illegal-content").click(function(a){e.vars.isMshop&&e.vars.isVideoImmersivePlayer&&(e.vars.feedback.closeFeedbackForm(),e.openExternalLinkFromLightBox(a))});e.vars.showMoreMenuExperience?
e.vars.$("#vse-report-trigger").click(function(a){a.preventDefault();e.emitClickMetric(f.METRIC_REPORT_CLICK)}):e.emitClickMetric(f.METRIC_REPORT_CLICK)});e.vars.A.off("vse:"+g+":feedback:submitted:success");e.vars.A.on("vse:"+g+":feedback:submitted:success",function(){e.emitClickMetric(f.METRIC_REPORT_SUBMIT);m.count(f.METRIC_REPORT_SUBMIT,1)});e.vars.A.on("vse:"+g+":feedback:hidden",function(){e.vars.vipControlsShouldPause&&e.resumeVideoIfNeeded();e.vars.isFeedbackClosed=!0;e.vars.showMoreMenuExperience?
e.vars.isVideoImmersivePlayer||e.vars.cursorOnVideoPlayerDiv||e.hideFeedbackLink(e.vars.feedbackContainer,e.vars.playerContainer):e.vars.cursorOnVideoPlayerDiv||e.hideFeedbackLink(e.vars.feedbackContainer,e.vars.playerContainer);e.vars.showMoreMenuExperience&&e.vars.$("#vse-report-trigger").unbind("click");e.vars.$(".vse-fb-copyright").unbind("click");e.vars.isMshop&&e.vars.mShopFactory&&e.vars.A.delay(function(){e.vars.mShopFactory.dispatchEvent({type:"appOverlays.Hide"})},500)});var k=new ra({A:e.vars.A,
buttonApi:h});e.vars.feedback=k.create(g,a,b);e.updateFeedback(e.vars.currentAssetSpec);e.vars.isFeedbackClosed=!0;var l=e.vars.A.$(e.vars.feedbackContainer);e.vars.showMoreMenuExperience&&e.vars.isVideoImmersivePlayer?e.vars.A.$("#"+e.vars.templateId+" .vse-lb-actions-container").prepend(l):e.vars.A.$(e.vars.playerContainer).append(l);e.vars.isVideoImmersivePlayer||(e.vars.A.declarative.create(e.vars.$(e.vars.playerContainer),"feedback-overlays-player",{}),e.vars.A.declarative("feedback-overlays-player",
"mouseenter touchstart focus",function(){e.vars.isFeedbackClosed&&e.showFeedbackLink(e.vars.feedbackContainer,e.vars.playerContainer);e.vars.cursorOnVideoPlayerDiv=!0;e.vars.A.capabilities.touch&&e.vars.A.delay(e.feedBackMouseLeaveHandler,3E3)}),e.vars.A.declarative("feedback-overlays-player","mouseleave",e.feedBackMouseLeaveHandler));e.vars.A.trigger(e.vars.clientPrefix+":vse:feedback:registered")}else m.count(f.FEEDBACK_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-feedback-"+
a+"-initialization-failed")}catch(p){m.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during feedback initialization.",p),m.count(c+".feedbackInitializationFatal",1)}});a.on("vse:ns:relatedProducts:"+e.vars.clientPrefix+":init",function(a){try{!e.vars.isVideoImmersivePlayer||!e.vars.A.objectIsEmpty(e.vars.videoActionTrayComponents)&&e.vars.useMultiCarousel||(e.initializeVideoActionTray(null),e.setVIPOrientationProperties({carouselCardWidth:a}),setTimeout(function(){return e.handleKeepProductCarouselOpen()},
500))}catch(b){m.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during related products initialization.",b),m.count(c+".relatedProductsInitializationFatal",1)}});a.on("vse:ns:relatedVideos:"+e.vars.clientPrefix+":init",function(h){try{var q=y.fetchLatestPageState(a,h);if(q){e.vars.complementaryAsins=q.complementaryProducts?q.complementaryProducts.contentIdToComplementaryAsins:{};e.vars.currentAssetSpec&&e.showRelatedProducts(e.vars.currentAssetSpec);e.vars.skipRelatedVideosWait=!0;var t=
new N(d,p,a,{gatedP:D,promise:k});e.vars.useMultiCarousel=q.useMultiCarousel;e.vars.useChannelCarousel=q.useChannelCarousel;e.vars.emitMetricsToNexus=!!e.vars.nexusMetricsConfig;e.vars.enableWidgetMetricsAfterOneSecond=q.enableWidgetMetricsAfterOneSecond;e.vars.emitMetricsToNexus&&(e.vars.buildNexusPayload=F.makeApplicationNexusPayloadBuilder(e.vars.A,e.vars.nexusMetricsConfig));e.vars.hideWatchIcon=q.hideWatchIcon;e.vars.disableCreatorClicksOnMshop=q.disableCreatorClicksOnMshop;d.createAll();d.initializeAll();
e.vars.useChannelCarousel?(0===q.segmentNumber&&(e.vars.channelCarousels=[]),e.vars.channelCarousels[q.segmentNumber]=t.create(q),e.initializeMultiCarousel(!0,e.vars.channelCarousels[q.segmentNumber],q.segmentNumber),2===e.vars.channelCarousels.length&&e.vars.A.$("#"+e.vars.templateId+" "+f.VIPMultiCarouselWrapper).addClass("vse-vip-two-carousels"),e.multiCarouselHandler(),e.vars.A.on("resize",e.handleMultiChannelReviewIVXOnResize)):e.vars.useMultiCarousel?(e.vars.multiCarouselS2=null,-1!==q.carouselName.indexOf("-G2")||
-1!==q.carouselName.indexOf("-G4")?(e.vars.multiCarouselS2=t.create(q),e.initializeMultiCarousel(!1,e.vars.multiCarouselS2)):(e.vars.multiCarouselS1=t.create(q),e.initializeMultiCarousel(!0,e.vars.multiCarouselS1)),e.vars.A.objectIsEmpty(e.vars.multiCarouselS1)||e.vars.A.objectIsEmpty(e.vars.multiCarouselS2)||e.vars.A.$("#"+e.vars.templateId+" "+f.VIPMultiCarouselWrapper).addClass("vse-vip-two-carousels"),e.multiCarouselHandler()):e.vars.relatedVideosCarousel=t.create(q);e.removeAriaHiddenFromCarouselCards();
q.shouldUseVerticalThumbnail&&e.vars.A.delay(e.handleTooltipDisplayToShowCustomerReview,500);e.vars.A.declarative(q.carouselName+"-seeMoreRelatedVideosButtonClick","click touch",function(a){try{var b=a.$currentTarget.get()[0],c=e.vars.A.$(b).find("[data-segment-id]").attr("data-segment-id");e.emitClickMetric(f.METRIC_LB_SHOW_MORE_BUTTON_CLICK,c)}catch(d){m.logError(f.ATTRIBUTION_NAME,"Event target is undefined for show more click",d)}});e.vars.A.on("vse:contentCarousel:"+q.carouselName+":click",function(c){e.vars.A.objectIsEmpty(e.vars.player)||
(null!=e.vars.onSiteAttributionMetrics&&e.vars.onSiteAttributionMetrics.emitCarouselClickEvent(),e.vars.player.play(c),a.trigger("vse:ns:partialcomponents:"+e.vars.clientPrefix+":relatedvideos:click",c),e.vars.currentIndex=e.findIndex(c),e.vars.showVotes=e.shouldShowVotes(c),e.show(c),e.vars.currentAssetSpec=c,e.vars.showLightboxV2Experience&&e.resizeLB(),e.vars.useMultiCarousel&&e.vars.multiCarouselExpanded&&e.openCloseMultiCarousel(),e.emitClickMetric(f.METRIC_LB_THUMBNAIL_CLICK),e.vars.isVideoImmersivePlayer&&
(e.vars.isUpNextComponentActive&&e.removeUpNextComponent(),e.vars.videoActionTrayComponents.updateActiveVideoContentId(c),e.resetUserActivityTimer(),e.showVideoImmersivePlayerOverlay(),e.vars.isVIPOverlayTimerSet||(e.vars.intervalUserActivityHandlerId=e.userActivityCountDown()),e.vars.videoActionTrayComponents.reset(),e.emitClickMetric(f.METRIC_WATCH_THUMBNAIL_CLICK)),e.removeAriaHiddenFromCarouselCards())});e.vars.A.on("vse:ns:partialcomponents:"+e.vars.clientPrefix+":relatedvideos:rotate",function(a){e.vars.currentIndex=
e.findIndex(a);a=e.getCurrentlyPlayingVideoInCarousel(e.vars.currentIndex);e.show(a)});if(e.isImageBlockVIP()||-1==e.vars.currentIndex)e.vars.currentIndex=e.findIndex(e.vars.currentAssetSpec);var r=-1==e.vars.currentIndex?e.vars.currentAssetSpec:e.getCurrentlyPlayingVideoInCarouselMarkAsPlaying(e.vars.currentIndex);if(r!==u){(r.showHotspots||r.hasHotspots)&&e.showOrHideSearchButton(r);e.vars.useAllIVXComponents&&e.updateVideoMetadataIfNeeded(r);e.markPlaying(r);e.vars.initialVideo=r;e.vars.showVotes=
e.shouldShowVotes(r);e.initializeHelpfulVotes();e.createContinuousPlayPlaylist(r);e.updateFollowCreatorButton(r);e.updateFeedback(r);e.refreshSocialSharePageState(r);e.vars.isVideoImmersivePlayer?(!e.vars.A.objectIsEmpty(e.vars.videoActionTrayComponents)&&e.vars.useMultiCarousel||e.initializeVideoActionTray(q.segmentTabs),e.setVIPOrientationProperties({carouselCardWidth:q.carouselCardWidth,verticalCarouselCardWidth:q.verticalCarouselCardWidth}),e.updateSegmentTab(r),e.vars.videoActionTrayComponents.updateActiveVideoContentId(r.contentId),
e.emitRelatedVideosRenderMetric(f.METRIC_WATCH_THUMBNAIL_RENDER,e.vars.relatedVideosCarousel),e.vars.keepCarouselOpenOnLinkClick=q.keepCarouselOpenOnLinkClick,e.vars.watchAllClicked?e.handleKeepVideoCarouselOpen():e.handleKeepProductCarouselOpen()):1===e.vars.playlist.length?a.trigger("vse:ns:relatedVideos:"+e.vars.clientPrefix+":hide"):e.toggleSingleLbCssClass(!1);e.vars.shouldShowProfiles=q.includeProfiles;-1==e.vars.currentIndex&&(e.isInfluencerVideo(r)||e.isCustomerReviewVideo(r))&&(e.vars.shouldShowProfiles=
!0);e.vars.shouldShowProfiles&&e.initializeCustomerProfile(r);q.includeVideoInformationOverPlayer&&(e.vars.includeVideoInformationOverPlayer=!0,e.moveMetadataOverPlayer(e.dom.$activeCrvMetadataContainer),e.moveMetadataOverPlayer(e.dom.$activeMetadataContainer),e.setupPlayerHoverHandler(),e.showPlayerOverlayFeaturesForAFewMS(3E3));(q.shouldUseVerticalThumbnail||q.includeVideoInformationOverPlayer)&&e.setupExpandCollapseTextWidget(e.vars.clientPrefix+"-toggle-full-text");e.vars.lightboxCarouselRegistered=
!0;var v=document.querySelectorAll("#"+e.vars.popoverId+" div.vse-video-item");!e.vars.carouselIntersectionObserver&&0<v.length&&l.IntersectionObserver&&(e.vars.carouselIntersectionObserver=new G(null,v,e.onIntersectionObserved,e.vars.enableWidgetMetricsAfterOneSecond));var w=document.querySelectorAll("#"+q.carouselName+" div.vse-sm-expander");!e.vars.carouselShowMoreIntersectionObserver&&0<w.length&&l.IntersectionObserver&&(e.vars.carouselShowMoreIntersectionObserver=new G(null,w,e.onIntersectionObservedForShowMoreButton,
e.vars.enableWidgetMetricsAfterOneSecond));e.vars.A.trigger(e.vars.clientPrefix+":vse:relatedVideos:registered")}}else e.vars.showVotes=!1,m.count(f.RV_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-carousel-"+h+"-initialization-failed")}catch(pa){m.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during Lightbox carousel initialization.",pa),m.count(c+".lightboxCarouselInitializationFatal",1)}});a.on("vse:"+e.vars.clientPrefix+":page:watchAllClicked",
function(){e.vars.watchAllClicked=!0});a.on("vse:ns:relatedVideosVernacularExperience:"+e.vars.clientPrefix+":init",function(){a.declarative("onSelectVideoLanguage","change",function(a){a=e.vars.$("input:radio[name\x3d'videoLanguage']:checked").val();a===f.HINDI?(e.vars.$("#"+f.relatedEnglishVideosContainer).addClass("aok-hidden"),e.vars.$("#"+f.relatedHindiVideosContainer).removeClass("aok-hidden")):a===f.ENGLISH&&(e.vars.$("#"+f.relatedHindiVideosContainer).addClass("aok-hidden"),e.vars.$("#"+f.relatedEnglishVideosContainer).removeClass("aok-hidden"))})});
a.on("vse:"+e.vars.clientPrefix+":seeMoreBlock:init",function(a,b){e.vars.isMobile&&e.vars.popoverId&&(e.vars.$("#"+e.vars.popoverId).find(f.VIPShopIconBlockSelector).addClass("aok-hidden"),e.vars.$("#"+e.vars.popoverId).find(f.VIPSeeMoreBlockSelector).removeClass("aok-hidden"),e.vars.$("#"+e.vars.popoverId).find(f.VIPSeeMoreLinkSelector).attr("href",a),e.vars.$("#"+e.vars.popoverId).find(f.VIPSeeMoreTextSelector).text(b),e.vars.$("#"+e.vars.popoverId).find(".vse-airy-container").addClass("vse-spotlight-player-container"),
e.vars.$("#"+e.vars.popoverId).find(".vse-vip-action-tray").addClass("vse-spotlight-vip-action-tray"))});a.on("vse:ns:"+e.vars.clientPrefix+":hideAdditionalUXFeatures",function(){e.vars.$("#"+e.vars.popoverId).find(f.VIPShareIconBlockSelector).addClass("aok-hidden");e.vars.$("#"+e.vars.popoverId).find("."+f.VIPVideoHelpfulVotesClassName).css({display:"none",visibility:"hidden"})});a.on("vse:ns:ingressCarousel:"+e.vars.clientPrefix+":init",function(h,l){try{e.vars.widgetStartTime=l;var r=a.now(),t=
y.fetchLatestPageState(a,h);if(t){e.vars.popoverName=t.lightboxPopoverConfig.popoverId;var u=e.vars.popoverName+"-trigger",v=e.vars.popoverName+"-wrapper",w=new N(d,p,a,{gatedP:D,EventEmitter:K,promise:k});e.vars.ingressCarousel=w.create(t);if(e.vars.A.objectIsEmpty(e.vars.ingressCarousel))throw new H("Cannot create Ingress Carousel. Carousel is null or undefined");e.vars.ingressPlaylist=e.vars.ingressCarousel.getplaylist();e.vars.A.on(e.vars.A.constants.BROWSER_EVENTS.SCROLL,e.vseCsmWidgetLoadedMetrics);
e.vseCsmWidgetLoadedMetrics();e.vars.modalFactory=e.getModalFactory();a.on("vse:contentCarousel:"+t.carouselName+":click",function(c){var d=e.vars.modalFactory&&e.vars.modalFactory.get(e.vars.$("#"+u));m.count(""+e.vars.clientPrefix+f.METRIC_WIDGET_CLICK,1);d?(d.show(),a.off("a:popover:afterShow:"+e.vars.popoverName),a.on("a:popover:afterShow:"+e.vars.popoverName,function(d){a.$(d.popover.$popover).addClass(a.$("#"+v).data("cssClass"));a.trigger("vse:"+e.vars.clientPrefix+":page:lightBoxOpened",{assetSpec:c,
lightBoxId:v})})):m.count(f.LB_POPOVER_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1)});a.on("a:popover:beforeHide:"+e.vars.popoverName,function(){a.objectIsEmpty(e.vars.ingressCarousel)||e.vars.ingressCarousel.destroy();a.trigger("vse:"+e.vars.clientPrefix+":page:lightBoxClosed")});var z=a.now();m.count(c+".requestToReadyDuration",z-l);m.count(c+".requestToInitDuration",r-l);m.count(c+".initToReadyDuration",z-r);a.$("#vse-spinner").addClass("aok-hidden");e.vars.A.trigger(e.vars.clientPrefix+":vse:ingressCarousel:registered")}else e.vars.showVotes=
!1,m.count(f.INGRESS_RV_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-carousel-"+h+"-initialization-failed")}catch(B){m.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during Ingress carousel initialization.",B),m.count(c+".ingressCarouselInitializationFatal",1),e.vars.A.hide("#"+e.vars.clientPrefix+f.INGRESS_CAROUSEL_SUFFIX)}});a.on("vse:"+e.vars.clientPrefix+":page:lightBoxOpened",function(d){if(!0===d.enableClickBasedAttribution||!1===
d.enableClickBasedAttribution)e.vars.enableClickBasedAttribution=d.enableClickBasedAttribution;!e.vars.aciContentId&&d.assetSpec&&d.assetSpec.aciContentId&&(e.vars.aciContentId=d.aciContentId);var g=e.vars.A.now();d.player&&d.templateId&&(e.vars.player=d.player,e.vars.useAllIVXComponents=!1,e.vars.templateId=d.templateId);e.vars.firstRelatedProductOverride=d.firstRelatedProductOverride;e.vars.lightboxOpened=!0;e.vars.popoverId=d.lightBoxId;e.removeAriaHiddenFromCarouselCards();e.removeAudioOverlay();
e.vars.A.objectIsEmpty(d.assetSpec)&&(e.vars.ingressHasInitialAssetSpec=!1);d.lazyLoadProductAsin&&(e.vars.lightboxCarouselRegistered=!1);d.showHeroExperience&&(e.vars.showHeroExperience=d.showHeroExperience);d.assetSpec&&d.assetSpec.audioNote&&e.createAudioOverlay(d.assetSpec);e.vars.lightboxCarouselRegistered?(e.vars.ingressHasInitialAssetSpec?(e.vars.currentIndex=e.findIndex(d.assetSpec),e.vars.currentAssetSpec=e.getCurrentlyPlayingVideoInCarouselMarkAsPlaying(e.vars.currentIndex),e.vars.seekTime=
d.assetSpec.seekTime,e.vars.videoUrlInlineVideoKey=d.assetSpec.videoUrl):(e.vars.currentAssetSpec=e.getActiveAsset(),e.vars.currentIndex=e.vars.currentAssetSpec.index),e.createContinuousPlayPlaylist(e.vars.currentAssetSpec)):(e.vars.seekTime=e.vars.ingressHasInitialAssetSpec?d.assetSpec.seekTime:d.seekTime,e.vars.rankingStrategy=e.vars.ingressHasInitialAssetSpec?d.assetSpec.rankingStrategy:d.rankingStrategy,e.vars.videoUrlInlineVideoKey=e.vars.ingressHasInitialAssetSpec?d.assetSpec.videoUrl:d.videoUrl,
e.vars.currentIndex=e.vars.ingressHasInitialAssetSpec&&!d.lazyLoadProductAsin?d.assetSpec.index:0,e.vars.currentAssetSpec=e.vars.ingressHasInitialAssetSpec?d.assetSpec:e.vars.initialVideo,e.vars.ingressHasInitialAssetSpec&&e.vars.initialVideo&&(e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.vendorName)&&(e.vars.currentAssetSpec.vendorName=e.vars.initialVideo.vendorName,e.vars.currentAssetSpec.entityId=e.vars.initialVideo.entityId,e.vars.currentAssetSpec.entityType=e.vars.initialVideo.entityType),
e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.closedCaptions)&&(e.vars.currentAssetSpec.closedCaptions=e.vars.initialVideo.closedCaptions),e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.labelDetails)&&(e.vars.currentAssetSpec.labelDetails=e.vars.initialVideo.labelDetails),e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.ccvDisclosure)&&(e.vars.currentAssetSpec.ccvDisclosure=e.vars.initialVideo.ccvDisclosure),e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.segmentNumber)&&(e.vars.currentAssetSpec.segmentNumber=
e.vars.initialVideo.segmentNumber),e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.reportUrl)&&(e.vars.currentAssetSpec.reportUrl=e.vars.initialVideo.reportUrl)));d.initialRelatedProducts?e.vars.currentAssetSpec.relatedProducts=d.initialRelatedProducts:!e.vars.currentAssetSpec.relatedProducts&&d.assetSpec&&d.assetSpec.productAsin&&(e.vars.currentAssetSpec.relatedProducts=d.assetSpec.productAsin);e.vars.currentAssetSpec&&e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.rankingStrategy)&&(e.vars.currentAssetSpec.rankingStrategy=
e.vars.rankingStrategy);e.vars.lightboxOpenedFirstTime&&(e.getDomElements(e.vars.popoverId,e.vars.templateId),e.setUpSingleLBOverlayIfRequired(),e.vars.isMobile||(e.dom.$wrapper.closest(f.LightboxWrapperSelector).addClass(e.dom.$wrapper.attr("class")),e.addPlayerHoverHandler()),e.vars.showContentCarousel||(e.vars.showVotes=e.shouldShowVotes(e.vars.currentAssetSpec),e.initializeHelpfulVotes()),e.vars.isRedesignLBEligibleToTrigger&&e.triggerWeblab(f.NEW_LIGHTBOX_V2));e.vars.A.capabilities.mobile&&!e.vars.A.capabilities.isAmazonApp&&
e.vars.$("body").scrollTop(1);e.vars.showHeroExperience||e.vars.$("body").addClass("vse-lb-no-scroll");e.vars.$("#"+e.vars.popoverId).addClass("vse-lb-opened");e.show(e.vars.currentAssetSpec);e.vars.lightboxOpenedFirstTime?(e.triggerAUIResize(),e.vars.isVideoImmersivePlayer||e.setupDefaultClosedCaptions()):(e.resizeLB(),e.resetCarouselWithSeeMore());if(e.vars.isVideoImmersivePlayer){var h=a.capabilities.isAmazonApp?"vse-vip-lb-mshop":"vse-vip-lb-mweb";e.vars.$(f.VIPLightboxSelector).addClass(h);e.vars.$("#"+
e.vars.popoverId).closest(".a-popover-secondary").addClass("vse-vip");a.capabilities.ios&&(e.vars.$(f.VIPLightboxSelector).addClass("vse-ivx-ios"),e.vars.viewportMetaTag=e.vars.$('meta[name\x3d"viewport"]'),e.vars.viewportMetaTagContent=e.vars.viewportMetaTag.attr("content"));e.needToUpdateVideoInfoLater()?e.clearCurrentVideoInfo():(e.resetUserActivityTimer(),e.showVideoImmersivePlayerOverlay());e.vars.useAutoplayFallback||(e.vars.intervalUserActivityHandlerId=e.userActivityCountDown());e.vars.useAllIVXComponents&&
e.initializeVIPControls();e.updateAudioToggleStatus();e.vars.lightboxOpenedFirstTime||(e.vars.useMultiCarousel||e.updateSegmentTab(e.vars.currentAssetSpec),e.vars.lightboxCarouselRegistered&&e.vars.videoActionTrayComponents.updateActiveVideoContentId(e.vars.currentAssetSpec.contentId),e.vars.watchAllClicked?e.handleKeepVideoCarouselOpen():e.handleKeepProductCarouselOpen());e.enableIVXOverlayOnTab();a.delay(function(){e.vars.$("body").addClass("vse-vip-body")},250)}e.vars.currentAssetSpec&&!e.vars.currentAssetSpec.eventTimestamp&&
(e.vars.currentAssetSpec.eventTimestamp=g);e.vars.currentAssetSpec.seekTime=e.vars.seekTime;e.vars.A.delay(function(){e.dom.$wrapper.find(".vse-lb-container").animate({opacity:1},200);e.vars.useAllIVXComponents&&(e.emitEventDurationMetric(f.METRIC_OPEN_LIGHTBOX_EVENT_EXECUTION,e.vars.A.now()-g),e.startPlaying(e.vars.currentAssetSpec))},200);e.dom.$activeVideoOspLink.unbind("click").click(function(a){e.vars.disableCreatorClicksOnMshop?e.closeIXVAndTriggerDisclosureEvent(a):e.openExternalLinkFromLightBox(a)});
e.dom.$activeVideoCRLink.click(function(a){a=e.vars.$(a.target).closest(".vse-cr-link").attr("href");e.openExternalLinkFromLightBox(a)});!e.vars.isMobile&&e.vars.placement&&-1!==e.vars.placement.toLowerCase().indexOf("search")&&e.vars.$("#"+e.vars.popoverId).closest(f.LightboxWrapperSelector).addClass("vse-responsive-lightbox");e.vars.isMobile&&e.vars.placement&&-1!==e.vars.placement.toLowerCase().indexOf("search")&&e.vars.$("#"+e.vars.popoverId).closest(f.LightboxWrapperSelector).removeClass("vse-responsive-lightbox").removeClass("vse-vertical-lightbox").addClass("vse-vip");
e.isImageBlockVIP()&&e.vars.$("#"+e.vars.popoverId).closest(".video-immersive-view-gallery").addClass("vse-vip");v.when("mash").execute("vse-mash-detection",function(a){e.vars.isMshop=!0;e.vars.mShopFactory=a;e.vars.disableFullScreenOnMshop||e.requestMshopFullscreen();document.addEventListener("visibilitychange",function(){"visible"==document.visibilityState&&!e.vars.disableFullScreenOnMshop&&e.vars.lightboxOpened&&e.requestMshopFullscreen()})});e.vars.showHeroExperience||(m.count(f.LB_OPENED+":"+
e.vars.clientPrefix,1),h={eventName:f.METRIC_LIGHTBOX_OPEN,videoAsin:e.vars.currentAssetSpec.contentId,stringPayload:f.EMPTY_STRING,intPayload:1,titleSessionId:e.vars.player.getTitleSessionId().toString()},e.emitMetricToNexus(h));var k=y.fetchLatestPageState(a,e.vars.templateId+"-lazyload-request-ps");if(e.vars.A.objectIsEmpty(k))e.vars.lightboxOpenedFirstTime=!1,m.count(f.LAZY_LOAD_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1);else{var h=function(a,b){e.vars.A.trigger("vse:"+c+":lazyload:"+
b.configuration.type+":succeeded")},l=function(a,b){e.vars.A.trigger("vse:"+c+":lazyload:"+b.configuration.type+":failed")};e.vars.lightboxOpenedFirstTime?(k=a.$.extend({video:{contentID:e.vars.currentAssetSpec.contentId,contentIDType:"ASIN",videoURL:e.vars.currentAssetSpec.videoUrl,imageURL:e.vars.currentAssetSpec.imageURL}},k),d.lazyLoadProductAsin&&(k.product.contentID=d.lazyLoadProductAsin),ga.getLazyLoadComponents(e.vars.A,e.vars.popoverId,k,h,l),e.vars.lightboxOpenedFirstTime=!1):d.lazyLoadProductAsin&&
(k.product.contentID=d.lazyLoadProductAsin,ga.getLazyLoadComponents(e.vars.A,e.vars.popoverId,k,h,l))}});a.on("vse:"+e.vars.clientPrefix+":page:lightBoxClosed",function(){e.vars.lightboxOpened&&(e.vars.lightboxOpened=!1,e.vars.ingressHasInitialAssetSpec=!0,a.trigger("inlineVideo:immersiveViewClosed",{videoUrl:e.vars.videoUrlInlineVideoKey,seekTime:e.vars.player.getCurrentTime()}),e.dom.$wrapper.find(".vse-lb-container").animate({opacity:0}),e.vars.$("body").removeClass("vse-lb-no-scroll"),e.disableIVXOverlayOnTab(),
e.vars.useAllIVXComponents&&e.vars.player.pause(),e.vars.isVideoImmersivePlayer&&(e.vars.$("body").removeClass("vse-vip-body"),e.clearIntervalUserActivityHandler(),null!=e.vars.videoActionTrayComponents&&e.vars.videoActionTrayComponents.reset(),e.emitMetric(f.METRIC_VIP_CLOSE),e.vars.useAutoplayFallback&&!e.vars.vipPlayIconClicked&&(e.emitMetric(f.METRIC_VIP_CLOSE_WITHOUT_PLAY),m.count(e.vars.clientPrefix+":"+f.METRIC_VIP_CLOSE_WITHOUT_PLAY,1)),e.resetVIPControls(),e.vars.useMultiCarousel&&e.vars.multiCarouselExpanded&&
e.openCloseMultiCarousel(),e.vars.isMshop&&!e.vars.disableFullScreenOnMshop&&e.cancelMshopFullscreen(),e.vars.A.$("#"+e.vars.templateId+" ."+f.UpNextCancelClassName).click()),e.vars.customerReviewsConfig&&e.vars.customerReviewsConfig.showCustomerReviewMetadata&&e.vars.A.off("resize",e.handleReviewsOnResize),e.vars.useChannelCarousel&&e.vars.A.off("resize",e.handleMultiChannelReviewIVXOnResize),a.trigger("vse:ns:partialcomponents:"+e.vars.clientPrefix+":lightboxClosed"))});a.on("vse:"+e.vars.clientPrefix+
":lazyload:relatedvideos:succeeded",function(){e.resizeLB();e.emitPFORenderMetric(f.METRIC_PFO_RENDER)});a.on("vse:"+e.vars.clientPrefix+":lazyload:relatedvideos:failed",function(){e.vars.isVideoImmersivePlayer?e.vars.A.hide(e.vars.A.$("#"+e.vars.templateId+" "+f.VIPWatchIconBlockSelector)):e.vars.A.hide(e.vars.A.$("#"+e.vars.templateId+" div[class^\x3d'div-'][class$\x3d'lb'] .vse-lazyload-spinner"))});a.on("vse:ns:relatedVideos:"+e.vars.clientPrefix+":hide",function(){e.vars.lightboxOpened&&e.vars.isVideoImmersivePlayer?
e.vars.A.hide(e.vars.A.$("#"+e.vars.templateId+" "+f.VIPWatchIconBlockSelector)):e.toggleSingleLbCssClass(!0)});a.on("resize",function(){e.vars.lightboxOpened&&e.resizeLB()});a.on.orientationchange(function(a){!e.vars.isVideoImmersivePlayer&&e.vars.playFullScreenVideo&&(0===a.orientation?e.vars.player.aspectRatio(e.getAspectRatio(f.PORTRAIT)):e.vars.player.aspectRatio(e.getAspectRatio(f.LANDSCAPE)));e.vars.isMobile&&e.vars.lightboxOpened&&(e.vars.$("#"+e.vars.popoverId).height(l.innerHeight),e.dom.$lbContainer.height(l.innerHeight))});
a.on("vse:ns:inlinePlayer:"+e.vars.clientPrefix+":init",function(c){try{var d=y.fetchLatestPageState(a,c.pageStateName),g=new ca(a,e,c),h=a.$("#"+d.inlinePlayerConfig.lightboxClickHandlerSelector),k=c.popoverId&&c.popoverTriggerId;k&&g.addLightboxAfterShowAndBeforeHideEvents();g.initializePlayerOverlayComponents(h);g.addOrientationChangeHandler();var l={playerInstance:e.vars.player,changePlayerMode:g.changePlayerMode,startPlaying:g.startPlaying};k?l.openLightbox=g.openLightbox:(l.movePlayerToLightbox=
g.movePlayerToLightbox,l.movePlayerToIngress=g.movePlayerToIngress);d.needPlayerFactory?(l.playerFactoryConfig={playerFactory:e.vars.playerFactory,playerConfig:d,addPlayerLoadedHandler:g.addPlayerLoadedHandler},l.playerInstance=u,a.trigger("vse:ns:inlinePlayer:factory:"+e.vars.clientPrefix+":ready",l)):(g.addPlayerLoadedHandler(),a.trigger("vse:ns:inlinePlayer:"+e.vars.clientPrefix+":ready",l),m.count("vse:ns:inlinePlayer:initSuccess",1))}catch(n){m.count("vse:ns:inlinePlayer:"+e.vars.clientPrefix+
":initFailed",1),m.logError(f.ATTRIBUTION_NAME,"Fallback for inline player "+e.vars.clientPrefix,n),a.trigger("vse:ns:inlinePlayer:"+e.vars.clientPrefix+":initFailed",n),m.count("vse:ns:inlinePlayer:initFailed",1)}})},TestModules:wa,Utils:fa,_noneFeature:c()}})})};v.when("A","3p-promise").execute("VSE-gatedP-register-VSEComponentAssets-client",function(d,c){D.register("VSEComponentAssets","VSE-VSEComponentAssets-client-registered",za,c)});v.when("A","a-carousel-constants","a-carousel-framework","a-carousel-transition-slide").execute("vse-video-carousel-transition-registration",
function(d,c,a,b){var f=l.vseFeatures||{};f["vse-video-carousel-transition-strategy"]||(d=new ba(d,c,b),a.registerStrategy("transition","vse-video-carousel-transition",d.get()),f["vse-video-carousel-transition-strategy"]=!0)});v.when("A","a-carousel-framework","a-carousel-constants").execute("vse-display-strategy-registration",function(d,c,a){var b=l.vseFeatures||{};b["vse-video-carousel-display-strategy"]||(d=new aa(d,a),c.registerStrategy("display","vse-video-carousel-display",d),b["vse-video-carousel-display-strategy"]=
!0)})}catch(d){m.logError(f.ATTRIBUTION_NAME,"Error during VSE AUI module registration.",d),m.count(f.ATTRIBUTION_NAME+".moduleFatal",1)}})()});