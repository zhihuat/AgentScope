"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9460],{29178:function(e,r,s){var t=s(85893),a=s(67294),i=s(11163),l=s(87536),n=s(72215),o=s(51023),c=s(39149),d=s(26035),u=s(71567),h=s(16627),m=s(90900),p=s(91960),f=s(69180),g=s(19738),x=s(64521),j=s(14238),b=s.n(j),v=s(72204),y=s.n(v);r.Z=function(e){let{referralCode:r,onSuccess:s,onSuccessAffiliateModal:j,submitLabel:v,emailInputFocus:w,forGiveaway:k,forSpecialCampaign:N}=e,{register:Z,handleSubmit:_}=(0,l.cI)(),{sendSegmentTrack:C}=(0,u.Z)(),S=(0,i.useRouter)(),{user:P}=(0,m.Pk)(),{globalUrlParams:I}=(0,n.CG)(e=>e.globalparams),[L,T]=(0,a.useState)(),[M,E]=(0,a.useState)(!1),A=v||"Subscribe",F=e=>{C({name:c.FP.EmailNotificationSignup,params:{...(0,h.pS)({user:P,initial_url_params:null==I?void 0:I.urlParams}),email:e,emailAddress:e,referralCode:r}}),j?j({emailAddress:e,referralCode:r}):s?s():S.push("/success")},R=()=>k?"giveaway":N?"special-campaign":"newsletter",B=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=document.getElementById("affiliateEmailRef");if(e&&!g.tq&&!g.og&&w){e.focus();let r=setTimeout(()=>e.focus(),2e3);return()=>{clearTimeout(r)}}},[w]),(0,t.jsx)("form",{onSubmit:_(e=>{let{email:r,referer_code:s}=e,t=(0,f.oH)(r);if(t.length)console.log(t),T(t);else{let e=R(),t="".concat(o.Z.API_GATEWAY_URL,"/").concat(e);E(!0),T(void 0),fetch(t,{method:"POST",body:JSON.stringify({email:r,referer_code:s}),headers:{"Content-Type":"application/json"}}).then(e=>e.ok?(F(r),e):e.json()).then(e=>{if(401===e.status){T("401 Unauthorized");return}if(409===e.status){T("Sorry, this email is already registered.");return}if(200!==e.status){T(e.description||"Something went wrong");return}}).catch(e=>{T("Something went wrong"),p.Z.sendError(e)}).finally(()=>{E(!1)})}}),children:(0,t.jsxs)(x.Z,{cssClass:"Pages_formGroup",children:[(0,t.jsxs)("div",{className:b().inputWrapper,ref:B,children:[(0,t.jsx)("input",{type:"email",id:"affiliateEmailRef",...Z("email"),className:[b().input,b().inputBorder].join(" "),placeholder:"Enter your email",required:!0}),L&&(0,t.jsxs)("span",{className:b().error,children:[" ",L," "]})]}),!!r&&(0,t.jsx)("input",{type:"hidden",...Z("referer_code"),className:b().input,value:r}),(0,t.jsx)("button",{type:"submit",value:A,className:r===d.R8?[y().base,y().forAffiliateModal].join(" ").trim().replace(/ +(?= )/g,""):r===d.IT?[y().base,b().buttonTheAtlantic,y().forAffiliateModal].join(" ").trim().replace(/ +(?= )/g,""):[y().base,y().forAffiliateModal].join(" ").trim().replace(/ +(?= )/g,""),disabled:M,children:A})]})})}},9460:function(e,r,s){s.d(r,{Z:function(){return eR}});var t,a,i,l,n=s(85893),o=s(67294),c=s(11163),d=s(84475),u=s(30381),h=s.n(u),m=s(85518),p=s(98932),f=s(16627),g=s(71567),x=s(90900),j=s(11327),b=s(43539),v=s(4400),y=s(65319),w=s(43388),k=s(67585),N=s(72215),Z=s(80372),_=s(79045),C=s(15372),S=s(22241),P=s.n(S),I=function(e){let{wrapperId:r}=e,s=async()=>{_.Z.emit("Navigation Push",{name:"SignupEnterEmail",params:{step:"whatsYourEmail"}})};return(0,n.jsxs)("div",{id:r||void 0,className:P().headerInnerRow,children:[(0,n.jsx)(C.Z,{title:"Sign Up",onPress:s,size:"header",color:"white",dataCy:"btn-sign-up"}),(0,n.jsx)(C.Z,{title:"Log In",onPress:()=>{_.Z.emit("Navigation Push",{name:"LoginWithEmail",params:{}})},size:"header",color:"blackWhiteOutline",dataCy:"btn-log-in"})]})},L=s(41664),T=s.n(L),M=s(31955),E=s(89052),A=s(39149),F=s(26035),R=s(19738),B=s(74150),D=s(96761),W=s(35292),O=s(98502),U=s(86713),G=s(83841);function q(){let{onClose:e,onOpen:r,disabled:s,additionalRefs:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,o.useRef)(null),i=(0,o.useRef)(t),[l,n]=(0,o.useState)(!1),c=(0,o.useRef)(r),d=(0,o.useRef)(e);(0,o.useEffect)(()=>{i.current=t},[t]),(0,o.useEffect)(()=>{c.current=r},[r]),(0,o.useEffect)(()=>{d.current=e},[e]);let u=(0,o.useCallback)(()=>{if(!s){var e;n(!0),null===(e=c.current)||void 0===e||e.call(c)}},[s]),h=(0,o.useCallback)(()=>{if(!s){var e;n(!1),null===(e=d.current)||void 0===e||e.call(d)}},[s]);return(0,o.useEffect)(()=>{function e(e){var r,s;let t=null===(r=i.current)||void 0===r?void 0:r.some(r=>{var s;return null==r?void 0:null===(s=r.current)||void 0===s?void 0:s.contains(e.target)});(null===(s=a.current)||void 0===s?void 0:s.contains(e.target))||t||h()}return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[h]),{dropdownRef:a,isOpen:l,open:u,close:h}}var H=s(64521),z=s(87529),Y=s(40629),V=s(82463),X=s(86393);let J=V.Z.create({cartItem:{flexDirection:"row",display:"flex",justifyContent:"center",alignItems:"center"},cartItemQty:{display:"flex",justifyContent:"center",alignItems:"center",width:22,height:22,borderRadius:12,backgroundColor:X.ZP.colors.active}});var K=s(34640),Q=function(){let{orders:e,subscription:r}=(0,N.CG)(e=>e.cart),s=e.reduce((e,r)=>e+Number(r.quantity),0)+(r?1:0);return(0,n.jsxs)(H.Z,{type:"span",style:J.cartItem,cssClass:"UI_cartItem",dataCy:"icon-cart",children:[(0,n.jsx)(Y.Z,{svgElement:(0,n.jsx)(K.Z,{}),src:"/images/IconCart.svg",alt:"Cart Icon",width:28,height:28,noWrapper:!0}),(0,n.jsx)(H.Z,{type:"span",style:J.cartItemQty,cssClass:s>0?"UI_cartItemQty":"UI_cartItemQtyEmpty",dataCy:"icon-qty-cart",children:(0,n.jsx)(z.Z,{type:"span",format:"sm",children:s})})]})},$=s(29178),ee=s(4706),er=s(42337),es=s(30687),et=s(45033),ea=s(38824),ei=s(2663),el=s(83775),en=s(50652),eo=s(51023);function ec(e,r){document.cookie="".concat(e,"=").concat(JSON.stringify(r),"; expires: Fri, 31 Dec 9999 23:59:59 GMT; path=/")}function ed(e){document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;")}let eu=e=>e.split("/").filter(e=>e);var eh=e=>{var r;let{fullHeader:s,heroContent:t,user:a,children:i,hideBottomBorder:l,minimalLeftLogoHeader:d,minimalCenteredLogoHeader:u,showAffiliateBanner:h}=e;(0,x.xY)();let{fetchUserInfo:m,fetchUserSettingsAndBanners:j}=(0,x.gZ)(),{isAuthorUser:b}=(0,x.Wd)(),{isStoreStarted:v,authenticated:w,token:k}=(0,x.Pk)(),C=(0,N.TL)(),S=(0,c.useRouter)(),{utm_source:L,shouldHideDesktopUI:z,withUrlParamFromAdvertiser:V}=(0,Z.DP)(),{sendSegmentIdentify:X,sendSegmentTrack:J}=(0,g.Z)(),{askStatus:K}=(0,N.CG)(e=>e.ask),{subscription:eh}=(0,U.Z)(),{globalUrlParams:em}=(0,N.CG)(e=>e.globalparams),{addToModalContext:ep}=(0,p.Z)(),[ef,eg]=(0,o.useState)(!1),{pushToast:ex}=(0,G.Z)(),ej=[{code:F.IT,branding:"TheAtlantic"}],eb=[{url:"historical-fiction",label:"Historical Fiction"},{url:"crime-thrillers",label:"Crime & Thrillers"},{url:"mystery",label:"Mystery"},{url:"science-fiction",label:"Science-Fiction"},{url:"fantasy",label:"Fantasy"},{url:"poetry",label:"Poetry"},{url:"romance",label:"Romance"},{url:"childrens",label:"Children’s Books"},{url:"young-adult",label:"Young Adult"}],ev=[{url:"biographies-memoirs",label:"Biographies & Memoirs"},{url:"history",label:"History"},{url:"current-affairs",label:"Current Affairs"},{url:"tech-science",label:"Tech & Science"},{url:"business",label:"Business"},{url:"self-development",label:"Self-Development"},{url:"travel",label:"Travel"},{url:"the-arts",label:"The Arts"},{url:"food-wine",label:"Food & Wine"},{url:"religion-spirituality",label:"Religion & Spirituality"},{url:"sports",label:"Sports"},{url:"humor",label:"Humor"}],ey=(0,B.d)(),{sscid:ew,affiliate:ek,affiliate_id:eN}=S.query,{sscid:eZ,affiliate:e_,affiliate_id:eC}=(null==em?void 0:em.urlParams)||{},eS=ew||ek||eN||eZ||e_||eC||F.R8,eP=M.Z.get("terAffiliateModal"),eI=M.Z.get("terAffiliateModalShown"),eL=["tertulia","meta"].some(e=>e===L),eT=h&&!R.tq&&!w&&!eI&&"true"!==eP&&!V&&!eL,eM=null===(r=ej.find(e=>e.code===eS))||void 0===r?void 0:r.branding,[eE,eA]=(0,o.useState)(!1),eF=(0,o.useRef)(S.asPath),eR=()=>{eI||(ec("terAffiliateModalShown",!0),J({name:"TheAtlantic"===eM?A.FP.NewsletterModalShownTheAtlantic:A.FP.NewsletterModalShownGeneric,params:(0,f.pS)({user:a,initial_url_params:null==em?void 0:em.urlParams})}))},eB=e=>{let{skipSendSegmentTrack:r}=e;eA(!1),ec("terAffiliateModal",!0),r||J({name:"TheAtlantic"===eM?A.FP.NewsletterModalClosedTheAtlantic:A.FP.NewsletterModalClosedGeneric,params:(0,f.pS)({user:a,initial_url_params:null==em?void 0:em.urlParams})})},eD=e=>{if(!S)return!1;let r=eu(S.asPath),s=eu(e);return"lists"===r[0]&&"lists"===s[0]||("books"!==r[0]||1!==r.length)&&s.length===r.length&&s.every((e,s)=>e===r[s])},eW=e=>eD(e)?"page":void 0,eO=()=>{_.Z.emit("Track",{name:A.FP.MembershipTrialAdded,params:(0,f.pS)({user:a,current_screen:"MembershipModal",context:"Header",initial_url_params:null==em?void 0:em.urlParams})}),C((0,y.VF)(eh)),ex({type:"success",text:A.Td.MEMBERSHIP_ADDED_TO_CART}),_.Z.emit("Navigation Navigate",{name:"Cart",params:{dataForSegmentEventProperties:{user:a,current_screen:"MembershipModal",context:"Header",initial_url_params:null==em?void 0:em.urlParams}}}),eg(!1)};(0,o.useEffect)(()=>{v&&"0.0.0"===eo.Z.VERSION&&C((0,D.$q)(eo.Z.VERSION))},[C,v]),(0,o.useEffect)(()=>{if(eF.current!==S.asPath){eA(!1);let e=setTimeout(()=>{eT&&(eA(!0),eR())},0);return eF.current=S.asPath,()=>{clearTimeout(e)}}},[S.asPath]),(0,o.useEffect)(()=>{if(v&&eT){let e=setTimeout(()=>{eA(!0),eR()},0);return()=>{clearTimeout(e)}}},[v,eT]),(0,o.useEffect)(()=>{v&&!w&&(k?ec("terToken",k):(ed("terToken"),ed("terTwitter"),ed("terMember"),C((0,D.Lt)())))},[C,v,k,w]),(0,o.useEffect)(()=>{v&&k&&w&&((0,E.F)(k),ec("terToken",k),ec("terTwitter",null==a?void 0:a.isTwitter),ec("terMember",null==a?void 0:a.active_membership),m(X)),j()},[C,v,w,k]),(0,o.useEffect)(()=>{ep("NewsletterModal",(0,n.jsx)(ei.Z,{display:eE,onClose:eB,referralCode:eS,formAccessRequests:$.Z,branding:eM}))},[eE,S.asPath]),(0,o.useEffect)(()=>{ep("MembershipModal",(0,n.jsx)(ea.Z,{display:ef,onClose:()=>eg(!1),onAddMembershipFromModal:eO,hasMembership:a.active_membership}))},[ef,S.asPath]);let eU=()=>{C((0,D.kS)()),ed("terToken"),ed("terTwitter"),ed("terMember"),("/"===S.pathname||S.pathname.startsWith("/books"))&&C(eG())},eG=()=>(S.reload(),e=>{e((0,O.ru)())}),eq=()=>{R.tq&&_.Z.emit("Navigation Push",{name:"MembershipOfferDetailed",params:{onJoinAndContinue:()=>{J({name:A.FP.MembershipTrialAdded,params:(0,f.pS)({user:a,current_screen:"MembershipModal",context:"Header",initial_url_params:null==em?void 0:em.urlParams})}),C((0,y.VF)(eh)),_.Z.emit("Navigation Navigate",{name:"Cart",params:{dataForSegmentEventProperties:{user:a,current_screen:"MembershipModal",context:"Header",initial_url_params:null==em?void 0:em.urlParams}}})},onContinue:()=>{_.Z.emit("Navigation Pop",{})}}}),R.tq||eg(!0)},eH=e=>{let{url:r,label:s,cssClass:t,...a}=e,i=eW(r);return(0,n.jsx)(es.Z,{type:"regularLink",href:r,cssClass:t||"UI_categoryItem","aria-current":i,...a,children:s})},ez=e=>{let{url:r,label:s}=e,t=eW(r);return(0,n.jsxs)(es.Z,{type:"regularLink",href:r,cssClass:"UI_fullScreenItem","aria-current":t,children:[(0,n.jsx)("span",{children:s}),(0,n.jsx)(el.Z,{})]})},eY=()=>(0,n.jsx)("div",{className:P().dropdownHeadCard,children:(0,n.jsxs)(es.Z,{href:"/profile",cssClass:"UI_headProfile",children:[(0,n.jsxs)("span",{className:P().userBlock,children:[(0,n.jsx)(Y.Z,{src:"/images/IconProfile.svg",alt:"Profile icon",width:28,height:28,noWrapper:!0,noLazy:!0}),(0,n.jsxs)("span",{className:P().userData,children:[(0,n.jsxs)("span",{className:P().userName,children:[a.first_name," ",a.last_name]}),(0,n.jsx)("span",{className:P().userEmail,children:a.email})]})]}),(0,n.jsx)(el.Z,{})]})}),eV=()=>(0,n.jsxs)("ul",{className:P().fullScreenMenuInner,children:[!R.tq&&(0,n.jsx)(ez,{url:"/books/fiction/new-arrivals",label:"New Arrivals"}),(0,n.jsx)(ez,{url:"/books/fiction",label:"Fiction"}),(0,n.jsx)("ul",{className:P().pills,children:eb.map(e=>(0,n.jsx)(eH,{url:"/books/fiction/".concat(e.url),label:e.label,cssClass:"UI_pill"},e.url))}),(0,n.jsx)(ez,{url:"/books/non-fiction",label:"Non-Fiction"}),(0,n.jsx)("ul",{className:P().pills,children:ev.map(e=>(0,n.jsx)(eH,{url:"/books/non-fiction/".concat(e.url),label:e.label,cssClass:"UI_pill"},e.url))}),(0,n.jsx)(ez,{url:"/belletrist",label:"Belletrist Book Club"}),(0,n.jsx)(ez,{url:"/books/fiction/childrens",label:"Children’s Books"}),(0,n.jsx)(ez,{url:"/lists",label:"Lists"}),(0,n.jsx)(ez,{url:"/articles",label:"Blog"}),(0,n.jsx)(ez,{url:"/gift-card",label:"Gift Cards"}),(0,n.jsx)(ez,{url:"/mylists",label:A.Ti.MY_LISTS}),(0,n.jsx)(ez,{url:"/booklinks",label:"Games"})]}),eX=e=>{let{baseUrl:r,title:s,categories:t,hideBottomLink:a}=e,i=(0,o.useRef)(null),{dropdownRef:l,isOpen:c,open:d,close:u}=q({additionalRefs:[i]});return(0,n.jsxs)("div",{className:P().categoryDropdown,children:[(0,n.jsx)("button",{className:[P().categoryDropdownToggle,P().withDropdownIndicator,c&&P().categoryDropdownToggleOpen].join(" ").trim().replace(/ +(?= )/g,""),onClick:c?u:d,ref:i,children:s}),(0,n.jsxs)("ul",{className:[P().categoryDropdownMenu,c?P().isVisible:null].join(" ").trim().replace(/ +(?= )/g,""),ref:l,children:[t.map(e=>{let s="".concat(r,"/").concat(e.url);return(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:s,cssClass:"UI_category","aria-current":eW(s),children:e.label})},e.url)}),!a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("li",{className:P().dropdownDividerSpacer}),(0,n.jsx)("li",{children:(0,n.jsxs)(es.Z,{href:r,cssClass:"UI_category",children:["All ",s]})})]})]})]})},eJ=e=>"".concat(e.name,"-").concat(e.type),eK=()=>{var e;let r=(0,o.useRef)(null),{dropdownRef:s,isOpen:t,open:i,close:l}=q({additionalRefs:[r]}),c=(0,o.useCallback)(()=>{let e=[];return e.push({name:"ProfileHeaderCard",type:"content",content:(0,n.jsx)(ee.Z,{forHeaderMenu:!0})}),a.active_membership&&e.push({name:"Your Membership >",type:"titleLink",withoutDivider:!0,callback:()=>{m(),j(),_.Z.emit("Navigation Push",{name:"Memberdetails",params:{}})}}),e.push({name:"ProfileMenuMembership",type:"content",content:(0,n.jsx)(er.Z,{handleDisplayMembershipModal:eq,forHeaderMenu:!0})}),e.push({name:"Your Account",type:"title"}),b&&e.push({name:"Author Profile",callback:()=>{var e;let r=null==a?void 0:null===(e=a.userProfile)||void 0===e?void 0:e.public_username;_.Z.emit("Navigation Navigate",{name:"PublicProfile",params:{userSlug:r}})}}),e.push({name:"Orders",callback:()=>{_.Z.emit("Navigation Push",{name:"YourOrders",params:{}})}}),e.push({name:"Your Taste Preferences",callback:()=>{R.tq?_.Z.emit("Navigation Push",{name:"OnboardingSelectBookCategories",params:{}}):_.Z.emit("Navigation Push",{name:"Tastepreferences",params:{}})},dataCy:"btn-update-tastes-preferences"}),e.push({name:"Import from GoodReads",callback:()=>{_.Z.emit("Navigation Push",{name:"ImportFromGoodreads",params:{}})}}),e.push({name:"Buy Gift Cards",callback:()=>{_.Z.emit("Navigation Push",{name:"GiftCard",params:{}})}}),e.push({name:"2",type:"space"}),e.push({name:"3",type:"space"}),e.push({name:"Log out",withoutDivider:!0,callback:eU}),e.push({name:"4",type:"space"}),e},[m,j,a.active_membership,null==a?void 0:null===(e=a.userProfile)||void 0===e?void 0:e.public_username])();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{className:[P().profileDropdown,P().withDropdownIndicator,P().dropdownToggle,P().dropdownToggleHover,t&&P().dropdownToggleOpen].join(" ").trim().replace(/ +(?= )/g,""),onClick:t?l:i,ref:r,title:"Profile","data-cy":"btn-profile",children:[(0,n.jsx)(Y.Z,{src:"/images/IconProfile.svg",alt:"Profile Icon",width:28,height:28,noWrapper:!0,noLazy:!0}),(0,n.jsx)("span",{className:P().showOnDesktop,children:"Profile"})]}),(0,n.jsx)("div",{className:[P().dropdownMenu,P().dropdownMenuRight,t?P().isVisible:null,P().profileFlatMenu].join(" ").trim().replace(/ +(?= )/g,""),ref:s,children:c.map((e,r)=>(0,n.jsx)(en.Y,{item:e,index:r},eJ(e)))}),(0,n.jsx)(et.Z,{size:"lg",vertical:!0,cssClass:"UI_isTabletUpLogged"})]})},eQ=S.pathname.includes("/ask"),e$=eQ&&("ON"===K||"IDLE"===K||"RESPONSE"===K),e0="/"===S.pathname,e1=(v&&w&&!e0||!e0)&&!["/about","/cart","/search","/new-account","/your-orders","/import-from-goodreads","/import-from-goodreads/success","/bookLinks"].includes(S.pathname)&&!eQ,e2=["/new-account","/authorsignup"].includes(S.pathname),e3=d||u;if(z)return(0,n.jsx)("header",{className:s?P().headerBox:P().headerBoxWithBorder});let e8=e=>!e3&&(0,n.jsxs)("div",{className:e,children:[(0,n.jsxs)(H.Z,{cssClass:"UI_displayForNoAuthenticated",children:[(0,n.jsx)(es.Z,{type:"regularLink",href:"/new-account",cssClass:"Button_primaryPill",dataCy:"btn-signup",children:"Sign up"}),(0,n.jsx)(es.Z,{type:"regularLink",href:"/login-with-email",cssClass:"Button_outlinePill",dataCy:"btn-login",children:"Log In"})]}),w&&(0,n.jsx)(eK,{}),w&&(0,n.jsxs)(es.Z,{type:"regularLink",href:"/mylists",title:A.Ti.MY_LISTS,cssClass:"Button_outlinePill",children:[(0,n.jsx)(Y.Z,{src:"/images/IconLists.svg",alt:"Lists Icon",width:28,height:28,noWrapper:!0,noLazy:!0}),(0,n.jsx)("span",{className:P().showOnDesktop,children:A.Ti.MY_LISTS})]}),(0,n.jsx)("div",{className:P().isNotTabletUp,children:(0,n.jsx)(es.Z,{type:"regularLink",href:"/cart",cssClass:"Button_outlinePill",children:(0,n.jsx)(Q,{})})}),(0,n.jsx)(et.Z,{size:"lg",vertical:!0,cssClass:"UI_isTabletUp"}),(0,n.jsx)("div",{className:P().isTabletUp,children:(0,n.jsx)(es.Z,{type:"regularLink",href:"/cart",cssClass:"Button_tertiaryPill",children:(0,n.jsx)(Q,{})})})]});return(0,n.jsxs)("header",{className:d?e2?P().headerBoxFlatLight:u?P().headerBox:P().headerBoxFlat:u?P().headerBoxFlatLight:s||!(e$||l)?P().headerBoxWithBorder:P().headerBox,children:[u&&(0,n.jsx)(H.Z,{cssClass:"UI_headerInnerOnlyLogo",children:(0,n.jsx)(es.Z,{href:"/",title:"Books Worth Talking About",children:(0,n.jsx)(Y.Z,{src:"/images/TertuliaLogo.svg",alt:"Tertulia logo",width:120,height:15,noWrapper:!0})})}),!u&&(0,n.jsxs)(H.Z,{cssClass:"UI_headerInner",children:[(0,n.jsxs)(H.Z,{cssClass:"UI_headerInnerLeft",children:[!e$&&(0,n.jsx)(()=>{let e=(0,o.useRef)(null),{dropdownRef:r,isOpen:s,open:t,close:a}=q({additionalRefs:[e]}),{authenticated:i}=(0,x.Pk)(),l=s?a:t;return((0,o.useEffect)(()=>{s?document.body.classList.add("overflow-hidden-fullscreen-menu"):document.body.classList.remove("overflow-hidden-fullscreen-menu")},[s]),d)?null:(0,n.jsxs)(H.Z,{cssClass:"UI_dropdown","aria-label":"Mobile menu",role:"navigation",children:[(0,n.jsx)("button",{className:P().dropdownToggle,onClick:l,ref:e,title:"Menu",children:(0,n.jsx)(Y.Z,{src:"/images/IconMenu.svg",alt:"Menu Icon",width:28,height:28,noWrapper:!0})}),(0,n.jsxs)("ul",{className:[P().fullScreenMenu,s?P().isVisible:null].join(" ").trim().replace(/ +(?= )/g,""),ref:r,children:[(0,n.jsx)("li",{children:(0,n.jsxs)(H.Z,{cssClass:"UI_dropdownHead",children:[(0,n.jsx)("button",{className:[P().dropdownToggle,P().dropdownToggleInvert].join(" ").trim().replace(/ +(?= )/g,""),onClick:l,children:(0,n.jsx)(Y.Z,{src:"/images/IconCloseWhite.svg",alt:"Close Icon",width:28,height:28,noWrapper:!0})}),!i&&(0,n.jsx)(I,{}),i&&(0,n.jsx)(eY,{})]})}),(0,n.jsx)("li",{children:(0,n.jsx)(eV,{})}),(0,n.jsx)("li",{children:(0,n.jsxs)("div",{className:P().footerMenuFullScreen,children:[(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{className:P().fullScreenSection,children:"About & Help"}),(0,n.jsx)("li",{children:(0,n.jsx)(T(),{href:"/about",children:"About Tertulia"})}),(0,n.jsx)("li",{children:(0,n.jsx)(T(),{href:"/membership",children:"Membership & Co-Ownership"})}),(0,n.jsx)("li",{children:(0,n.jsx)(T(),{href:"/shipping",children:"Shipping & Delivery"})}),(0,n.jsx)("li",{children:(0,n.jsx)(T(),{href:"/orders",children:"Orders & Payments"})}),(0,n.jsx)("li",{children:(0,n.jsx)(T(),{href:"/support",children:"Contact Support"})}),(0,n.jsx)("li",{children:(0,n.jsx)(T(),{href:"/feedback",children:"Send App Feedback"})})]}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{className:P().fullScreenSection,children:"Follow us"}),(0,n.jsxs)("li",{className:P().fullScreenSocial,children:[(0,n.jsx)(es.Z,{type:"regularLink",href:"https://www.facebook.com/JoinTertulia",newWindow:!0,secureLink:!0,children:(0,n.jsx)(Y.Z,{src:"/images/icon_facebook.svg",alt:"Facebook",size:"footerIcon",width:26,height:26})}),(0,n.jsx)(es.Z,{type:"regularLink",href:"https://twitter.com/JoinTertulia",newWindow:!0,secureLink:!0,children:(0,n.jsx)(Y.Z,{src:"/images/IconX.svg",alt:"X (formerly Twitter)",size:"footerIcon",width:26,height:26})}),(0,n.jsx)(es.Z,{type:"regularLink",href:"https://www.instagram.com/jointertulia/",newWindow:!0,secureLink:!0,children:(0,n.jsx)(Y.Z,{src:"/images/icon_instagram.svg",alt:"Instagram",size:"footerIcon",width:26,height:26})})]})]}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{className:P().fullScreenSection,children:"Download the app"}),(0,n.jsx)("li",{className:P().fullScreenSocial,children:(0,n.jsx)("a",{href:eo.Z.APP_STORE_DOWNLOAD_LINK,target:"_blank",rel:"noreferrer",children:(0,n.jsx)(Y.Z,{src:"/images/app_store.svg",width:150,height:50,alt:"Download the app"})})})]})]})})]})]})},{}),e$&&(0,n.jsx)(es.Z,{type:"button",style:{padding:0},onPress:()=>{C((0,W.kX)("OFF")),S.replace({pathname:"/ask",query:{}})},href:"#",children:(0,n.jsxs)(H.Z,{cssClass:"UI_askHeaderLogo",children:[(0,n.jsx)(Y.Z,{src:"/images/IconAngleLeft.svg",alt:"Angle Left Icon",width:28,height:28,noWrapper:!0}),(0,n.jsx)(Y.Z,{src:"/images/TertuliaLogo.svg",alt:"Tertulia logo",width:120,height:15,noWrapper:!0})]})}),!e$&&(0,n.jsx)("div",{className:[P().headerContainer,e2?P().headerContainerLeft:null].join(" ").trim().replace(/ +(?= )/g,""),children:(0,n.jsx)("div",{className:P().headerLogoContainer,children:(0,n.jsx)(es.Z,{href:"/",title:"Books Worth Talking About",children:(0,n.jsx)(Y.Z,{size:"block",src:"/images/TertuliaLogo.svg",resizeMode:"contain",alt:"Tertulia Logo",width:100,height:40,noLazy:!0})})})})]}),(0,n.jsx)(H.Z,{cssClass:"UI_headerInnerCenter",children:i}),e8(P().headerInnerRightMobile),(0,n.jsx)("div",{className:P().headerLinkTopRight,children:(0,n.jsx)(es.Z,{href:"https://authors.tertulia.com/?utm_source=tertulia_com&utm_medium=website&utm_content=header_link",children:(0,n.jsxs)("div",{className:P().headerLinkItem,children:[(0,n.jsx)("span",{className:P().newBadge,children:"New!"}),(0,n.jsx)("span",{children:"Websites for Authors"})]})})})]}),!e3&&!e2&&(0,n.jsx)("div",{className:P().headerInnerSearch,children:(0,n.jsx)("div",{className:P().headerInnerSearchCenter,children:i})}),!e3&&!e$&&(0,n.jsxs)("div",{className:P().headerCategories,"aria-label":"Main menu",role:"navigation",children:[(0,n.jsxs)("ul",{className:P().headerCategoriesMenu,children:[!R.tq&&(0,n.jsx)("li",{children:(0,n.jsx)(eH,{url:ey,label:"New Arrivals"})}),(0,n.jsx)("li",{children:(0,n.jsx)(eX,{baseUrl:"/books/fiction",title:"Fiction",categories:eb})}),(0,n.jsx)("li",{children:(0,n.jsx)(eX,{baseUrl:"/books/non-fiction",title:"Non-Fiction",categories:ev})}),(0,n.jsx)("li",{children:(0,n.jsx)(eH,{url:"/belletrist ",label:"Belletrist"})}),(0,n.jsx)("li",{children:(0,n.jsx)(eX,{baseUrl:"",title:"News & Features",categories:[{url:"lists",label:"Lists"},{url:"articles",label:"Blog"}],hideBottomLink:!0})}),(0,n.jsx)("li",{children:(0,n.jsx)(eH,{url:"/membership",label:"Membership"})})]}),e8(P().headerInnerRight)]}),!e3&&(0,n.jsx)("hr",{className:P().hidden}),!e3&&e1&&!eQ&&(0,n.jsx)(T(),{href:"/membership",className:P().headerBannerStripe,rel:"noreferrer",children:"The co-op bookstore for avid readers"}),t]})};function em(){let{shouldHideDesktopUI:e}=(0,Z.DP)(),r=(0,B.d)();return e?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)("footer",{id:"tertulia_footer",className:P().footer,children:(0,n.jsxs)("div",{className:P().footerContainer,children:[(0,n.jsxs)("nav",{className:P().footerMenu,"aria-label":"Footer menu",children:[(0,n.jsxs)("ul",{className:P().footerMainMenu,children:[(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:"/",type:"regularLink",children:(0,n.jsx)(Y.Z,{src:"/images/TertuliaLogoWhite.svg",alt:"Tertulia",width:120,height:16})})}),(0,n.jsx)("li",{className:P().footerSpacer}),(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:"/books/fiction",type:"regularLink",children:"Fiction"})}),(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:"/books/non-fiction",type:"regularLink",children:"Non-Fiction"})}),(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:r,type:"regularLink",children:"New Arrivals"})}),(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:"/gift-card",type:"regularLink",children:"Gift Cards"})}),(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:"/booklinks",type:"regularLink",children:"Games"})}),(0,n.jsx)("li",{className:P().footerSpacer}),(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:"/belletrist",type:"regularLink",children:"Belletrist Book Club"})}),(0,n.jsx)("li",{className:P().footerSpacer}),(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:"/about",type:"regularLink",children:"About Tertulia"})}),(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:"/membership",type:"regularLink",children:"Membership"})}),(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:"/shipping",type:"regularLink",children:"Shipping & Delivery"})}),(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:"/orders",type:"regularLink",children:"Orders & Payments"})}),(0,n.jsx)("li",{children:(0,n.jsx)(es.Z,{href:"/support",type:"regularLink",children:"Contact Support"})}),(0,n.jsx)("li",{className:P().footerSpacer}),(0,n.jsx)("li",{children:(0,n.jsxs)(es.Z,{href:"https://authors.tertulia.com/?utm_source=tertulia_com&utm_medium=website&utm_content=footer_link",type:"regularLink",children:["Websites for Authors ",(0,n.jsx)("span",{className:P().newBadgeLG,children:"New!"})]})})]}),(0,n.jsxs)("ul",{className:P().footerSocialMenu,children:[(0,n.jsx)("li",{className:P().footerSection,children:"Follow us"}),(0,n.jsxs)("li",{className:P().footerSocial,children:[(0,n.jsx)(es.Z,{type:"regularLink",href:"https://www.facebook.com/JoinTertulia",newWindow:!0,secureLink:!0,children:(0,n.jsx)(Y.Z,{src:"/images/IconFacebookWhite.svg",alt:"Facebook",size:"footerIcon",width:26,height:26})}),(0,n.jsx)(es.Z,{type:"regularLink",href:"https://twitter.com/JoinTertulia",newWindow:!0,secureLink:!0,children:(0,n.jsx)(Y.Z,{src:"/images/IconXWhite.svg",alt:"X (formerly Twitter)",size:"footerIcon",width:26,height:26})}),(0,n.jsx)(es.Z,{type:"regularLink",href:"https://www.instagram.com/jointertulia/",newWindow:!0,secureLink:!0,children:(0,n.jsx)(Y.Z,{src:"/images/IconInstagramWhite.svg",alt:"Instagram",size:"footerIcon",width:26,height:26})}),(0,n.jsx)(es.Z,{type:"regularLink",href:"https://www.tiktok.com/@tertulia_books",newWindow:!0,secureLink:!0,children:(0,n.jsx)(Y.Z,{src:"/images/IconTikTokWhite.svg",alt:"TikTok",size:"footerIcon",width:26,height:26})})]})]}),(0,n.jsxs)("ul",{className:P().footerSocialMenu,children:[(0,n.jsx)("li",{className:P().footerSection,children:"Download the app"}),(0,n.jsx)("li",{className:P().footerSocial,children:(0,n.jsx)(es.Z,{type:"regularLink",href:eo.Z.APP_STORE_DOWNLOAD_LINK,newWindow:!0,secureLink:!0,children:(0,n.jsx)(Y.Z,{src:"/images/app_store.svg",width:150,height:50,alt:"Download the app"})})})]}),(0,n.jsxs)("ul",{className:P().footerMenuCopy,children:[(0,n.jsx)("li",{className:P().footerMenuCopyName,children:"\xa9 Tertulia"}),(0,n.jsx)("li",{children:(0,n.jsx)("div",{children:(0,n.jsxs)("ul",{className:P().footerMenuInner,children:[(0,n.jsx)("li",{children:(0,n.jsx)(T(),{href:"/terms",children:"Terms of Use"})}),(0,n.jsx)("li",{children:(0,n.jsx)(T(),{href:"/privacy",children:"Privacy Policy"})})]})})}),(0,n.jsx)("li",{className:P().footerMenuVersion,children:(0,b.bT)()})]})]}),(0,n.jsx)("div",{className:P().footerEndSpacing})]})})}var ep=s(55087),ef=s(81758),eg=s.n(ef);function ex(e){let{appDeepLink:r}=e,s=(0,c.useRouter)();return(0,n.jsxs)("div",{className:eg().container,children:[(0,n.jsxs)("div",{className:eg().containerLeft,children:[(0,n.jsx)("img",{src:"/images/tertulia-icon.png",width:32,height:32,alt:"Tertulia App icon",loading:"lazy",className:eg().tertuliaIcon}),(0,n.jsxs)("div",{className:eg().containerText,children:[(0,n.jsx)("span",{children:"Tertulia"}),(0,n.jsx)("p",{children:"Open in Tertulia app"})]})]}),(0,n.jsx)("div",{className:eg().button,onClick:()=>{let e=(0,ep.A)(r||"");s.replace("tertulia://".concat(e)),setTimeout(()=>{s.replace(eo.Z.APP_STORE_DOWNLOAD_LINK)},500)},children:(0,n.jsx)("label",{children:"OPEN"})})]})}var ej=s(64143),eb=e=>{let[r,s]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{let r=r=>{let{key:t}=r;t===e&&s(!0)},t=r=>{let{key:t}=r;t===e&&s(!1)};return window.addEventListener("keydown",r),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",r),window.removeEventListener("keyup",t)}},[e]),r},ev=s(79683),ey=s(40457),ew=s.n(ey),ek=s(91067),eN=s(50656);let eZ=V.Z.create({input:{height:46*1.3,flex:1,paddingTop:X.ZP.gutters.paddingSM,paddingRight:70,paddingBottom:X.ZP.gutters.paddingXS,paddingLeft:X.ZP.gutters.paddingSM+2,...X.ZP.fonts.searchInput,backgroundColor:X.ZP.colors.gray1,borderWidth:2,borderColor:X.ZP.colors.mercury,borderRadius:5,textAlignVertical:"center"},inputFocused:{borderColor:X.ZP.colors.stone}});(t=i||(i={}))[t.Initial=0]="Initial",t[t.Recent=1]="Recent",t[t.Predict=2]="Predict",t[t.Results=3]="Results";var e_=function(){let e=(0,c.useRouter)(),{loggedIn:r,user:s}=(0,x.Pk)(),{globalUrlParams:t}=(0,N.CG)(e=>e.globalparams),{results:a}=(0,N.CG)(e=>e.ask),{q:i}=e.query,l=(0,N.TL)(),[d,u]=(0,o.useState)(i),[h,m]=(0,o.useState)(!1),[p,f]=(0,o.useState)(!1),[j,b]=(0,o.useState)(!1),v=(0,o.useRef)(null),{sendSegmentTrack:y}=(0,g.Z)(),w=(0,o.useRef)(null),{dropdownRef:k,isOpen:Z,open:C,close:S}=q({additionalRefs:[w]}),[P,I]=(0,o.useState)(-1),L=2===(0,o.useMemo)(()=>p?3:i&&i.length>3&&h?2:0,[i,h,p]),{history:T,autocomplete:M,loading:E}=(0,N.CG)(e=>e.search),A=(0,o.useMemo)(()=>[...T].reverse().filter(Boolean),[T]),R=(0,o.useMemo)(()=>h&&!L?A.length:M.length,[M,h,L,A.length]),B=F.kw,D=F.zj-a.length,O=(null==d?void 0:d.length)>F.K8,U=O&&(D>0||r)||O&&B,G=()=>{v.current&&v.current.focus()};function H(e){_.Z.emit("Navigation Navigate",{name:"ask",params:{q:e}})}(0,o.useEffect)(()=>{u(i||""),G()},[i]);let z=e=>{U&&(S(),l((0,W.Ug)(d)),l((0,W.kX)("ON")),f(!0),m(!1),H(e))},Y=eb("ArrowUp"),V=eb("ArrowDown");(0,o.useEffect)(()=>{P>0&&Y&&I(Number(P-1))},[P,Y]),(0,o.useEffect)(()=>{V&&P<R&&I(P+1)},[P,V,R]),(0,o.useEffect)(()=>{Z?document.body.classList.add("overflow-hidden"):document.body.classList.remove("overflow-hidden")},[Z]);let J=e=>{e.target.style.height="auto",e.target.style.height=X.ZP.gutters.paddingXS+e.target.scrollHeight+"px"};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:ew().headerSearchBox,children:[(0,n.jsxs)("div",{className:ew().headerSearch,ref:w,children:[(0,n.jsx)(ej.Z,{style:[eZ.input,Z&&eZ.inputFocused],value:d,onChangeText:e=>{G(),u(e),f(!1),I(-1),e.endsWith("\n")&&(u(e.trim()),z(d))},placeholder:"Ask for any book",onFocus:()=>{m(!0)},onSubmitEditing:()=>z(d),returnKeyType:"search",placeholderTextColor:X.ZP.colors.gray3,onKeyPress:e=>{38===e.keyCode&&P>0?I(P-1):40===e.keyCode&&P<R-1&&I(P+1)},ref:v,onChange:e=>{J(e)},multiline:!0}),!!d&&(0,n.jsx)("button",{className:ew().sendClearBtn,onClick:()=>{l((0,W.R8)()),e.replace({pathname:"/ask",query:{}}),u(""),l((0,W.kX)("IDLE")),H(""),I(-1),setTimeout(()=>{G(),b(!1)},100)},children:(0,n.jsx)(ev.Z,{})}),(0,n.jsx)("button",{className:[ew().sendButton,!U&&ew().sendButtonDisabled].join(" "),onClick:()=>{d?z(d):(m(!0),C())},title:"Search",disabled:!U,children:(0,n.jsx)(eN.Z,{width:24,height:32})})]}),!1]})})},eC=s(18969),eS=s(57299),eP=e=>{let{title:r,onSelected:s,onRemoved:t,isActive:a}=e,i=(0,o.useRef)(null);return(0,o.useEffect)(()=>{a&&i.current.focus()},[a]),(0,n.jsxs)("li",{className:ew().listItem,children:[(0,n.jsx)(es.Z,{href:"/search?q=".concat(r),dataCy:"title-recent-search-".concat(r),children:(0,n.jsx)("a",{className:[ew().listItemLink,a?ew().listItemLinkActive:null].join(" ").trim().replace(/ +(?= )/g,""),onClick:()=>s(r),ref:i,children:r})}),(0,n.jsx)("button",{className:ew().listItemDelete,onClick:e=>t(r,e),children:(0,n.jsx)(ev.Z,{"data-cy":"icn-recentsearch-close"})})]})},eI=function(e){let{listElements:r,onSelected:s,onRemoved:t,currentElement:a,isLoading:i,listIsActive:l}=e;return i?(0,n.jsx)("li",{className:ew().dropdownTitleBox,children:(0,n.jsx)(z.Z,{type:"p",format:"headerMD",bold:!0,nospace:!0,children:"Loading..."})}):0===r.length?(0,n.jsx)(n.Fragment,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("li",{className:ew().dropdownTitleBox,children:(0,n.jsx)(z.Z,{type:"p",format:"headerMD",bold:!0,nospace:!0,dataCy:"label-recent-searches",children:"Recent Searches"})}),r.map((e,r)=>(0,n.jsx)(eP,{title:e,onSelected:s,onRemoved:t,isActive:l&&a===r},e))]})},eL=e=>{let{title:r,onSelected:s,isActive:t}=e,a=(0,o.useRef)(null);return(0,o.useEffect)(()=>{t&&a.current.focus()},[t]),(0,n.jsx)("li",{className:ew().listItem,children:(0,n.jsx)(T(),{href:"/search?q=".concat(r),className:[ew().listItemLink,t?ew().listItemLinkActive:null].join(" ").trim().replace(/ +(?= )/g,""),onClick:()=>s(r),ref:a,"data-cy":"search-results-".concat(r),children:r})})},eT=function(e){let{listElements:r,onSelected:s,keyword:t,currentElement:a,isLoading:i,listIsActive:l}=e,c=(0,N.TL)();return((0,o.useEffect)(()=>{c((0,ek.z1)(t))},[c,t]),i)?(0,n.jsx)("li",{className:ew().dropdownTitleBox,children:(0,n.jsx)(z.Z,{type:"p",format:"headerMD",bold:!0,nospace:!0,dataCy:"label-searchbar-loading",children:"Loading..."})}):0===r.length?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)(n.Fragment,{children:r.map((e,r)=>(0,n.jsx)(eL,{title:e,onSelected:s,isActive:l&&a===r},e))})};let eM=V.Z.create({input:{height:46,flex:1,paddingLeft:X.ZP.gutters.paddingSM+2,paddingRight:86,...X.ZP.fonts.searchInput,backgroundColor:X.ZP.colors.gray1,borderWidth:2,borderColor:X.ZP.colors.mercury,borderRadius:5},inputFocused:{borderColor:X.ZP.colors.stone}});var eE=s(52759);(a=l||(l={}))[a.Initial=0]="Initial",a[a.Recent=1]="Recent",a[a.Predict=2]="Predict",a[a.Results=3]="Results";var eA=function(e){let{searchQuery:r}=e,{globalUrlParams:s}=(0,N.CG)(e=>e.globalparams),t=(0,N.CG)(e=>e.user),a=(0,N.TL)(),[i,l]=(0,o.useState)(r||""),[c,d]=(0,o.useState)(!1),[u,h]=(0,o.useState)(!1),[m,p]=(0,o.useState)(),[x,j]=(0,o.useState)(!1),{sendSegmentTrack:b}=(0,g.Z)(),v=(0,o.useRef)(null),{dropdownRef:y,isOpen:w,open:k,close:Z}=q({additionalRefs:[v]}),[C,S]=(0,o.useState)(-1),P=2===(0,o.useMemo)(()=>u?3:i.length>3&&c?2:0,[i,c,u]),{history:I,autocomplete:L,loading:T}=(0,N.CG)(e=>e.search),M=(0,o.useMemo)(()=>[...I].reverse().filter(Boolean),[I]),E=(0,o.useMemo)(()=>c&&!P?M.length:L.length,[L,c,P,M.length]);function F(e){_.Z.emit("Navigation Push",{name:"Search",params:{q:e}})}let R=e=>{i.length>3&&(Z(),b({name:A.FP.ProductsSearched,params:(0,f.pS)({user:t,search_query:e,search_initial_context:"user search term",initial_url_params:null==s?void 0:s.urlParams})}),a((0,ek.Ug)()),a((0,ek.F0)(e)),h(!0),d(!1),F(e))},B=e=>{b({name:A.FP.ProductsSearched,params:(0,f.pS)({user:t,search_query:e,search_initial_context:"auto-complete",initial_url_params:null==s?void 0:s.urlParams})}),l(e),a((0,ek.Ug)()),a((0,ek.F0)(e)),h(!0),d(!1),F(e)},D=eb("ArrowUp"),W=eb("ArrowDown");return(0,o.useEffect)(()=>{C>0&&D&&S(Number(C-1))},[C,D]),(0,o.useEffect)(()=>{W&&C<E&&S(C+1)},[W,C,E]),(0,o.useEffect)(()=>{w?document.body.classList.add("overflow-hidden"):document.body.classList.remove("overflow-hidden")},[w]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:ew().headerSearchBox,children:[(0,n.jsxs)("div",{className:ew().headerSearch,ref:v,"data-cy":"desktop-searchbar",children:[(0,n.jsx)(ej.Z,{style:w?eM.inputFocused:void 0,value:i,autoComplete:"off",onChangeText:e=>{m.focus(),l(e),h(!1),S(-1)},placeholder:"Search author or title",onFocus:()=>{d(!0),k()},onSubmitEditing:()=>R(i),returnKeyType:"search",placeholderTextColor:X.ZP.colors.gray3,onKeyPress:e=>{38===e.keyCode&&C>0?S(C-1):40===e.keyCode&&C<E-1&&S(C+1)},ref:e=>{p(e)}}),(0,n.jsx)("button",{className:ew().searchButton,onClick:()=>{i?R(i):(d(!0),k())},title:"Search",children:(0,n.jsx)(Y.Z,{svgElement:(0,n.jsx)(eE.Z,{}),src:"/images/IconSearchWhite.svg",alt:"Search icon",width:28,height:28,"data-cy":"btn-icn-search",noWrapper:!0})}),!!i&&(0,n.jsx)("button",{className:ew().clearBtn,onClick:()=>{l(""),S(-1),setTimeout(()=>{m.focus(),j(!1)},100)},children:(0,n.jsx)(ev.Z,{"data-cy":"btn-delete-search"})})]}),(w||x)&&(c&&!P||P)&&(0,n.jsx)(n.Fragment,{children:w&&(I.length||P)&&(0,n.jsx)("ul",{className:ew().headerDropdown,ref:y,children:(0,n.jsxs)(n.Fragment,{children:[c&&!P&&(0,n.jsx)(eI,{listElements:M,isLoading:T,onSelected:B,onRemoved:(e,r)=>{r&&r.preventDefault(),j(!0),a((0,ek.M2)(e)),setTimeout(()=>{m.focus(),j(!1)},100)},currentElement:C,listIsActive:C>-1}),P&&(0,n.jsx)(eT,{listElements:L,isLoading:T,keyword:i,onSelected:B,currentElement:C,listIsActive:C>-1})]})})})]})})},eF=function(){return(0,n.jsx)("div",{className:P().headerLinkRow,children:(0,n.jsx)(es.Z,{href:"https://authors.tertulia.com/?utm_source=tertulia_com&utm_medium=website&utm_content=header_link",children:(0,n.jsxs)("div",{className:P().headerLinkItem,children:[(0,n.jsx)("span",{className:P().newBadge,children:"New!"}),(0,n.jsx)("span",{children:"Websites for Authors"})]})})})};function eR(e){var r,s,t,a,i,l,u,_;let{children:C,heroContent:S,pageTitle:L,currentScreen:T,appDeepLink:M,noSegmentEvent:E,segmentEventName:A,fullHeader:F,className:R,params:B,searchQuery:D,showPromos:W=!0,onlyMain:O=!1,hideBottomBorder:U,hideFooter:G,showAffiliateBanner:q,centeredLogoHeader:H,minimalLeftLogoHeader:z,minimalCenteredLogoHeader:Y}=e,V=L||"Tertulia",X=(0,c.useRouter)(),J=(0,N.TL)(),{sendSegmentScreen:K}=(0,g.Z)(),{isStoreStarted:Q,authenticated:$,user:ee}=(0,x.Pk)(),{allMyLists:er,fetchMyLists:es}=(0,j.Z)(),{askStatus:et}=(0,N.CG)(e=>e.ask),ea=(0,f.pS)(null==B?void 0:B.dataForSegmentEventProperties),ei=null==B?void 0:null===(r=B.dataForSegmentEventProperties)||void 0===r?void 0:r.product,el=null==B?void 0:null===(s=B.dataForSegmentEventProperties)||void 0===s?void 0:s.mention,en=null==ea?void 0:null===(t=ea.context)||void 0===t?void 0:t.from_bisac_category,eo=null==ea?void 0:null===(a=ea.context)||void 0===a?void 0:a.from_category,ec=null==ea?void 0:null===(l=ea.context)||void 0===l?void 0:null===(i=l.from_search)||void 0===i?void 0:i.query,ed=null==ea?void 0:null===(_=ea.context)||void 0===_?void 0:null===(u=_.from_search)||void 0===u?void 0:u.context,{shouldHideDesktopUI:eu}=(0,Z.DP)(),{globalUrlParams:ep}=(0,N.CG)(e=>e.globalparams),ef=(0,o.useRef)(),eg=function(e,r){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,[t,a]=(0,o.useState)();return(0,o.useEffect)(()=>{setTimeout(()=>{a(e())},s)},r),t}(()=>m.gn&&!m.G6&&M,[M]),{ModalsRenderer:ej}=(0,p.Z)(),{banners:eb}=(0,eS.Z)(),[ev,ey]=(0,o.useState)(!1),[ew,ek]=(0,o.useState)(!0),eN=X.pathname.includes("/ask")&&("ON"===et||"IDLE"===et||"RESPONSE"===et),eZ=["/emilyhenrygiveaway","/dollyaldertongiveaway","/ultimatesummerbundlegiveaway","/success-giveaway","/instagramtoolforauthors","/instagramtoolforauthors/success","/onboarding-select-book-read-liked"],eP=[...eZ].includes(X.pathname),eI=[...eZ].includes(X.pathname),eL=z||Y;return(0,o.useEffect)(()=>{let e=setInterval(()=>{if(Q){clearInterval(e);let r=new Date(null==ep?void 0:ep.visitDate).getTime(),s=new Date(h()().format()).getTime(),{allUrlParams:t}=(0,Z.DP)();if(Object.keys(t).length>0){let e=["step","page","productId","q","slug","orderId","platform","redirect_to","order_id","order_number","order_total","order_subtotal","order_shipping","order_tax","selected_topics_fiction","selected_topics_non_fiction"],r={...t},a=Object.keys(r).reduce((s,t)=>(e.includes(t)||(s[t]=r[t]),s),{});if(a!==(null==ep?void 0:ep.urlParams)){let e={urlParams:a,visitDate:s};J((0,v.bi)(e)),ef.current=null==e?void 0:e.urlParams}}else(0,b.br)(s,r)&&J((0,v.uB)());E||K({name:A||V,params:(0,f.pS)({user:ee,product:ei,mention:el,bisacCategory:en,productCategory:eo,search_keyword:ec,search_context:ed,current_screen:T,previous_screen:(0,k.z1)(),initial_url_params:ef.current})}),$&&0===er.length&&es()}},500);return()=>clearInterval(e)},[Q,X.asPath,null==ee?void 0:ee.id]),(0,o.useEffect)(()=>{ey(!eN&&W&&!eP&&!eL)},[eN,W,eP,eL]),(0,o.useEffect)(()=>{ek(!F&&!U&&!eN&&!eL)},[F,U,eN,eL]),(0,w.W)(async()=>!0===(await J((0,y.p8)())).payload,{useFibonacci:!0,maxRetries:5}),(0,n.jsxs)("div",{id:"layout-app-root",className:[eN?P().rootAsk:P().root,$?P().isAuthenticated:P().isGuest].join(" ").trim().replace(/ +(?= )/g,""),children:[(0,n.jsx)("div",{children:(0,n.jsx)(d.x7,{toastOptions:{duration:4e3,icon:null,success:{style:{color:"#fff",background:"#000",borderRadius:28,textAlign:"center"}},error:{style:{background:"red"}}}})}),!eu&&!z&&!Y&&(0,n.jsxs)(n.Fragment,{children:[eg&&(0,n.jsx)(ex,{appDeepLink:M}),ev&&(0,n.jsx)(eF,{}),!$&&(0,n.jsx)(I,{wrapperId:"header_signUp_log_in"}),ev&&(0,n.jsx)(eC.Z,{banners:eb})]}),(0,n.jsxs)(eh,{fullHeader:F,heroContent:S,hideBottomBorder:U,centeredLogoHeader:H,minimalLeftLogoHeader:z,minimalCenteredLogoHeader:Y,user:ee,showAffiliateBanner:q,children:[!eN&&!eL&&(0,n.jsx)(eA,{searchQuery:D}),eN&&(0,n.jsx)(e_,{})]}),ew&&!eL&&(0,n.jsx)("div",{className:P().logoVerticalLine}),!O&&(0,n.jsx)("div",{id:"main_for_home",className:R||(F?P().containerForHome:P().container),children:(0,n.jsx)("div",{className:F?P().mainForHome:P().main,children:C})}),O&&(0,n.jsx)("div",{className:R||P().main,children:C}),(0,n.jsx)(ej,{}),!eN&&!eI&&!G&&(0,n.jsx)(em,{})]})}}}]);