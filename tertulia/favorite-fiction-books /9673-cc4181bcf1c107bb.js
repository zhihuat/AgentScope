(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9673],{85082:function(e,t,o){"use strict";var i=o(85893),r=o(67294),n=o(5152),l=o.n(n),s=o(72215),a=o(98502),d=o(62399),c=o(82365);let u=l()(()=>o.e(716).then(o.bind(o,40716)),{loadableGenerated:{webpack:()=>[40716]},ssr:!1});t.Z=r.memo(function(e){let{category:t,index:o,onProductSelected:n,activeCategoryBisac:l,showsHorizontalScrollIndicator:d,action:m}=e,p=(0,s.TL)(),{product:h,size:g,last:x,page_number:Z,loading:v,empty:y,error_message:f}=(0,s.CG)(e=>{var o,i,r;return(null===(o=e.home)||void 0===o?void 0:o.products)&&(null===(i=e.home)||void 0===i?void 0:i.products[t.id])?null===(r=e.home)||void 0===r?void 0:r.products[t.id]:a.eN}),b=(0,r.useCallback)(()=>{x||p(m({category:t.id,page:Z+1,source:t.source,bisacCategoryCode:null==l?void 0:l.code}))},[m,null==l?void 0:l.code,t.id,t.source,p,x,Z]);if(f)return null;let P=h.length>0;return(0,i.jsx)(c.Z,{styleWeb:{minHeight:P?"300px":"0"},children:(0,i.jsx)(u,{productCategory:t,firstRow:0===o,title:t.name,products:h,size:g,loading:v,onLoadNext:b,onProductSelected:n,showsHorizontalScrollIndicator:d,empty:y,lastPage:x})})},d.E)},13746:function(e,t,o){"use strict";o.d(t,{Z:function(){return h}});var i=o(85893),r=o(67294),n=o(55981),l=o(43539),s=o(19738),a=o(40629),d=o(30687),c=o(87529),u=o(64521),m=o(86393);let p=o(82463).Z.create({item:{flexDirection:"row",marginRight:m.ZP.margin.sm},column:{flex:1,display:"flex",justifyContent:"center"},columnTablet:{maxWidth:m.ZP.productCoverLG.width},imageContainer:{minHeight:m.ZP.productCoverSM.height+m.ZP.margin.lg,display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center"},imageSmall:{minHeight:m.ZP.productCoverXS.height},productNoImage:{...m.ZP.productCoverBASE}});var h=r.memo(function(e){let{product:t,onProductSelected:o,productCategory:r,smallCover:h}=e,g=(0,n.ZP)(),x=(null==t?void 0:t.image_url)||(null==t?void 0:t.thumb_url),Z=(0,l.MH)(null==t?void 0:t.book_url),v={width:g.isMobile?h?63:108:150,height:g.isMobile?h?96:144:210};return(0,i.jsx)(d.Z,{href:Z,onPress:e=>o(e,t,r),style:p.item,title:null==t?void 0:t.title,cssClass:"Product_productLink",type:s.tq?"":"regularLink",children:(0,i.jsxs)(u.Z,{type:"span",style:[p.column,g.isTabletUp&&p.columnTablet],cssClass:"Product_mention",children:[(0,i.jsx)(u.Z,{type:"span",style:[p.imageContainer,h&&p.imageSmall],cssClass:"Product_imgBox",children:(0,i.jsx)(a.Z,{style:[m.ZP.productCoverBASE,h&&m.ZP.productCoverXS,g.isTabletUp&&m.ZP.productCoverLG,!x&&p.productNoImage],src:x&&x.toString(),alt:"Book Cover for: ".concat(null==t?void 0:t.title,", ").concat(null==t?void 0:t.author_name),size:g.isTabletUp?"productCoverLG":h?"productCoverXS":"productCoverBASE",resizeMode:"contain",position:"center",width:v.width,height:v.height,noWrapper:!0,forMention:!0})}),t.shared_at?(0,i.jsxs)(c.Z,{type:"span",format:"sm",noBaseFormat:!0,children:["Shared ",(0,l.Sy)(t.shared_at)]}):null]})})})},43763:function(e,t,o){"use strict";o.d(t,{Z:function(){return T}});var i=o(85893),r=o(67294),n=o(32144),l=o(37548),s=o(39945),a=o(17609),d=o(94809),c=o(19738),u=o(39149),m=o(91960),p=o(83841),h=o(45033),g=o(67648),x=o(3978),Z=o(82463),v=o(86393);let y=Z.Z.create({item:{display:"flex",justifyContent:"flex-start",flexDirection:"row",alignItems:"center",minHeight:44,paddingHorizontal:v.ZP.margin.sm,borderBottomColor:v.ZP.colors.gray1,borderBottomWidth:1},title:{...v.ZP.fonts.md,paddingHorizontal:v.ZP.margin.sm,paddingVertical:v.ZP.margin.sm},icon:{width:24,height:24}});class f extends r.PureComponent{render(){let{title:e,icon:t,style:o,onOptionSelected:r}=this.props;return(0,i.jsxs)(x.Z,{onPress:()=>r(),style:[y.item,o],children:[(0,i.jsx)(t,{style:y.icon}),(0,i.jsx)(s.Z,{style:y.title,children:e})]})}}var b=o(42188),P=o(83861),j=o(25937),_=o(88830),C=o(61200),w=o(64822),k=o(25008),S=o(85256);let M=Z.Z.create({bottomItem:{marginBottom:v.ZP.margin.sm},shareListWarningContainer:{paddingTop:v.ZP.gutters.paddingNormal,paddingHorizontal:v.ZP.gutters.paddingNormal,borderTopWidth:1,borderTopColor:v.ZP.colors.gray2},shareListWarningText:{...v.ZP.fontsMobile.SM}});var T=function(e){let t,{onSuccess:o,onFail:r,product:x,article:Z,list:y,mentioner:T,publicProfile:L,editorialList:D,...R}=e,{pushToast:I}=(0,p.Z)(),E=[],A=c.$L?"web":"app",B={product:x,article:Z,list:y,mentioner:T,publicProfile:L,editorialList:D};return c.tq&&E.push({title:"Message",icon:b.Z,onSelected:async e=>{let{onSuccess:t,onFail:o}=e;try{let e=c.tq?"&":"?",{url:o}=(0,S.cd)(B,e);t&&await t("MESSAGE","PERSON"),await n.Z.openURL(o)}catch(e){o&&o(e),m.Z.sendError(e)}}}),E.push({title:"Email",icon:P.Z,onSelected:async e=>{let{onSuccess:t,onFail:o}=e;try{let{subject:e,message:o}=(0,S.VP)(B,A,!!x),i="mailto:?subject=".concat(e,"&body=").concat(o);t&&await t("EMAIL","PERSON"),await n.Z.openURL(i)}catch(e){o&&o(e),m.Z.sendError(e)}}}),E.push({title:"X (formerly Twitter)",icon:j.Z,onSelected:async e=>{let{onSuccess:t,onFail:o}=e;try{t&&await t("TWITTER","SOCIAL_NETWORK"),await a.Z.shareSingle((0,S.RL)(B,A))}catch(e){o&&o(e),m.Z.sendError(e)}}}),!c.tq||y||D||E.push({title:"Instagram Story",icon:_.Z,onSelected:async e=>{let{onSuccess:t,onFail:o}=e;try{t&&await t("INSTAGRAM STORY","SOCIAL_NETWORK"),await a.Z.shareSingle((0,S.Uw)(B,A))}catch(e){o&&o(e),m.Z.sendError(e)}}}),E.push({title:"Facebook",icon:C.Z,onSelected:async e=>{let{onSuccess:t,onFail:o}=e;try{t&&await t("FACEBOOK","SOCIAL_NETWORK"),await a.Z.shareSingle((0,S.an)(B,A))}catch(e){o&&o(e),m.Z.sendError(e)}}}),E.push({title:"Copy Link",icon:w.Z,onSelected:async e=>{let{onSuccess:t}=e;if(t&&await t("CLIPBOARD","UNKNOWN"),c.tq)d.Z.setString((0,S.EO)(B,A).url),I({type:"success",text:"Link copied!"});else try{await navigator.clipboard.writeText((0,S.EO)(B,A).url),I({type:"success",text:"Link copied!"})}catch(e){I({type:"error",text:"Link not copied"})}}}),c.tq&&E.push({title:"Share",icon:k.Z,onSelected:async e=>{let{onSuccess:t,onFail:o}=e;a.Z.open((0,S.vC)(B,A)).then(e=>t&&t(e.message,"UNKNOWN")).catch(e=>{o&&o(e),m.Z.sendError(e)})}}),!c.tq&&navigator.share&&E.push({title:"Share",icon:k.Z,onSelected:async()=>{let{subject:e,message:t}=(0,S.VP)(B,A,!!x);navigator.share({title:e,text:t,url:(0,S.EO)(B,A).url}).then(()=>console.log("Thanks for sharing!")).catch(e=>console.log("Error sharing",e))}}),(0,i.jsxs)(g.Z,{position:c.tq?"bottom":"center",title:(t="Share ",x?t+"Book":Z?t+"Article":y?t+"List":T?t+"Voice":L?t+"Public Profile":t),noChrome:!1,floatingClose:!1,style:c.tq?v.W0.modalMobile:v.W0.modalDesktop,scroll:!0,flexibleBody:!0,...R,children:[E.map(e=>(0,i.jsx)(f,{title:e.title,icon:e.icon,onOptionSelected:()=>e.onSelected({onSuccess:o,onFail:r})},e.title)),y&&y.visibility===u.wI.PRIVATE?(0,i.jsx)(l.Z,{style:M.shareListWarningContainer,children:(0,i.jsx)(s.Z,{style:M.shareListWarningText,children:"Once you share this link, anyone with the link can view your list."})}):null,c.tq&&(0,i.jsx)(h.Z,{size:"xl3"})]})}},98146:function(e,t,o){"use strict";var i=o(85893),r=o(67294);t.Z=function(e){let{source:t,iframeStyle:o,style:n,onLoad:l,onNavigationStateChange:s}=e,{width:a,height:d}=n,c=(0,r.useRef)(null);return(0,r.useEffect)(()=>{var e,t;s&&(null===(e=c.current)||void 0===e||e.addEventListener("change",function(){var e;s({url:(null===(e=this.contentWindow)||void 0===e?void 0:e.location.href)||""})})),l&&(null===(t=c.current)||void 0===t||t.addEventListener("load",function(){var e;l({url:(null===(e=this.contentWindow)||void 0===e?void 0:e.location.href)||""})}))},[c,s]),(0,i.jsx)("iframe",{src:"".concat(t.uri),width:a,height:d,ref:c,style:o})}},49673:function(e,t,o){"use strict";o.d(t,{Z:function(){return tj}});var i=o(85893),r=o(67294),n=o(72215),l=o(43539),s=o(19738),a=o(79045),d=o(39149),c=o(16627),u=o(71567),m=o(83841),p=o(86713),h=o(58218),g=o(65319),x=o(98502),Z=o(37548),v=o(54834),y=o(55495),f=o(31476),b=o(90900),P=o(55981),j=o(30960),_=o(98932),C=o(39330),w=o(64521),k=o(40629),S=o(45033),M=o(87529),T=o(94367),L=o(13746),D=o(82463),R=o(86393);let I=D.Z.create({body:{paddingVertical:R.ZP.margin.xs,marginBottom:R.ZP.margin.sm,marginRight:-R.ZP.margin.md},bodyWithBorder:{paddingVertical:R.ZP.margin.sm,paddingHorizontal:R.ZP.margin.sm,borderTopWidth:3,borderTopColor:R.ZP.colors.gray1},iconTitle:{marginBottom:R.ZP.margin.sm,flexDirection:"row",alignItems:"flex-start"},title:{flexDirection:"row",...R.ZP.fonts.headerXL,marginTop:R.ZP.margin.xxs,marginLeft:R.ZP.margin.xxs},titleTabletUp:{flexDirection:"row",...R.ZP.fonts.headerXL,marginTop:R.ZP.margin.xxs},titleForRelated:{...R.ZP.fonts.headerMD,marginTop:R.ZP.margin.sm,marginBottom:R.ZP.margin.sm,marginLeft:0},emptyList:{justifyContent:"center",alignItems:"center",paddingHorizontal:R.ZP.margin.sm,paddingVertical:R.ZP.margin.md,textAlign:"center",backgroundColor:R.ZP.colors.gray1},item:{flexDirection:"row",marginRight:R.ZP.margin.sm},column:{flex:1,display:"flex",justifyContent:"center"},columnTablet:{maxWidth:R.ZP.productCoverLG.width},imageContainer:{minHeight:R.ZP.productCoverSM.height+R.ZP.margin.lg,display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center"},productImageForMovingIntoTheme:{...R.ZP.productCoverBASE,backgroundColor:R.ZP.colors.backgroundColor},productNoImage:{...R.ZP.productCoverBASE},tweeter:{display:"flex",flexDirection:"row",marginTop:R.ZP.margin.xs},tweeterAvatar:{...R.ZP.tweeterAvatarTiny,marginRight:R.ZP.margin.xs},tweeterName:{...R.ZP.fonts.xs},shareTime:{...R.ZP.fonts.sm,marginTop:R.ZP.margin.sm}}),E=e=>e.id;var A=function(e){let{title:t,products:o,loading:r,onLoadNext:n,onProductSelected:l,productCategory:s}=e;return(0,i.jsx)(w.Z,{style:[I.body],cssClass:"UI_listBody",children:o.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e=>{let{title:t,hideCount:r,forRelated:n,onTitlePressed:l}=e;return(0,i.jsxs)(M.Z,{type:"h3",format:n?"titleRelated":"titleList",onPress:()=>l&&l(s),children:[t," ",!r&&o.length>1&&"(".concat(o.length,")")]})},{title:t,forRelated:!0,hideCount:!0}),(0,i.jsx)(T.Z,{horizontal:!0,removeClippedSubviews:!0,refreshing:r,data:o,renderItem:e=>(0,i.jsx)(L.Z,{product:e.item,onProductSelected:l,productCategory:s}),keyExtractor:e=>E(e),onEndReached:n})]})})},B=(0,r.memo)(function(e){let{category:t,productId:o,onProductSelected:l,forAboutAuthor:s,onTitlePressed:a,dataCy:d}=e,c=(0,n.TL)(),u=e=>{var i,r;return"related"===t.id?null===(i=e.product.products["".concat(o)])||void 0===i?void 0:i.related:"related_bisac"===t.id?null===(r=e.product.products["".concat(o)])||void 0===r?void 0:r.related_bisac:void 0},{products:m=[],total_pages:p=-1,page_number:g=-1,loading:x=!1}=(0,n.CG)(e=>{var t;return null!==(t=u(e))&&void 0!==t?t:h._X});return(0,r.useEffect)(()=>{"related"===t.id?c((0,h.a9)(0,o)):"related_bisac"===t.id&&c((0,h.As)(0,o))},[c,t.id,o]),(0,i.jsx)(A,{title:t.title,products:m,loading:x,onLoadNext:()=>{g+1<=p&&("related"===t.id?c((0,h.a9)(Math.min(g+1,p),o)):"related_bisac"===t.id&&c((0,h.As)(Math.min(g+1,p),o)))},onProductSelected:l,productCategory:t,onTitlePressed:a,forAboutAuthor:s,"data-cy":d})}),F=o(85082),N=o(43763),z=o(38824),O=o(12005),H=o(67648),W=o(15372),V=o(86365);let G=D.Z.create({buttonPreview:{flex:1,marginHorizontal:R.ZP.margin.xxs},modalPreview:{width:"100%",height:"100%",maxWidth:R.ZP.deviceSizes.sizeDesktopXL}});var q=function(e){let{product:t}=e,{setModalContext:o}=(0,_.Z)(),l=(0,n.CG)(e=>e.product).productPreviewLink,[s,a]=(0,r.useState)(!1),d=(0,n.TL)();return((0,r.useEffect)(()=>{(null==t?void 0:t.ean)!==void 0&&d((0,h.R3)(null==t?void 0:t.ean))},[null==t?void 0:t.ean]),(0,r.useEffect)(()=>{o((0,i.jsx)(i.Fragment,{children:(0,i.jsx)(H.Z,{display:s,onClose:()=>a(!1),title:"Preview of ".concat(null==t?void 0:t.title," - ").concat(null==t?void 0:t.author_name),style:G.modalPreview,position:"center",bodyFullHeight:!0,children:(0,i.jsx)("iframe",{id:"AerioPreviewIframe",src:null==l?void 0:l.toString(),width:"100%",height:"100%",loading:"eager"})})}))},[s]),l)?(0,i.jsx)(W.Z,{size:"small",buttonIcon:(0,i.jsx)(V.Z,{width:25,height:20}),style:G.buttonPreview,inverted:!0,onPress:()=>{a(!0)},previewDesktop:!0,children:"Read a sample"},null==t?void 0:t.ean):(0,i.jsx)(i.Fragment,{})},U=o(60469),X=o(85330),Y=o.n(X),K=e=>{let{fromPhoneLG:t,fromTabletSm:o,fromTablet:r,fromDesktop:n,fromDesktopLG:l,fromDesktopXL:s,upToPhoneLG:a,upToTabletSm:d,upToTablet:c,upToDesktop:u,upToDesktopLG:m,upToDesktopXL:p,children:h}=e,g=t?Y().fromPhoneLG:o?Y().fromTabletSm:r?Y().fromTablet:n?Y().fromDesktop:l?Y().fromDesktopLG:s?Y().fromDesktopXL:0,x=a?Y().upToPhoneLG:d?Y().upToTabletSm:c?Y().upToTablet:u?Y().upToDesktop:m?Y().upToDesktopLG:p?Y().upToDesktopXL:Number.MAX_VALUE;return(0,i.jsx)("div",{className:"".concat(g," ").concat(x),children:h})},Q=o(87831),J=o(3459),$=o(52386),ee=o(53010),et=o(65022),eo=o(61911);let ei=D.Z.create({container:{marginHorizontal:R.ZP.margin.md,marginTop:R.ZP.margin.md,paddingBottom:R.ZP.margin.lg},rowsContainer:{marginHorizontal:R.ZP.margin.md},reviewsContainer:{marginTop:R.ZP.margin.sm,marginBottom:R.ZP.margin.sm},title:{...R.ZP.fonts.headerMD,marginBottom:R.ZP.margin.xs},infoList:{display:"flex",flexDirection:"row"},infoContainer:{flex:1,display:"flex",justifyContent:"flex-start",alignItems:"center",margin:R.ZP.margin.xs/2,minHeight:64*R.ZP.refRatio},infoTitle:{...R.ZP.fonts.xs,margin:R.ZP.margin.xs/2},infoValue:{...R.ZP.fonts.sm,textAlign:"center"},description:{...R.ZP.fonts.md,marginBottom:R.ZP.margin.sm},link:{...R.ZP.fonts.md,color:R.ZP.colors.link,textAlign:"center"},buttonInline:{flexDirection:"row",justifyContent:"space-between",marginTop:0,paddingRight:R.ZP.gutters.paddingSM,paddingLeft:R.ZP.gutters.paddingMD,width:"auto"},buttonInlineMobilemargin:{marginBottom:R.ZP.gutters.paddingMD},isHidden:{display:"none"},isVisibleBlock:{display:void 0},row:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",minHeight:R.ZP.margin.lg,borderBottomWidth:1,borderBottomColor:R.ZP.colors.gray2},value:{flex:1,...R.ZP.fonts.md,textAlign:"right",paddingVertical:R.ZP.margin.xs/2},valueColumn:{flex:1,...R.ZP.fonts.md,display:"flex",alignItems:"flex-end",justifyContent:"center",paddingVertical:R.ZP.margin.xs/2}});function er(e){let{title:t,value:o}=e,r=["","-","NA-NA","-  -  -"];function n(){return(0,i.jsxs)(M.Z,{type:"span",format:"boldSM",dataCy:"label-"+t,children:[t,":"," "]})}return!(void 0===o||"string"==typeof o&&r.includes(o.trim())||Array.isArray(o)&&o.every(e=>"string"==typeof e&&r.includes(e.trim())))&&o?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(M.Z,{type:"li",style:{marginHorizontal:0,marginBottom:R.ZP.gutters.paddingXXS},children:"string"==typeof o?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n,{}),(0,i.jsx)(M.Z,{type:"span",format:"globalSM",dataCy:"label-"+t+"-value",children:o})]}):(0,i.jsxs)(w.Z,{style:{flexDirection:"column"},children:[(0,i.jsx)(n,{}),(0,i.jsx)(w.Z,{cssClass:"Product_detailsItemEnd",type:"span",children:o.map((e,t)=>(0,i.jsxs)(M.Z,{type:"span",format:"globalSM",dataCy:"category"+t,children:["• ",e]},t))})]})})}):null}function en(e){let{content:t}=e,o=(0,et.Z)().width;return t?(0,i.jsx)(Z.Z,{style:ei.row,children:(0,i.jsx)(eo.Z,{source:{html:t},contentWidth:o,tagsStyles:R.ZP.webviewTagsLight})}):null}var el=function(e){var t;let{product:o}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(M.Z,{type:"h2",format:"sectionMD",noBaseFormat:!0,dataCy:"title-book-details",children:"Book Details"}),(0,i.jsxs)(w.Z,{cssClass:"Product_detailItems",type:"ul",children:[(0,i.jsx)(er,{title:"Publisher",value:o.publisher_name}),(0,i.jsx)(er,{title:"Publish Date",value:(0,l.ie)(o.publication_date)}),(0,i.jsx)(er,{title:"Pages",value:o.page_count}),(0,i.jsx)(er,{title:"Language",value:o.language}),(0,i.jsx)(er,{title:"Edition",value:"".concat(o.edition_description," - ").concat(o.edition_number)}),(0,i.jsx)(er,{title:"Dimensions",value:(e=>{let{height:t,width:o,thickness:i,weight:r,measurement_unit:n,weight_unit:l}=e,s=[t?"".concat(t).concat(n):"",o?"".concat(o).concat(n):"",i?"".concat(i).concat(n):""].filter(Boolean).join(" - "),a=r?"".concat(r).concat(l):"";return"".concat(s," - ").concat(a).trim()})(o)}),(0,i.jsx)(er,{title:"EAN",value:o.ean}),(0,i.jsx)(er,{title:"Recommended age",value:o.recommended_age}),(0,i.jsx)(er,{title:"Categories",value:o.categories})]}),o.reviews?(0,i.jsx)(Z.Z,{style:ei.reviewsContainer,children:null===(t=o.reviews)||void 0===t?void 0:t.map(e=>(0,i.jsx)(en,{content:e},e))}):null]})};let es=D.Z.create({containerWebView:{display:"flex",justifyContent:"center",alignItems:"center",borderWidth:1,borderColor:R.ZP.colors.mercury},containerWebViewDesktop:{height:"auto"},webView:{width:248,height:810,borderWidth:0,backgroundColor:"transparent"},webViewFlexible:{width:"100%",height:250,borderWidth:0},bookMarkContainer:{margin:0}});var ea=o(98146),ed=function(e){var t;let{product:o}=e;return(null===(t=o.badges)||void 0===t?void 0:t.book_mark_review)&&o.book_marks_widget_url?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(M.Z,{type:"h2",format:"sectionMD",noBaseFormat:!0,children:"Critics’ reviews"}),(0,i.jsx)(Z.Z,{style:es.containerWebView,children:(0,i.jsx)(ea.Z,{window_key:"criticsReviews",viewStyle:es.webView,style:es.webView,iframeStyle:es.webView,source:{uri:o.book_marks_widget_url||""}})})]}):(0,i.jsx)(i.Fragment,{})},ec=o(39945),eu=o(68229);let em=D.Z.create({mainMentionContainer:{},mentionTitleContainer:{marginBottom:R.ZP.margin.xs},mainMentionTitle:{...R.ZP.fonts.headerMD,marginTop:R.ZP.margin.sm,marginBottom:R.ZP.margin.xs}});var ep=function(e){var t;let{mention:o,title:r}=e,{full_name:n}=null!==(t=null==o?void 0:o.mentioner)&&void 0!==t?t:{};return(0,i.jsx)(Z.Z,{style:em.mainMentionContainer,children:o?(0,i.jsxs)(i.Fragment,{children:[n||r?(0,i.jsx)(Z.Z,{style:em.mentionTitleContainer,children:(0,i.jsx)(ec.Z,{style:em.mainMentionTitle,children:null!=r?r:"".concat(n," said:")})}):null,(0,i.jsx)(eu.Z,{mention:o,inProduct:!0,onProductSelected:()=>{}})]}):null})};let eh=D.Z.create({mainMentionContainer:{backgroundColor:R.ZP.colors.black,paddingHorizontal:R.ZP.gutters.responsivePadding}});var eg=function(e){let{mention:t}=e;return(null==t?void 0:t.book_id)?(0,i.jsx)(Z.Z,{style:eh.mainMentionContainer,children:(0,i.jsx)(eu.Z,{mention:t,hideCover:!0,darkMode:!0,showBio:!0,topMention:!0,onProductSelected:()=>{}})}):t?(0,i.jsx)(Z.Z,{style:eh.mainMentionContainer,children:(0,i.jsx)(S.Z,{})}):null},ex=o(3978),eZ=o(47141);let ev=D.Z.create({body:{paddingLeft:R.ZP.margin.sm,paddingTop:R.ZP.margin.sm,paddingBottom:R.ZP.margin.xs/2},item:{flexDirection:"row",marginBottom:R.ZP.margin.xs+R.ZP.margin.xs/2},containerSelected:{borderColor:R.ZP.colors.black,borderWidth:3,borderRadius:R.ZP.margin.xs,paddingVertical:R.ZP.margin.sm-1,paddingHorizontal:R.ZP.margin.sm-1,flex:1},containerDefault:{borderColor:R.ZP.colors.gray2,borderWidth:1,borderRadius:R.ZP.margin.xs,paddingVertical:R.ZP.margin.sm,paddingHorizontal:R.ZP.margin.sm,flex:1},columns:{display:"flex",justifyContent:"space-between",flexDirection:"row"},format:{...R.ZP.fonts.headerXL},price:{...R.ZP.fonts.md},publishingDate:{...R.ZP.fonts.md,color:R.ZP.colors.gray4},availability:{...R.ZP.fonts.headerMD},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",paddingBottom:R.ZP.margin.xs}});class ey extends r.PureComponent{render(){let{selected:e,format:t,onFormatSelected:o}=this.props;return(0,i.jsx)(ex.Z,{onPress:()=>o(t),style:ev.item,children:(0,i.jsxs)(Z.Z,{style:e?ev.containerSelected:ev.containerDefault,children:[(0,i.jsxs)(Z.Z,{style:ev.columns,children:[(0,i.jsx)(eZ.Z,{style:ev.format,dataCy:"label-"+t.product_form,children:t.product_form}),(0,i.jsxs)(ec.Z,{style:ev.price,children:["$",t.price]})]}),(0,i.jsx)(ec.Z,{style:ev.publishingDate,children:t.publication_date?(0,l.ie)(t.publication_date):" "}),(0,i.jsx)(ec.Z,{style:ev.availability,children:t.availability_status.label})]})})}}var ef=o(11163),eb=function(e){let{product:t,onClose:o,...n}=e,l=(0,ef.useRouter)(),d=(0,r.useMemo)(()=>{var e,o;let i=t?[{id:null==t?void 0:t.id,product_form:"".concat(null==t?void 0:t.product_form),illustration:"",large_print:"",publication_date:"".concat(null==t?void 0:t.publication_date),price:null==t?void 0:t.price,availability:(null==t?void 0:null===(e=t.ecommerce)||void 0===e?void 0:e.availability)||"OUT_OF_STOCK",availability_status:(null==t?void 0:null===(o=t.ecommerce)||void 0===o?void 0:o.availability_status)||{code:"OUT_OF_STOCK",label:"Add to Cart"},book_url:"".concat(null==t?void 0:t.book_url)}]:[];return(null==t?void 0:t.other_formats)?i.concat(t.other_formats):i},[t]),c=[R.W0.modalMobile,R.W0.modalMobileAddedToCartMaxSize],u=[R.W0.modalDesktop],m=r.useCallback(e=>{s.tq&&a.Z.emit("Navigation Push",{name:"Product",params:{productId:e.id}}),s.tq||l.push(null==e?void 0:e.book_url),o()},[l,s.tq]);return(0,i.jsx)(H.Z,{position:s.tq?"bottom":"center",title:"Choose Format",flexibleBody:!0,scroll:!0,style:s.tq?c:u,innerPadding:!0,onClose:o,...n,children:d.map(e=>(0,i.jsx)(ey,{selected:(null==t?void 0:t.id)===e.id,format:e,onFormatSelected:m},e.id))})},eP=o(76882);let ej=R.ZP.refRatio;var e_=function(){return(0,i.jsxs)(eP.ZP,{viewBox:"0 0 ".concat(R.ZP.screen.width," ").concat(R.ZP.screen.height-100*R.ZP.refRatio),children:[(0,i.jsx)(eP.UL,{x:90*ej,y:24*ej,rx:4*ej,ry:4*ej,width:190*ej,height:290*ej}),(0,i.jsx)(eP.UL,{x:24*ej,y:354*ej,rx:4*ej,ry:4*ej,width:190*ej,height:26*ej}),(0,i.jsx)(eP.UL,{x:24*ej,y:386*ej,rx:3*ej,ry:3*ej,width:140*ej,height:14*ej}),(0,i.jsx)(eP.UL,{x:172*ej,y:386*ej,rx:3*ej,ry:3*ej,width:110*ej,height:14*ej}),(0,i.jsx)(eP.UL,{x:24*ej,y:414*ej,rx:3*ej,ry:3*ej,width:160*ej,height:34*ej}),(0,i.jsx)(eP.UL,{x:271*ej,y:414*ej,rx:3*ej,ry:3*ej,width:80*ej,height:34*ej}),(0,i.jsx)(eP.UL,{x:24*ej,y:460*ej,rx:3*ej,ry:3*ej,width:130*ej,height:14*ej}),(0,i.jsx)(eP.UL,{x:24*ej,y:500*ej,rx:3*ej,ry:3*ej,width:330*ej,height:48*ej})]})},eC=o(30687),ew=o(13753),ek=o(34640),eS=function(e){var t,o,r,n,l,s;let{onAddToCart:a,onShowAfterPurchaseMembershipModal:d,product:c}=e,{shouldShowMembershipOfferModal:u}=(0,j.Z)({product:c,fromPage:"Product"}),m=!(null===(t=c.ecommerce)||void 0===t?void 0:t.price)||(null===(r=c.ecommerce)||void 0===r?void 0:null===(o=r.availability_status)||void 0===o?void 0:o.code)==="OUT_OF_STOCK",p=null!==(s=null===(l=c.ecommerce)||void 0===l?void 0:null===(n=l.availability_status)||void 0===n?void 0:n.cart_label)&&void 0!==s?s:"Add to Cart",h=()=>m?null:u?d():a&&a();return(0,i.jsx)(W.Z,{title:p,onPress:()=>h(),disabled:m,style:{marginVertical:R.ZP.margin.sm},color:m?"disabled":"secondary",inlineIcon:ek.Z,dataCy:"btn-add-to-cart"})},eM=o(20497),eT=o(22450),eL=function(e){var t,o,r;let{product:n,hasMembership:l}=e,s=(null==n?void 0:null===(o=n.ecommerce)||void 0===o?void 0:null===(t=o.availability_status)||void 0===t?void 0:t.code)==="AVAILABLE";return(0,i.jsx)(i.Fragment,{children:n.ecommerce||l?(0,i.jsxs)(w.Z,{style:eT.Z.checkmarks,cssClass:"Product_checkmarks",children:[(null==n?void 0:null===(r=n.ecommerce)||void 0===r?void 0:r.availability_status)?(0,i.jsxs)(w.Z,{style:eT.Z.containerAvailability,cssClass:"Product_availability",children:[s&&(0,i.jsx)(eM.Z,{width:16,height:16,"data-cy":"icn-stock"}),(0,i.jsx)(M.Z,{type:"span",format:"boldSM",style:eT.Z.availabilityBold,nospace:!0,tooltip:"Availability: ".concat(n.ecommerce.availability_status.label),dataCy:"label-product-stock",children:n.ecommerce.availability_status.label}),s&&(0,i.jsx)(M.Z,{type:"span",format:"sm",style:eT.Z.availability,nospace:!0,dataCy:"label-shipping-data",children:"– Ships within one business day"})]}):null,null]}):null})},eD=o(11327),eR=o(229),eI=o(96687),eE=o(10753),eA=o(61770);let eB=e=>{switch(e){case d.sY.TO_BE_READ:return(0,i.jsx)(eR.Z,{fill:"black"});case d.sY.READING:return(0,i.jsx)(V.Z,{fill:"black"});case d.sY.FINISHED:return(0,i.jsx)(eI.Z,{fill:"black"});default:return(0,i.jsx)(eR.Z,{fill:"black"})}};var eF=(0,r.memo)(function(e){let{product:t,onRefreshProductLists:o,segmentEventParams:n}=e,{loggedIn:l}=(0,b.Pk)(),{showListModal:s,showEditNotesModal:d}=(0,eA.Z)({product:t,fromPage:"Product",segmentEventParams:n,onRefreshProductLists:o}),{localBasicDefaultLists:c,basicDefaultLists:u,onListsExcludingDefaults:m,onAddToListPressList:p}=(0,eD.Z)({product:t,showEditNotesModal:d,fromPage:"Product",segmentEventParams:n,onRefreshProductLists:o}),h=(null==m?void 0:m.length)>0,[g,x]=(0,r.useState)(null);return((0,r.useEffect)(()=>{var e;x((null==t?void 0:null===(e=t.saved_in_lists)||void 0===e?void 0:e.find(e=>null==u?void 0:u.some(t=>t.id===e)))||null)},[null==t?void 0:t.saved_in_lists,u]),l)?(0,i.jsx)(e=>{let{optionList:t}=e;return(0,i.jsxs)(w.Z,{style:eT.Z.buttonsContainer,cssClass:"Product_listsButtons",children:[t.map(e=>{let t=g===e.id;return(0,i.jsx)(W.Z,{size:"square",title:null==e?void 0:e.title,buttonIcon:eB(null==e?void 0:e.title),active:t,onPress:()=>{l?(x(t?null:e.id),null==p||p({selectedList:e,onRefreshProductLists:o})):a.Z.emit("Navigation Push",{name:"SignupEnterEmail"})},color:"outline",style:{flex:1,marginHorizontal:R.ZP.margin.xxs,flexDirection:"column"}},e.id)}),(0,i.jsx)(W.Z,{size:"square",title:"Add to list",buttonIcon:(0,i.jsx)(eE.Z,{fill:"black"}),onPress:()=>s(),color:"outline",active:h,style:{flex:1,marginHorizontal:R.ZP.margin.xxs,flexDirection:"column"},dataCy:"btn-add-to-list"})]})},{optionList:(null==u?void 0:u.length)>0?u:c}):(0,i.jsx)(i.Fragment,{})});let eN=D.Z.create({body:{display:"flex",flexDirection:"row",borderTopColor:R.ZP.colors.gray2,borderTopWidth:1,marginTop:R.ZP.margin.xs,paddingTop:R.ZP.margin.xs,alignContent:"center"},title:{...R.ZP.fonts.headerMD,lineHeight:48},button:{display:"flex",flexDirection:"row",height:48,alignItems:"center",paddingHorizontal:R.ZP.margin.xs,...R.ZP.fonts.md},icon:{marginRight:R.ZP.margin.xs}});var ez=o(6256),eO=o(88083),eH=o(3600),eW=o(66171),eV=function(e){let{productId:t,rate:o}=e,{loggedIn:l}=(0,b.Pk)(),s=(0,n.TL)(),{pushToast:c}=(0,m.Z)(),{recommend:u,notRecommend:p}=(0,r.useMemo)(()=>({recommend:o===d.Ib.RECOMMEND_POSITIVE,notRecommend:o===d.Ib.RECOMMEND_NEGATIVE}),[o]),g=e=>{if(l){e();return}a.Z.emit("Navigation Push",{name:"SignupEnterEmail"})},x=e=>{s((0,h.RO)(t,e)),c({type:"success",text:"Thank you! Your rating helps improve\n our recommendations"})},Z=()=>{x(d.Lh.RECOMMEND_POSITIVE)},v=()=>{x(d.Lh.RECOMMEND_NEGATIVE)},y=u?ez.Z:eH.Z,f=p?eO.Z:eW.Z;return(0,i.jsxs)(w.Z,{style:eN.body,cssClass:"UI_productRecommend",children:[(0,i.jsx)(M.Z,{format:"sm",style:eN.title,children:"Do you recommend this book?"}),(0,i.jsxs)(ex.Z,{style:eN.button,onPress:()=>{u||g(Z)},children:[(0,i.jsx)(y,{style:eN.icon}),(0,i.jsx)(M.Z,{children:"Yes!"})]}),(0,i.jsxs)(ex.Z,{style:eN.button,onPress:()=>{p||g(v)},children:[(0,i.jsx)(f,{style:eN.icon}),(0,i.jsx)(M.Z,{children:"No"})]})]})},eG=o(73288),eq=function(e){let{...t}=e;return(0,i.jsx)(ex.Z,{...t,children:(0,i.jsx)(eG.Z,{width:32,height:32,"data-cy":"btn-share"})})},eU=function(e){let{product:t,onShare:o}=e;return(0,i.jsxs)(w.Z,{style:eT.Z.productSection,children:[(0,i.jsxs)(w.Z,{style:eT.Z.titleContainer,cssClass:"Product_titleContainer",children:[(0,i.jsx)(M.Z,{type:"h2",format:"titleProduct",renderDangerously:!0,style:eT.Z.title,dataCy:"label-product-title",children:null==t?void 0:t.title}),(0,i.jsx)(eq,{style:eT.Z.shareBtn,onPress:o})]}),(0,i.jsx)(w.Z,{style:eT.Z.rows,cssClass:"Product_authorRow",children:(0,i.jsx)(M.Z,{type:"h2",format:"titleProduct",style:eT.Z.authorTitle,dataCy:"label-product-author",children:null==t?void 0:t.author_name})})]})},eX=o(13330);let eY=D.Z.create({button:{display:"flex",justifyContent:"flex-start",alignItems:"center",flexDirection:"row",height:44,alignSelf:"flex-start"},title:{...R.ZP.fonts.md,paddingRight:R.ZP.margin.xxs,overflow:"hidden"},colorNormal:{color:R.ZP.colors.black},colorDisabled:{color:R.ZP.colors.gray3},backgroundNormal:{backgroundColor:R.ZP.colors.white},backgroundDisabled:{backgroundColor:R.ZP.colors.gray4},arrowContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:24,height:24,color:R.ZP.colors.black,borderColor:R.ZP.colors.gray2,borderWidth:2,borderRadius:20}});var eK=o(17493),eQ=function(e){let{title:t,loading:o,style:r,disabled:n=!1,...l}=e;return(0,i.jsxs)(ex.Z,{style:[eY.button,n?eY.backgroundDisabled:eY.backgroundNormal,{height:"auto"},r],...l,disabled:o||n,children:[t&&(0,i.jsx)(eZ.Z,{style:[eY.title,n?eY.colorDisabled:eY.colorNormal],dataCy:"label-covertype",children:t}),(0,i.jsx)(Z.Z,{style:eY.arrowContainer,children:(0,i.jsx)(eK.Z,{width:8,height:7,"data-cy":"btn-cover-type"})}),o&&(0,i.jsx)(eX.Z,{size:"small",color:R.ZP.colors.gray2})]})},eJ=o(62399);let e$=o(73223);var e0=(0,r.memo)(function(e){let{onSelectFormat:t,onAddToCart:o,onShowAfterPurchaseMembershipModal:l,product:a,onShowMembershipModal:d,onShare:c,onRefreshProductLists:u,productId:m,segmentEventParams:p}=e,{userHasUsedTrial:h}=(0,b.Z2)(),{getMembershipText:g}=(0,b.iR)(),{active_membership:x}=(0,n.CG)(e=>e.user),Z=(0,n.CG)(e=>e.cart),v=(0,r.useMemo)(()=>x||!!Z.subscription,[x,Z.subscription]),y=!s.tq&&!v;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.Z,{style:eT.Z.topHeroRight,cssClass:v?"Product_topHeroRightNarrow":"Product_topHeroRight",children:[(0,i.jsx)(eU,{onShare:c,product:a}),(0,i.jsxs)(w.Z,{style:eT.Z.productSection,cssClass:"Product_metaData",children:[(0,i.jsxs)(w.Z,{cssClass:"Product_metaLeft",children:[(0,i.jsx)(eQ,{title:"".concat(null==a?void 0:a.product_form),onPress:t}),(0,i.jsx)(ew.Z,{productFromProp:a,forProductScreen:!0,productProp:a,onShowCheckoutMembershipOfferProp:d,onShowMembershipModalProp:d}),(0,i.jsx)(eS,{onAddToCart:o,onShowAfterPurchaseMembershipModal:l,product:a}),(0,i.jsx)(eL,{product:a,hasMembership:v}),(0,i.jsx)(eF,{product:a,onRefreshProductLists:u,segmentEventParams:p}),(0,i.jsx)(eV,{rate:a.rate,productId:m})]}),y&&(0,i.jsx)(w.Z,{cssClass:"Product_metaCallout",children:(0,i.jsxs)(eC.Z,{type:"button",onPress:d,children:[(0,i.jsxs)(w.Z,{cssClass:"Product_memberCalloutInner",children:[h?(0,i.jsxs)(w.Z,{cssClass:"Product_membershipOfferTrial",children:[(0,i.jsx)(M.Z,{type:"span",format:"headerXL2",children:"Buy your books from the book store where readers are co-owners"}),(0,i.jsx)(M.Z,{type:"span",format:"sm",children:"Members of the Tertulia Co-Op get:"}),(0,i.jsxs)(M.Z,{type:"span",format:"headerXL",children:[(0,i.jsx)(M.Z,{type:"span",format:"boldSM",block:!0,children:"Up to 20% off most books"}),(0,i.jsx)(M.Z,{type:"span",format:"boldSM",block:!0,children:"Free shipping"}),(0,i.jsx)(M.Z,{type:"span",format:"boldSM",block:!0,children:"Co-ownership"})]})]}):(0,i.jsxs)(w.Z,{cssClass:"Product_membershipOffer",children:[(0,i.jsx)(M.Z,{type:"span",format:"sm",children:"Join the co-op and get:"}),(0,i.jsxs)(M.Z,{type:"span",format:"headerXL2",children:[(0,i.jsx)(M.Z,{type:"span",block:!0,children:"50% off your first book"}),(0,i.jsx)(M.Z,{type:"span",block:!0,children:"Free shipping"}),(0,i.jsx)(M.Z,{type:"span",block:!0,children:"Up to 20% off most books"})]}),(0,i.jsx)(M.Z,{type:"span",format:"globalSM",children:g.regularText({noCancel:!0})})]}),(0,i.jsx)(M.Z,{type:"span",format:"linkSM",children:"Learn more"})]}),(0,i.jsx)(k.Z,{src:e$,desktopSrc:"/images/MembershipCalloutEmpty.png",size:"block",alt:"Buy your books from the book store where readers are co-owners",width:450,height:320,noWrapper:!0})]})})]})]})})},eJ.E);let e1=D.Z.create({body:{paddingLeft:0},bodyLoneRow:{paddingHorizontal:R.ZP.margin.md,paddingVertical:R.ZP.margin.sm},bodyTowRow:{paddingHorizontal:R.ZP.margin.md,paddingVertical:R.ZP.margin.sm},list:{},container:{borderLeftWidth:1,borderLeftColor:R.ZP.colors.gray2},containerFirst:{},item:{flexDirection:"column",alignItems:"center",alignContent:"center",width:184,padding:R.ZP.margin.xs,paddingHorizontal:R.ZP.gutters.paddingNormal},itemLoneRow:{flexDirection:"column",alignItems:"center",alignContent:"center",width:248*R.ZP.refRatio,padding:R.ZP.margin.xs},marginTopSM:{marginTop:R.ZP.margin.xs},itemText:{textAlign:"center"},badgeImage:{width:40*R.ZP.refRatio,height:40*R.ZP.refRatio},bookmarkImage:{marginTop:R.ZP.margin.xxs,width:90,height:12},row:{display:"flex",flexDirection:"row",justifyContent:"center",alignContent:"center",marginTop:R.ZP.margin.xs},itemTextBold:{fontWeight:"600"},startsContainer:{display:"flex",flexDirection:"row",justifyContent:"center"},star:{width:24*R.ZP.refRatio,height:24*R.ZP.refRatio,color:R.ZP.colors.black,marginBottom:R.ZP.margin.sm}});var e3=function(e){var t;let{data:o,loneRow:r}=e,n=null!==(t=null==o?void 0:o.int_value)&&void 0!==t?t:null==o?void 0:o.value;return(0,i.jsxs)(Z.Z,{style:r?e1.itemLoneRow:e1.item,children:[(0,i.jsx)(M.Z,{format:"boldSM",nospace:!0,children:"Reader Score"}),(0,i.jsx)(S.Z,{size:"xs"}),(0,i.jsxs)(M.Z,{format:"headerXL4",nospace:!0,center:!0,children:[n,"%"]}),(0,i.jsxs)(M.Z,{format:"globalSM",nospace:!0,center:!0,children:[n,"% of readers"]}),(0,i.jsx)(M.Z,{format:"globalSM",nospace:!0,center:!0,children:"recommend this book"})]})},e2=o(47853),e4=function(e){let{data:t,loneRow:o}=e;return(0,i.jsxs)(Z.Z,{style:o?e1.itemLoneRow:e1.item,children:[(0,i.jsx)(e2.Z,{}),t.slice(0,2).map((e,t)=>(0,i.jsxs)(ec.Z,{style:e1.itemText,children:[e.type,":",e.name," -",e.category," (",e.year,")"]},t))]})},e8=o(77725);let e6=o(12998);var e9=function(e){var t,o;let{data:r,loneRow:n}=e,l=null==r?void 0:null===(o=r.name)||void 0===o?void 0:null===(t=o.toLowerCase())||void 0===t?void 0:t.includes("belletrist"),a=l?e6:r.logo_url,d=l?"/images/belletrist/BadgeBelletristBookClub.png":r.logo_url;return(0,i.jsxs)(Z.Z,{style:n?e1.itemLoneRow:e1.item,children:[s.tq&&(0,i.jsx)(e8.Z,{style:e1.badgeImage,resizeMode:"contain",source:{uri:a}}),!s.tq&&(0,i.jsx)(k.Z,{size:"badgeImage",resizeMode:"contain",src:d,alt:r.name}),(0,i.jsxs)(ec.Z,{style:[e1.itemText,e1.marginTopSM],children:["Included in",s.tq?"\n":(0,i.jsx)("br",{}),r.name]})]})};let e5=o(93209);var e7=function(e){var t,o;let{data:r,loneRow:n}=e,a=(0,l.ku)(r),d=(null==r?void 0:null===(t=r.review_value)||void 0===t?void 0:t.charAt(0).toUpperCase())+(null==r?void 0:null===(o=r.review_value)||void 0===o?void 0:o.slice(1).toLowerCase()),c=null==r?void 0:r.total_reviewers;return d?(0,i.jsxs)(Z.Z,{style:n?e1.itemLoneRow:e1.item,children:[(0,i.jsx)(M.Z,{format:"sm",bold:!0,nospace:!0,children:"Critic Reviews"}),(0,i.jsx)(S.Z,{size:"xs"}),(0,i.jsx)(M.Z,{format:"headerXL4",nospace:!0,tooltip:(()=>{switch(d){case"Rave":return"RAVE \nCompelling content \xb7 Does something new / profound with form \xb7 Reviewer enthuses";case"Positive":return"POSITIVE \nCompelling content and competent form, or vice versa \xb7 Flawed in a way that slightly diminishes the book but doesn’t destroy it.";case"Mixed":return"MIXED \nBook has some good points either in content or in form but flawed in a way that is distracting";case"Pan":return"PAN \nTotally or mostly negative \xb7 Book may be structured around a decent idea but is deeply flawed";default:return""}})(),children:a}),c&&(0,i.jsxs)(M.Z,{format:"sm",nospace:!0,center:!0,children:["Based on ",c," reviews on"]}),s.tq&&(0,i.jsx)(e8.Z,{style:e1.bookmarkImage,resizeMode:"contain",source:e5}),!s.tq&&(0,i.jsx)(k.Z,{size:"bookMarksImage",resizeMode:"contain",src:"/images/LogoBookMarks.png",alt:"BookMarks logo"})]}):(0,i.jsx)(i.Fragment,{})},te=o(91289),tt=o(2642),to=o(27442),ti=function(e){let{data:t,loneRow:o}=e,n=(0,r.useMemo)(()=>{let e=[],o=parseFloat(t);for(let t=0;t<5;t++)o>=t?Math.floor(o)>t?e.push((0,i.jsx)(te.Z,{style:e1.star},"start-".concat(t))):e.push((0,i.jsx)(tt.Z,{style:e1.star},"start-".concat(t))):e.push((0,i.jsx)(to.Z,{style:e1.star},"start-".concat(t)));return e},[t]);return(0,i.jsxs)(Z.Z,{style:o?e1.itemLoneRow:e1.item,children:[(0,i.jsx)(Z.Z,{style:e1.startsContainer,children:n}),(0,i.jsxs)(ec.Z,{style:[e1.itemText,e1.itemTextBold],children:["Rated ",t," of 5"]}),(0,i.jsx)(ec.Z,{style:e1.itemText,children:"on GoodReads "})]})},tr=o(43111);let tn=o(70178);var tl=function(e){let{data:t,loneRow:o}=e;return(0,i.jsxs)(Z.Z,{style:o?e1.itemLoneRow:e1.item,children:[s.tq&&(0,i.jsx)(e8.Z,{style:e1.badgeImage,resizeMode:"contain",source:tn}),!s.tq&&(0,i.jsx)(tr.Z,{srcSetPicture:[{src:"/images/BadgeNYTBestseller@2x.webp",media:"(min-resolution: 2dppx)"}],desktopSrc:"/images/BadgeNYTBestseller.webp",alt:"The New York Times Best Seller",width:40,height:40,noWrapper:!0}),(0,i.jsxs)(ec.Z,{style:[e1.itemText,e1.marginTopSM],children:[t.in_current_list?"Current":t.years.join(" & ")," ",t.name]})]})},ts=function(e){let{badge:t,onBadgeSelected:o,loneRow:r,isFirst:n}=e,{type:l,data:s}=t;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(Z.Z,{style:n?e1.containerFirst:e1.container,children:["readers_score"===l&&(0,i.jsx)(e3,{data:s,loneRow:r}),"nyt_best_sellers"===l&&(0,i.jsx)(tl,{data:s,loneRow:r})]}),(0,i.jsxs)(ex.Z,{onPress:()=>o(t),style:n?e1.containerFirst:e1.container,children:["book_mark_review"===l&&(0,i.jsx)(e7,{data:s,loneRow:r}),"awards"===l&&(0,i.jsx)(e4,{data:s,loneRow:r}),"goodreads_rating"===l&&(0,i.jsx)(ti,{data:s,loneRow:r}),"book_clubs"===l&&(0,i.jsx)(e9,{data:s,loneRow:r})]})]})};let ta=e=>"".concat(e.type,"-").concat(e.key);var td=function(e){let{badges:t,onBadgeSelected:o}=e,r=t.length<2,n=2===t.length;return t.length>0?(0,i.jsx)(w.Z,{style:r?e1.bodyLoneRow:n?e1.bodyTowRow:e1.body,cssClass:"UI_horizontalScroll",children:(0,i.jsx)(T.Z,{horizontal:!0,data:t,renderItem:e=>{let t=e.item;return(0,i.jsx)(ts,{badge:t,onBadgeSelected:()=>o(e.item),loneRow:r,isFirst:0===e.index})},keyExtractor:ta,contentContainerStyle:e1.list})}):null};let tc=e=>{let t=[];return Object.entries(e).forEach(e=>{let[o,i]=e;(0,l.xb)(i)||("book_mark_review"===o?t.push({key:o,type:o,data:i}):"book_clubs"===o?i.forEach(e=>{let i={key:e.name,type:o,data:e};t.push(i)}):"nyt_reviews"!==o&&"trending_badge"!==o&&"book_mark_review"!==o&&t.push({key:o,type:o,data:i}))}),t};var tu=function(e){let{badges:t,onBadgeSelected:o}=e,n=(0,r.useMemo)(()=>tc(t),[t]);return(0,i.jsx)(td,{badges:n,onBadgeSelected:o})},tm=function(e){let{withAfterSpace:t,onBadgeSelected:o,product:n}=e,l=(0,et.Z)().width,s=(0,r.useMemo)(()=>{var e;let t=null==n?void 0:null===(e=n.product_descriptions)||void 0===e?void 0:e.find(e=>"Publisher Marketing Description"===e.type||"Annotation"===e.type);return null==t?void 0:t.content},[n]),a=(0,r.useMemo)(()=>n.badges?(0,i.jsx)(tu,{badges:n.badges,onBadgeSelected:o}):(0,i.jsx)(i.Fragment,{}),[n.badges]),d=n.badges&&Object.values(n.badges).some(e=>null!==e&&0!==e.length);return(0,i.jsxs)(i.Fragment,{children:[a,d&&(0,i.jsx)(S.Z,{size:"xl"}),n.description||s?(0,i.jsx)(eo.Z,{source:{html:"<span>".concat(n.description||s,"</span>")},contentWidth:l,tagsStyles:R.ZP.webviewTagsLight}):null,d&&t&&(0,i.jsx)(S.Z,{size:"lg"})]})};let tp=D.Z.create({row:{marginBottom:R.ZP.margin.sm},rowDesktop:{marginHorizontal:0},type:{...R.ZP.fonts.headerMD,marginBottom:R.ZP.margin.sm},content:{flex:1,...R.ZP.fonts.md},descriptionsContainer:{marginTop:R.ZP.margin.sm,marginBottom:R.ZP.margin.sm},descriptionsContainerDesktop:{marginHorizontal:0}});function th(e){let{type:t,content:o,noTitle:r}=e,n=(0,et.Z)().width;return o?(0,i.jsxs)(w.Z,{style:tp.row,cssClass:"Product_descItem",children:[!r&&(0,i.jsx)(M.Z,{type:"p",format:"sectionMD",children:t}),(0,i.jsx)(eo.Z,{source:{html:o},contentWidth:n,tagsStyles:R.ZP.webviewTagsLight})]}):null}var tg=function(e){var t;let{product:o}=e;return(null==o?void 0:o.author_biography_list)&&(null==o?void 0:o.author_biography_list.length)!==0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(M.Z,{type:"h2",format:"sectionMD",noBaseFormat:!0,children:"About the Author"}),null==o?void 0:null===(t=o.author_biography_list)||void 0===t?void 0:t.map(e=>(0,i.jsx)(th,{type:"Biography",content:e,noTitle:!0},e))]}):(0,i.jsx)(i.Fragment,{})};let tx=D.Z.create({button:{backgroundColor:R.ZP.colors.black,height:32,borderRadius:4,marginTop:R.ZP.margin.md,display:"flex",justifyContent:"center",alignItems:"center",width:148,alignSelf:"center"},title:{fontFamily:"MaisonNeue-Demi",fontWeight:"600",fontStyle:"normal",fontSize:16,lineHeight:16,textAlign:"center",color:R.ZP.colors.white}});var tZ=function(e){let{title:t,...o}=e;return(0,i.jsx)(ex.Z,{style:tx.button,...o,children:t&&(0,i.jsx)(M.Z,{type:"span",format:"boldMD",inverse:!0,style:tx.title,children:t})})};let tv=D.Z.create({body:{backgroundColor:R.ZP.colors.backgroundColor,height:"100%",flex:1,marginBottom:R.ZP.margin.md,clear:"both"},titleContainer:{marginHorizontal:R.ZP.margin.md},mentionsTitle:{...R.ZP.fonts.headerMD,marginTop:R.ZP.margin.sm,marginBottom:R.ZP.margin.sm},mentionsContainer:{marginHorizontal:R.ZP.margin.md}});var ty=function(e){let{id:t,title:o,mentions:r,showLoadMore:n,showSeeMore:l,maxItems:s,onLoadNext:a,onMentionSelected:d}=e,c=s?r.slice(0,s):r;return r.length>0?(0,i.jsxs)(w.Z,{id:t,style:tv.body,cssClass:"Product_mentions",children:[o&&(0,i.jsx)(M.Z,{type:"h2",format:"sectionMD",noBaseFormat:!0,dataCy:"title-mentions-items",children:o}),(0,i.jsx)(w.Z,{children:c.map((e,t)=>(0,i.jsx)(eu.Z,{mention:e,inProduct:!0,hideCover:!0,isFirst:0===t,onProductSelected:()=>{},forHorizontalSlider:!1,onMentionSelected:d},e.mention_id))}),n?(0,i.jsx)(tZ,{title:"Show more",onPress:a}):null,l?(0,i.jsx)(eC.Z,{type:"regularLink",href:"#what_people_are_saying",cssClass:"UI_seeMore",children:"See more"}):null]}):null},tf=e=>{var t,o,l;let{id:s,filterIds:d,title:c,maxItems:u,initialItems:m,showSeeMore:p=!1,dataCy:g,productId:x,pageSize:Z,maxFirstItemRender:v,skipMentions:y=0}=e,{mentions:f=[],size:b=12,total_pages:P=-1,page_number:j=-1,loading:_=!1}=(null===(t=(0,n.CG)(e=>e.product.products)[x])||void 0===t?void 0:t.mentions.all)||{},C=(0,n.TL)(),[w,k]=r.useState([]),[S,M]=r.useState(!1),T=(0,r.useMemo)(()=>null==f?void 0:f.filter(e=>!d.includes(e.mention_id)),[d,f]);(0,r.useEffect)(()=>{M(!1)},[x]),(0,r.useEffect)(()=>{if(f&&!S&&v){let e=T.slice(y),t=e.length-v,o=t>0?t:0;k(o>0?e.slice(0,-o):e)}},[f,T,v,k,S,y]);let L=(j+1<P&&void 0===u||!!v)&&f.length>(v||0)&&!S,D=null!==(l=null!==(o=0===j?m:void 0)&&void 0!==o?o:u)&&void 0!==l?l:b,R=!S&&v?w:T.slice(y);return(0,i.jsx)(ty,{id:s,title:c,mentions:R,size:b,loading:_,showLoadMore:L,showSeeMore:p,onLoadNext:()=>{M(!0),j+1<P&&C((0,h.XP)(Math.min(j+1,P),x,"all",Z))},onRefresh:()=>{C((0,h._Y)({type:"all",productId:x})),C((0,h.XP)(0,x,"all",Z))},onMentionSelected:e=>{a.Z.emit("Navigation Push",{name:"Voice",params:{mentioner:e}})},"data-cy":g,maxItems:u?D:0})};let tb=(e,t)=>t.map(t=>({book_id:null==e?void 0:e.id,multiple_books:!1,mention_id:"nyMention",source_link:t.url,content:t.summary,mention_date:t.publication_date,product:e,media:{brand_name:"The new York Times",id:"nyt",logo:"https://pbs.twimg.com/profile_images/976855357904556032/wRolMCYY_normal.jpg"}}));var tP=(0,r.memo)(function(e){var t,o,p,h,T,L,D,I,E,A,H;let{onRefresh:W,titleCategory:V,onAddMembershipFromModalAfterPurchase:G,setDisplayAfterPurchaseMembershipModal:X,setDisplayAddedToCartModal:Y,displayAfterPurchaseMembershipModal:et,setDisplayMembershipModal:eo,displayAddedToCartModal:ei,displayMembershipModal:er,onAddMembershipFromModal:en,segmentEventParams:es,listTitleCustom:ea,product:ec,onShowMembershipModal:eu,productId:em,mention:eh,onProductSelected:ex,onRefreshProductLists:eZ}=e,ev=r.useRef(null),ey=(null==ec?void 0:ec.loading)||!ec,ef=(0,P.ZP)(),eP=(0,n.TL)(),{addToModalContext:ej}=(0,_.Z)(),[eC,ew]=(0,r.useState)(!1),[ek,eS]=(0,r.useState)(!1),eM=(0,r.useCallback)(()=>eS(!0),[eS]),{navBarDark:eL}=(0,n.CG)(e=>e.product),eD=(0,b.GA)(),eR=()=>{a.Z.emit("Navigation Navigate",{name:"Cart",params:{dataForSegmentEventProperties:{...es,context:"AddedToCartModal"}}})},eI=(0,r.useCallback)(e=>{var t;if(null==e?void 0:null===(t=e.key)||void 0===t?void 0:t.toLowerCase().includes("belletrist")){a.Z.emit("Navigation Push",{name:"Belletrist/join"});return}"book_mark_review"===e.type&&(s.tq?a.Z.emit("Navigation Push",{name:"ProductDetailed",params:{product:ec,destination:"bookmarks"}}):ev.current&&setTimeout(()=>{var e;null===(e=ev.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},0))},[ev,ec]),{defaultLists:eE}=(0,n.CG)(e=>e.customLists),eA=(0,r.useMemo)(()=>{var e;return(null==ec?void 0:null===(e=ec.badges)||void 0===e?void 0:e.nyt_reviews)?tb(ec,ec.badges.nyt_reviews):[]},[ec]),{authenticated:eB}=(0,b.Pk)(),{loading:eF}=(0,n.CG)(e=>e.cart),{ingram_desire:eN,tertulia_desire:ez}=(null==ec?void 0:ec.book_score)||{ingram_desire:"0",tertulia_desire:"0"},eO=Number(ez).toFixed(2),eH=Number(eN).toFixed(2),eW=function(){let{authorities:e}=(0,n.CG)(e=>e.user),t=e=>"string"==typeof e&&"ROLE_ADMIN"===e||"object"==typeof e&&"ROLE_ADMIN"===e.authority,o=e=>!!e&&e.some(e=>t(e));return(0,r.useMemo)(()=>o(e),[e])}(),{sendSegmentTrack:eV}=(0,u.Z)(),{pushToast:eG}=(0,m.Z)(),eq=[...(null===(t=ec.ecommerce)||void 0===t?void 0:t.attributes)||[],...(null===(p=ec.ecommerce)||void 0===p?void 0:null===(o=p.affiliate_discount)||void 0===o?void 0:o.attributes)||[]],eU=()=>{eV({name:d.FP.ProductAddedToCart,params:(0,c.pS)(es)}),eP((0,g.Hk)({orderId:ec.id,product:ec,type:"product",attributes:eq})),s.tq?eG({type:"success",text:d.Td.ADDED_TO_CART}):Y(!0)},{setSpecialOfferModalVisibility:eX}=(0,j.Z)({product:ec,fromPage:"Product"}),eY=(0,n.CG)(e=>e.settings),eK=()=>{!1===eY.special_offer.special_offer_modal_displayed?(X(!0),eX(!0),eV({name:d.FP.ProductAddedToCart,params:(0,c.pS)(es)}),eP((0,g.Hk)({orderId:ec.id,product:ec,type:"product",attributes:eq})),eG({type:"success",text:d.Td.ADDED_TO_CART})):eU()},eQ=async(e,t)=>{eV({name:d.FP.ProductShared,params:{...(0,c.pS)(es),shared_with:e,sharing_via:t}}),eP((0,C.dy)(ec,e,t)),eS(!1)},eJ=()=>{eV({name:d.FP.ProductFormatSwitcherOpened,params:(0,c.pS)(es)}),ew(!0)};(0,r.useEffect)(()=>{ec&&(ej("ShareModal",(0,i.jsx)(N.Z,{display:ek,onClose:()=>eS(!1),onSuccess:eQ,onFail:()=>eS(!1),product:ec})),ej("SelectFormatModal",(0,i.jsx)(eb,{display:eC,onClose:()=>ew(!1),product:ec})),ej("CartLoading",(0,i.jsx)($.Z,{display:eF})),ej("AfterPurchaseMembershipModal",(0,i.jsx)(O.Z,{display:et,onClose:()=>{X(!1),Y(!1)},onContinue:()=>{X(!1),setTimeout(()=>Y(!0),1e3)},product:ec,onAddMembershipFromModalAfterPurchase:()=>{X(!1),setTimeout(()=>G(),1e3)},hasMembership:eD})),ej("MembershipModal",(0,i.jsx)(z.Z,{display:er,onClose:()=>eo(!1),onAddMembershipFromModal:en,hasMembership:eD})),ej("AddedToCartModal",(0,i.jsx)(U.Z,{display:ei,onClose:()=>Y(!1),onGoToCart:()=>{Y(!1),setTimeout(()=>eR(),1e3)},product:ec})))},[ek,eC,eF,er,ei,et,ec]);let e$={id:"related",title:"More books by ".concat(null==ec?void 0:ec.author_name),index:0},e1={id:"related_bisac",title:"More books to explore",index:0},e3={id:"trending_product",title:"Trending books in ".concat(null==ec?void 0:null===(T=ec.book_categories)||void 0===T?void 0:null===(h=T[0])||void 0===h?void 0:h.name),index:0},e2=em||(null==ec?void 0:ec.id),e4=ef.width>=P.yJ?2:0,e8=(null==ec?void 0:null===(L=ec.ingram_review)||void 0===L?void 0:L.review_quotes)&&(null==ec?void 0:null===(I=ec.ingram_review)||void 0===I?void 0:null===(D=I.review_quotes)||void 0===D?void 0:D.length)>0?(0,i.jsxs)(w.Z,{style:eT.Z.ingramTitle,cssClass:"Product_ingramContent",children:[(0,i.jsx)(M.Z,{type:"h2",format:"sectionMD",noBaseFormat:!0,dataCy:"title-book-praise",children:"Praise for this book"}),(0,i.jsx)(w.Z,{cssClass:"Product_ingramItem",children:null==ec?void 0:ec.ingram_review.review_quotes.map((e,t)=>(0,i.jsx)(J.Z,{content:e},t))})]}):null,e6=(null==eA?void 0:eA.length)>0,e9=(null==ec?void 0:null===(E=ec.book_categories)||void 0===E?void 0:E.map(e=>e.code))||[],e5=e9.length>0,e7=null!=V?V:(null==ec?void 0:ec.book_categories)?null==ec?void 0:null===(A=ec.book_categories[0])||void 0===A?void 0:A.name:"",te=(0,r.useMemo)(()=>(0,i.jsx)(k.Z,{style:eT.Z.productImageForMovingIntoTheme,src:(null==ec?void 0:ec.image_lg_url)||(null==ec?void 0:ec.image_md_url)||(null==ec?void 0:ec.image_url)||(null==ec?void 0:ec.thumb_url)||l.GV,size:"productCoverXL",alt:"Book Cover for: ".concat(null==ec?void 0:ec.title,", ").concat(null==ec?void 0:ec.author_name),position:"top",noWrapper:!0,dataCy:"img-product-cover"},null==ec?void 0:ec.id),[ec]),tt=(0,r.useMemo)(()=>eW?(0,i.jsxs)(Z.Z,{style:eT.Z.informationScoreContainer,children:[(0,i.jsx)(ee.Z,{title:"Tertulia Score \n ".concat(eO),style:eT.Z.success,selected:!1}),(0,i.jsx)(ee.Z,{selected:!1,title:"Ingram Desire Score \n ".concat(eH),style:eT.Z.success})]}):(0,i.jsx)(i.Fragment,{}),[eW]);return ey?(0,i.jsx)(Z.Z,{style:[eT.Z.container,eh&&eL?eT.Z.darkBackground:eT.Z.lightBackground],children:(0,i.jsx)(e_,{})}):s.tq?(0,i.jsx)(Z.Z,{style:[eT.Z.container,eh&&eL?eT.Z.darkBackground:eT.Z.lightBackground],children:(0,i.jsxs)(v.Z,{style:R.W0.scrollViewBody,refreshControl:(0,i.jsx)(y.Z,{refreshing:ey,onRefresh:W}),children:[(0,i.jsx)(f.Z,{animated:!0,barStyle:eL?"light-content":"dark-content",showHideTransition:"fade"}),(0,i.jsx)(eg,{mention:eh}),te,(0,i.jsx)(e0,{productId:e2,onSelectFormat:eJ,onAddToCart:eU,onShowAfterPurchaseMembershipModal:eK,product:ec,listTitleCustom:ea,onShowMembershipModal:eu,categories:eE,onShare:eM,onRefreshProductLists:eZ,segmentEventParams:es}),(0,i.jsxs)(w.Z,{style:eT.Z.section,cssClass:"Product_section",type:"section",children:[(0,i.jsx)(tm,{withAfterSpace:!0,onBadgeSelected:eI,product:ec}),(0,i.jsx)(el,{product:ec}),(0,i.jsx)(S.Z,{size:"lg"}),(0,i.jsx)(tg,{product:ec}),(0,i.jsx)(B,{category:e$,productId:e2,onProductSelected:ex,forAboutAuthor:!0}),(0,i.jsx)(S.Z,{size:"lg"}),(0,i.jsx)(tf,{productId:em,filterIds:[null==eh?void 0:eh.mention_id],title:"Top mentions",pageSize:10}),(0,i.jsx)(ed,{product:ec}),e8,(0,i.jsx)(Z.Z,{style:eT.Z.reviewsContainer,children:eA.map((e,t)=>(0,i.jsx)(ep,{mention:e,title:"Reviewed in The New York Times"},t))})]}),(0,i.jsx)(w.Z,{style:eT.Z.moreBooks,children:(0,i.jsx)(B,{category:e1,productId:e2,onProductSelected:ex})}),e5&&(0,i.jsx)(w.Z,{cssClass:"Product_relatedLists",children:(0,i.jsx)(Q.Z,{categories:e9,title:"Reading Lists – ".concat(e7),presetTitle:"titleMentions",showsHorizontalScrollIndicator:!1,itemsToScroll:3,fromPage:"Product"})}),(0,i.jsx)(w.Z,{children:(0,i.jsx)(F.Z,{category:{id:"recentlyViewed",name:"Recently Viewed "},onProductSelected:ex,action:x.os,showsHorizontalScrollIndicator:!1})})]})}):(0,i.jsxs)(w.Z,{style:[eT.Z.body,eT.Z.responsiveContainer,eT.Z.lightBackground],cssClass:"Product_productPage",children:[(0,i.jsxs)(w.Z,{style:eT.Z.topHero,cssClass:"Product_topHero",type:"section",children:[(0,i.jsxs)(w.Z,{style:eT.Z.topLeft,cssClass:"Product_topLeft",children:[te,(0,i.jsx)(q,{product:ec}),tt]}),(0,i.jsx)(e0,{productId:e2,onSelectFormat:eJ,onAddToCart:eU,onShowAfterPurchaseMembershipModal:eK,product:ec,listTitleCustom:ea,onShowMembershipModal:eu,categories:eE,onShare:eM,onRefreshProductLists:eZ,segmentEventParams:es})]}),(0,i.jsxs)(w.Z,{style:eT.Z.sectionDouble,cssClass:"Product_sectionDouble",children:[(0,i.jsxs)(w.Z,{children:[(0,i.jsx)(w.Z,{style:eT.Z.sectionDouble,cssClass:"Product_sectionDouble",type:"section",children:(0,i.jsxs)(w.Z,{style:eT.Z.colOne,cssClass:"Product_colOne",children:[(0,i.jsx)(tm,{product:ec,onBadgeSelected:eI}),(0,i.jsx)(S.Z,{}),(0,i.jsx)(el,{product:ec})]})}),(0,i.jsx)(S.Z,{}),(0,i.jsx)(w.Z,{style:eT.Z.section,cssClass:"Product_sectionWide",type:"section",dataCy:"section-morebookstoexplore",children:(0,i.jsx)(B,{category:e1,productId:e2,onProductSelected:ex})}),(0,i.jsx)(S.Z,{size:"lg"}),(0,i.jsxs)(w.Z,{style:eT.Z.section,cssClass:"Product_section",type:"section",dataCy:"section-morebooksby",children:[(0,i.jsx)(tg,{product:ec}),(0,i.jsx)(B,{category:e$,productId:e2,onProductSelected:ex,forAboutAuthor:!0}),(0,i.jsx)(S.Z,{size:"xl"}),(0,i.jsx)(tf,{id:"what_people_are_saying",productId:em,filterIds:[null==eh?void 0:eh.mention_id],title:"What people are saying",pageSize:10,maxFirstItemRender:3,skipMentions:e4}),!s.tq&&(0,i.jsx)("div",{ref:ev}),(0,i.jsx)(ed,{product:ec}),e8,e6&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(S.Z,{size:"xl"}),eA.map((e,t)=>(0,i.jsx)(ep,{mention:e,title:"Reviewed in The New York Times"},t)),(0,i.jsx)(S.Z,{size:"xl"})]}),!!(null==ec?void 0:null===(H=ec.book_categories)||void 0===H?void 0:H[0])&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(B,{category:e3,productId:e2,onProductSelected:ex})})]})]}),(0,i.jsx)(K,{fromDesktopLG:!0,children:(0,i.jsx)(Z.Z,{style:eT.Z.sidebar,children:(0,i.jsx)(tf,{id:"sidebar_mentions",productId:em,filterIds:[null==eh?void 0:eh.mention_id],title:"What people are saying",maxItems:2,showSeeMore:!0})})})]}),e5&&(0,i.jsx)(w.Z,{cssClass:"Product_relatedLists",children:(0,i.jsx)(Q.Z,{categories:e9,title:"Reading Lists – ".concat(V),presetTitle:"titleMentions",showsHorizontalScrollIndicator:!1,itemsToScroll:3,fromPage:"Product"})}),eB&&(0,i.jsx)(w.Z,{cssClass:"Product_relatedLists",children:(0,i.jsx)(F.Z,{category:{id:"recentlyViewed",name:"Recently Viewed "},onProductSelected:ex,action:x.os,showsHorizontalScrollIndicator:!1})})]})},eJ.E),tj=(0,r.memo)(function(e){var t,o,Z,v,y,f,P,j,_,C,w,k;let{route:S}=e,M=(0,n.TL)(),{isStoreStarted:T,user:L,authenticated:D}=(0,b.Pk)(),{fetchUserInfo:R,fetchUserSettingsAndBanners:I}=(0,b.gZ)(),{subscription:E}=(0,p.Z)(),{pushToast:A}=(0,m.Z)(),{sendSegmentTrack:B,sendSegmentScreen:F}=(0,u.Z)(),N=(0,r.useRef)(!1),[z,O]=(0,r.useState)(!1),[H,W]=(0,r.useState)(!1),[V,G]=(0,r.useState)(!1),{globalUrlParams:q}=(0,n.CG)(e=>e.globalparams),U=(0,r.useMemo)(()=>{var e,t,o,i,r,n,l;return null!==(l=null!==(n=null==S?void 0:null===(t=S.params)||void 0===t?void 0:null===(e=t.product)||void 0===e?void 0:e.book_id)&&void 0!==n?n:null==S?void 0:null===(i=S.params)||void 0===i?void 0:null===(o=i.product)||void 0===o?void 0:o.id)&&void 0!==l?l:null==S?void 0:null===(r=S.params)||void 0===r?void 0:r.productId},[null==S?void 0:null===(t=S.params)||void 0===t?void 0:t.product,null==S?void 0:null===(o=S.params)||void 0===o?void 0:o.productId]),X=null!==(k=null===(Z=(0,n.CG)(e=>e.product).products[U])||void 0===Z?void 0:Z.content)&&void 0!==k?k:null==S?void 0:null===(v=S.params)||void 0===v?void 0:v.product,Y=null==S?void 0:null===(y=S.params)||void 0===y?void 0:y.product,K=X||(null==S?void 0:null===(f=S.params)||void 0===f?void 0:f.product),{mention:Q}=(null==S?void 0:S.params)||{},J=(0,r.useMemo)(()=>L,[L]),$=(0,r.useMemo)(()=>K,[K]),ee=(0,r.useMemo)(()=>Q,[Q]),{dataForSegmentEventProperties:et}=(null==S?void 0:S.params)||{},{mention:eo,context:{from_bisac_category:ei,from_category:er,from_search:{query:en=null,context:el=null,position:es=null}={}}={}}=et||{},ea=!et&&(null==S?void 0:null===(P=S.params)||void 0===P?void 0:P.utm_campaign)!=="",ed={...S.params};delete ed.productId,delete ed.product;let ec=(0,r.useMemo)(()=>({user:J,product:$,mention:ee,bisacCategory:ei,productCategory:er,search_keyword:en,search_context:el,search_list_index:es,current_screen:"Product",initial_url_params:null==q?void 0:q.urlParams}),[J,$,ee,ei,er,en,el,es,null==q?void 0:q.urlParams]),eu=(0,r.useCallback)(()=>{var e;(null==K?void 0:K.ean)&&(null==q?void 0:null===(e=q.urlParams)||void 0===e?void 0:e.affiliate_id)?M((0,h.iA)(K.ean,U,q.urlParams.affiliate_id)):M((0,h.wv)(U))},[M,null==K?void 0:K.ean,null==q?void 0:null===(j=q.urlParams)||void 0===j?void 0:j.affiliate_id,U]),em=(0,c.pS)({user:L,product:K,initial_url_params:null==q?void 0:q.urlParams}),ep=(0,c.pS)({...null==S?void 0:null===(_=S.params)||void 0===_?void 0:_.dataForSegmentEventProperties,initial_url_params:null==q?void 0:q.urlParams}),eh=ea?em:ep,eg=(0,r.useCallback)(()=>{D&&R(),I(),M((0,h.XP)(0,U,"all",10)),M((0,h.a9)(0,U)),M((0,h.As)(0,U)),M((0,h._Y)({type:"all",productId:U})),M((0,x.os)({page:0,category:"recentlyViewed"}))},[D,R,I,M,U]);(0,r.useEffect)(()=>{T&&U&&(0,l.ZE)(U)&&((!Y||s.tq)&&eu(),setTimeout(()=>eg(),0),N.current&&setTimeout(()=>N.current=!1,0))},[T,U,s.tq,Y,eu,eg]),(0,r.useEffect)(()=>{let{affiliate:e,affiliate_id:t,referrer_id:o,referrer_code:i,partner:r}=S.params||{};(e||t||o||i||r)&&M((0,g.dn)(S.params))},[S.params]),(0,r.useEffect)(()=>{M((0,h.iQ)(Q))},[Q]),(0,r.useEffect)(()=>{T&&K&&!N.current&&(F({name:"Product",params:eh}),N.current=!0,setTimeout(()=>{B({name:d.FP.ProductViewed8seconds,params:eh})},8e3))},[T,K]);let ex=(0,r.useCallback)(()=>{eg()},[eg]),eZ=(0,r.useCallback)((e,t,o)=>{s.tq||e.preventDefault(),a.Z.emit("Navigation Push",{name:"Product",params:{dataForSegmentEventProperties:{...ec,product:t,mention:eo,productCategory:o},product:t,mention:null}})},[s.tq,a.Z.emit,ec,eo]),ev=(0,r.useCallback)(()=>{s.tq?a.Z.emit("Navigation Push",{name:"MembershipBenefitsYouAreEnjoying",params:{dataForSegmentEventProperties:{...ec,previous_screen:"Product",current_screen:"MembershipBenefitsYouAreEnjoying"},onContinue:()=>{}}}):O(!0)},[s.tq,O,a.Z.emit,ec]),ey=(0,r.useCallback)(()=>{B({name:d.FP.MembershipTrialAdded,params:(0,c.pS)({...ec,context:"MembershipModal"})}),M((0,g.VF)(E)),A({type:"success",text:d.Td.MEMBERSHIP_ADDED_TO_CART}),O(!1)},[ec,B,M,E,A,O]),ef=(0,r.useCallback)(()=>{B({name:d.FP.MembershipTrialAdded,params:(0,c.pS)({...ec,context:"MembershipModal"})}),M((0,g.VF)(E)),A({type:"success",text:d.Td.MEMBERSHIP_ADDED_TO_CART}),G(!1),W(!0)},[ec,M,E,A,G,W]);return(0,i.jsx)(tP,{titleCategory:null==S?void 0:null===(C=S.params)||void 0===C?void 0:C.titleCategory,onAddMembershipFromModalAfterPurchase:ef,setDisplayAddedToCartModal:W,displayAddedToCartModal:H,displayAfterPurchaseMembershipModal:V,setDisplayMembershipModal:O,displayMembershipModal:z,setDisplayAfterPurchaseMembershipModal:G,onShowMembershipModal:ev,onAddMembershipFromModal:ey,editorialLists:null==S?void 0:null===(w=S.params)||void 0===w?void 0:w.editorialLists,onRefresh:ex,segmentEventParams:ec,product:K,productId:U,mention:Q,onProductSelected:eZ,onRefreshProductLists:eu})},eJ.E)},85330:function(e){e.exports={centerContent:"MediaSelect_centerContent__aiGPz",fromPhoneLG:"MediaSelect_fromPhoneLG__pST7s",fromTabletSm:"MediaSelect_fromTabletSm__2di06",fromTablet:"MediaSelect_fromTablet___UOv1",fromDesktop:"MediaSelect_fromDesktop__WQDEF",fromDesktopLG:"MediaSelect_fromDesktopLG__wc9qj",fromDesktopXL:"MediaSelect_fromDesktopXL__gxNPf",upToPhoneLG:"MediaSelect_upToPhoneLG__RDN0k",upToTabletSm:"MediaSelect_upToTabletSm__BjkZC",upToTablet:"MediaSelect_upToTablet__NoSyn",upToDesktop:"MediaSelect_upToDesktop__s3Pnf",upToDesktopLG:"MediaSelect_upToDesktopLG__QCA3M",upToDesktopXL:"MediaSelect_upToDesktopXL__LMdPR"}}}]);